<!DOCTYPE html>
<html data-clipboard-buttons="" data-code-prettify="" data-code-sidebar="" data-hide-show-guide="" data-sts-import="" data-mobile-support="" data-search="">
<head>
<title>Tutorial · Building REST services with Spring</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link rel="stylesheet" type="text/css" href="/css/gsguide-cce08ab7a9f46db88819a14148e45bad.css" />

<meta property="og:title" content="Building REST services with Spring" />
<meta property="og:image" content="/img/spring-by-pivotal-9066b55828deb3c10e27e609af322c40.png" />
<meta property="og:description" content="this tutorial is designed to be completed in 2-3 hours, it provides deeper, in-context explorations of enterprise application development topics, leaving you ready to implement real-world solutions." />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link active">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<main class="main-body--wrapper">
<div class="row-fluid">
<div class="span8 mobile-left-pane">
<div class="content--title desktop-only">Tutorial</div>
<article class="content--container">
<h1 class="title">Building REST services with Spring</h1>
<div class="article-body"><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>REST has quickly become the de-facto standard for building web services on the web because they’re easy to build and easy to consume.</p>
</div>
<div class="paragraph">
<p>There’s a much larger discussion to be had about how REST fits in the world of microservices, but - for this tutorial - let’s just look at building RESTful services.</p>
</div>
<div class="paragraph">
<p>Why REST? REST embraces the precepts of the web, including its architecture, benefits, and everything else. This is no surprise given its author, Roy Fielding, was involved in probably a dozen specs which govern how the web operates.</p>
</div>
<div class="paragraph">
<p>What benefits? The web and its core protocol, HTTP, provide a stack of features:</p>
</div>
<div class="ulist">
<ul>
<li> <p>Suitable actions (<code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code>, …​)</p> </li>
<li> <p>Caching</p> </li>
<li> <p>Redirection and forwarding</p> </li>
<li> <p>Security (encryption and authentication)</p> </li>
</ul>
</div>
<div class="paragraph">
<p>These are all critical factors on building resilient services. But that is not all. The web is built out of lots of tiny specs, hence it’s been able to evolve easily, without getting bogged down in "standards wars".</p>
</div>
<div class="paragraph">
<p>Developers are able to draw upon 3rd party toolkits that implement these diverse specs and instantly have both client and server technology at their fingertips.</p>
</div>
<div class="paragraph">
<p>So building on top of HTTP, REST APIs provide the means to build flexible APIs that can:</p>
</div>
<div class="ulist">
<ul>
<li> <p>Support backward compatibility</p> </li>
<li> <p>Evolvable APIs</p> </li>
<li> <p>Scaleable services</p> </li>
<li> <p>Securable services</p> </li>
<li> <p>A spectrum of stateless to stateful services</p> </li>
</ul>
</div>
<div class="paragraph">
<p>What’s important to realize is that REST, however ubiquitous, is not a standard, <em>per se</em>, but an approach, a style, a set of <em>constraints</em> on your architecture that can help you build web-scale systems. In this tutorial we will use the Spring portfolio to build a RESTful service while leveraging the stackless features of REST.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started">Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As we work through this tutorial, we’ll use <a href="https://spring.io/projects/spring-boot">Spring Boot</a>. Go to <a href="https://start.spring.io/">Spring Initializr</a> and select the following:</p>
</div>
<div class="ulist">
<ul>
<li> <p>Web</p> </li>
<li> <p>JPA</p> </li>
<li> <p>H2</p> </li>
<li> <p>Lombok</p> </li>
</ul>
</div>
<div class="paragraph">
<p>Then choose "Generate Project". A <code>.zip</code> will download. Unzip it. Inside you’ll find a simple, Maven-based project including a <code>pom.xml</code> build file (NOTE: You <em>can</em> use Gradle. The examples in this tutorial will be Maven based.)</p>
</div>
<div class="paragraph">
<p>Spring Boot can work with any IDE. You can use Eclipse, IntelliJ IDEA, Netbeans, etc. <a href="https://spring.io/tools/">The Spring Tool Suite</a> is an open-source, Eclipse-based IDE distribution that provides a superset of the Java EE distribution of Eclipse. It includes features that making working with Spring applications even easier. It is, by no means, required. But consider it if you want that extra <strong>oomph</strong> for your keystrokes. Here’s a video demonstrating how to get started with STS and Spring Boot. This is a general introduction to familiarize you with the tools.</p>
</div>
<div class="paragraph">
<p>If you pick up IntelliJ IDEA as your IDE for this tutorial, you have to install lombok plugin. In order to see how we install plugins in IntelliJ IDEA please have a look at <a href="https://www.jetbrains.com/help/idea/managing-plugins.html">managing-plugins</a>. After this you have to ensure that "Enable annotation processing" checkbox is ticked under: Preferences → Compiler → Annotation Processors, as it is described <a href="https://stackoverflow.com/questions/14866765/building-with-lomboks-slf4j-and-intellij-cannot-find-symbol-log" class="bare">https://stackoverflow.com/questions/14866765/building-with-lomboks-slf4j-and-intellij-cannot-find-symbol-log</a></p>
</div>
<div class="videoblock">
<div class="content">
<iframe src="https://www.youtube.com/embed/p8AdyMlpmPk?rel=0" frameborder="0" allowfullscreen></iframe>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_story_so_far">The Story so Far…​</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let’s start off with the simplest thing we can construct. In fact, to make it as simple as possible, we can even leave out the concepts of REST. (Later on, we’ll add REST to understand the difference.)</p>
</div>
<div class="paragraph">
<p>Our example models a simple payroll service that manages the employees of a company. Simply put, you need to store employee objects in an H2 in-memory database, and access them via JPA. This will be wrapped with a Spring MVC layer to access remotely.</p>
</div>
<div class="listingblock">
<div class="title">
nonrest/src/main/java/payroll/Employee.java
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package payroll;

import lombok.Data;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;

@Data
@Entity
class Employee {

  private @Id @GeneratedValue Long id;
  private String name;
  private String role;

  Employee() {}

  Employee(String name, String role) {
    this.name = name;
    this.role = role;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Despite being small, this Java class contains much:</p>
</div>
<div class="ulist">
<ul>
<li> <p><code>@Data</code> is a Lombok annotation to create all the getters, setters, <code>equals</code>, <code>hash</code>, and <code>toString</code> methods, based on the fields.</p> </li>
<li> <p><code>@Entity</code> is a JPA annotation to make this object ready for storage in a JPA-based data store.</p> </li>
<li> <p><code>id</code>, <code>name</code>, and <code>role</code> are the attribute for our domain object, the first being marked with more JPA annotations to indicate it’s the primary key and automatically populated by the JPA provider.</p> </li>
<li> <p>a custom constructor is created when we need to create a new instance, but don’t yet have an id.</p> </li>
</ul>
</div>
<div class="paragraph">
<p>With this domain object definition, we can now turn to <a href="https://spring.io/guides/gs/accessing-data-jpa/">Spring Data JPA</a> to handle the tedious database interactions. Spring Data repositories are interfaces with methods supporting reading, updating, deleting, and creating records against a back end data store. Some repositories also support data paging, and sorting, where appropriate. Spring Data synthesizes implementations based on conventions found in the naming of the methods in the interface.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody>
<tr>
<td class="icon"> <i class="fa icon-note" title="Note"></i> </td>
<td class="content"> There are multiple repository implementations besides JPA. You can use Spring Data MongoDB, Spring Data GemFire, Spring Data Cassandra, etc. For this tutorial, we’ll stick with JPA. </td>
</tr>
</tbody>
</table>
</div>
<div class="listingblock">
<div class="title">
nonrest/src/main/java/payroll/EmployeeRepository.java
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package payroll;

import org.springframework.data.jpa.repository.JpaRepository;

interface EmployeeRepository extends JpaRepository&lt;Employee, Long&gt; {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This interface extends Spring Data JPA’s <code>JpaRepository</code>, specifying the domain type as <code>Employee</code> and the id type as <code>Long</code>. This interface, though empty on the surface, packs a punch given it supports:</p>
</div>
<div class="ulist">
<ul>
<li> <p>Creating new instances</p> </li>
<li> <p>Updating existing ones</p> </li>
<li> <p>Deleting</p> </li>
<li> <p>Finding (one, all, by simple or complex properties)</p> </li>
</ul>
</div>
<div class="paragraph">
<p>Spring Data’s <a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories">repository solution</a> makes it possible to sidestep data store specifics and instead solve a majority of problems using domain-specific terminology.</p>
</div>
<div class="paragraph">
<p>Believe it or not, this is enough to launch an application! A Spring Boot application is, at a minimum, a <code>public static void main</code> entry-point and the <code>@SpringBootApplication</code> annotation. This tells Spring Boot to help out, wherever possible.</p>
</div>
<div class="listingblock">
<div class="title">
nonrest/src/main/java/payroll/PayrollApplication.java
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package payroll;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class PayrollApplication {

  public static void main(String... args) {
    SpringApplication.run(PayrollApplication.class, args);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@SpringBootApplication</code> is a meta-annotation that pulls in <strong>component scanning</strong>, <strong>autoconfiguration</strong>, and <strong>property support</strong>. We won’t dive into the details of Spring Boot in this tutorial, but in essence, it will fire up a servlet container and serve up our service.</p>
</div>
<div class="paragraph">
<p>Nevertheless, an application with no data isn’t very interesting, so let’s preload it. The follow class will get loaded automatically by Spring:</p>
</div>
<div class="listingblock">
<div class="title">
nonrest/src/main/java/payroll/LoadDatabase.java
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package payroll;

import lombok.extern.slf4j.Slf4j;

import org.springframework.boot.CommandLineRunner;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
@Slf4j
class LoadDatabase {

  @Bean
  CommandLineRunner initDatabase(EmployeeRepository repository) {
    return args -&gt; {
      log.info("Preloading " + repository.save(new Employee("Bilbo Baggins", "burglar")));
      log.info("Preloading " + repository.save(new Employee("Frodo Baggins", "thief")));
    };
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>What happens when it gets loaded?</p>
</div>
<div class="ulist">
<ul>
<li> <p>Spring Boot will run ALL <code>CommandLineRunner</code> beans once the application context is loaded.</p> </li>
<li> <p>This runner will request a copy of the <code>EmployeeRepository</code> you just created.</p> </li>
<li> <p>Using it, it will create two entities and store them.</p> </li>
<li> <p><code>@Slf4j</code> is a Lombok annotation to autocreate an Slf4j-based <code>LoggerFactory</code> as <code>log</code>, allowing us to log these newly created "employees".</p> </li>
</ul>
</div>
<div class="paragraph">
<p>Right-click and <strong>Run</strong> <code>PayRollApplication</code>, and this is what you get:</p>
</div>
<div class="listingblock">
<div class="title">
Fragment of console output showing preloading of data
</div>
<div class="content">
<pre>...
2018-08-09 11:36:26.169  INFO 74611 --- [main] payroll.LoadDatabase : Preloading Employee(id=1, name=Bilbo Baggins, role=burglar)
2018-08-09 11:36:26.174  INFO 74611 --- [main] payroll.LoadDatabase : Preloading Employee(id=2, name=Frodo Baggins, role=thief)
...</pre>
</div>
</div>
<div class="paragraph">
<p>This isn’t the <strong>whole</strong> log, but just the key bits of preloading data. (Indeed, check out the whole console. It’s glorious.)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_http_is_the_platform">HTTP is the Platform</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To wrap your repository with a web layer, you must turn to Spring MVC. Thanks to Spring Boot, there is little in infrastructure to code. Instead, we can focus on actions:</p>
</div>
<div class="listingblock">
<div class="title">
nonrest/src/main/java/payroll/EmployeeController.java
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package payroll;

import java.util.List;

import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RestController;

@RestController
class EmployeeController {

  private final EmployeeRepository repository;

  EmployeeController(EmployeeRepository repository) {
    this.repository = repository;
  }

  // Aggregate root

  @GetMapping("/employees")
  List&lt;Employee&gt; all() {
    return repository.findAll();
  }

  @PostMapping("/employees")
  Employee newEmployee(@RequestBody Employee newEmployee) {
    return repository.save(newEmployee);
  }

  // Single item

  @GetMapping("/employees/{id}")
  Employee one(@PathVariable Long id) {

    return repository.findById(id)
      .orElseThrow(() -&gt; new EmployeeNotFoundException(id));
  }

  @PutMapping("/employees/{id}")
  Employee replaceEmployee(@RequestBody Employee newEmployee, @PathVariable Long id) {

    return repository.findById(id)
      .map(employee -&gt; {
        employee.setName(newEmployee.getName());
        employee.setRole(newEmployee.getRole());
        return repository.save(employee);
      })
      .orElseGet(() -&gt; {
        newEmployee.setId(id);
        return repository.save(newEmployee);
      });
  }

  @DeleteMapping("/employees/{id}")
  void deleteEmployee(@PathVariable Long id) {
    repository.deleteById(id);
  }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li> <p><code>@RestController</code> indicates that the data returned by each method will be written straight into the response body instead of rendering a template.</p> </li>
<li> <p>An <code>EmployeeRepository</code> is injected by constructor into the controller.</p> </li>
<li> <p>We have routes for each operations (<code>@GetMapping</code>, <code>@PostMapping</code>, <code>@PutMapping</code> and <code>@DeleteMapping</code>, corresponding to HTTP <code>GET</code>, <code>POST</code>, <code>PUT</code>, and <code>DELETE</code> calls). (NOTE: It’s useful to read each method and understand what they do.)</p> </li>
<li> <p><code>EmployeeNotFoundException</code> is an exception used to indicate when an employee is looked up but not found.</p> </li>
</ul>
</div>
<div class="listingblock">
<div class="title">
nonrest/src/main/java/payroll/EmployeeNotFoundException.java
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package payroll;

class EmployeeNotFoundException extends RuntimeException {

  EmployeeNotFoundException(Long id) {
    super("Could not find employee " + id);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When an <code>EmployeeNotFoundException</code> is thrown, this extra tidbit of Spring MVC configuration is used to render an <strong>HTTP 404</strong>:</p>
</div>
<div class="listingblock">
<div class="title">
nonrest/src/main/java/payroll/EmployeeNotFoundAdvice.java
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package payroll;

import org.springframework.http.HttpStatus;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.bind.annotation.ResponseStatus;

@ControllerAdvice
class EmployeeNotFoundAdvice {

  @ResponseBody
  @ExceptionHandler(EmployeeNotFoundException.class)
  @ResponseStatus(HttpStatus.NOT_FOUND)
  String employeeNotFoundHandler(EmployeeNotFoundException ex) {
    return ex.getMessage();
  }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li> <p><code>@ResponseBody</code> signals that this advice is rendered straight into the response body.</p> </li>
<li> <p><code>@ExceptionHandler</code> configures the advice to only respond if an <code>EmployeeNotFoundException</code> is thrown.</p> </li>
<li> <p><code>@ResponseStatus</code> says to issue an <code>HttpStatus.NOT_FOUND</code>, i.e. an <strong>HTTP 404</strong>.</p> </li>
<li> <p>The body of the advice generates the content. In this case, it gives the message of the exception.</p> </li>
</ul>
</div>
<div class="paragraph">
<p>To launch the application, either right-click the <code>public static void main</code> in <code>PayRollApplication</code> and select <strong>Run</strong> from your IDE, or:</p>
</div>
<div class="paragraph">
<p>Spring Initializr uses maven wrapper so type this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./mvnw clean spring-boot:run</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively using your installed maven version type this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mvn clean spring-boot:run</pre>
</div>
</div>
<div class="paragraph">
<p>When the app starts, we can immediately interrogate it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -v localhost:8080/employees</pre>
</div>
</div>
<div class="paragraph">
<p>This will yield:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>*   Trying ::1...
* TCP_NODELAY set
* Connected to localhost (::1) port 8080 (#0)
&gt; GET /employees HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.54.0
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 200
&lt; Content-Type: application/json;charset=UTF-8
&lt; Transfer-Encoding: chunked
&lt; Date: Thu, 09 Aug 2018 17:58:00 GMT
&lt;
* Connection #0 to host localhost left intact
[{"id":1,"name":"Bilbo Baggins","role":"burglar"},{"id":2,"name":"Frodo Baggins","role":"thief"}]</pre>
</div>
</div>
<div class="paragraph">
<p>Here you can see the pre-loaded data, in a compacted format.</p>
</div>
<div class="paragraph">
<p>If you try and query a user that doesn’t exist…​</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -v localhost:8080/employees/99</pre>
</div>
</div>
<div class="paragraph">
<p>You get…​</p>
</div>
<div class="listingblock">
<div class="content">
<pre>*   Trying ::1...
* TCP_NODELAY set
* Connected to localhost (::1) port 8080 (#0)
&gt; GET /employees/99 HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.54.0
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 404
&lt; Content-Type: text/plain;charset=UTF-8
&lt; Content-Length: 26
&lt; Date: Thu, 09 Aug 2018 18:00:56 GMT
&lt;
* Connection #0 to host localhost left intact
Could not find employee 99</pre>
</div>
</div>
<div class="paragraph">
<p>This message nicely shows an <strong>HTTP 404</strong> error with the custom message <strong>Could not find employee 99</strong>.</p>
</div>
<div class="paragraph">
<p>It’s not hard to show the currently coded interactions…​</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -X POST localhost:8080/employees -H 'Content-type:application/json' -d '{"name": "Samwise Gamgee", "role": "gardener"}'</pre>
</div>
</div>
<div class="paragraph">
<p>Creates a new <code>Employee</code> record, and then sends the content back to us:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{"id":3,"name":"Samwise Gamgee","role":"gardener"}</pre>
</div>
</div>
<div class="paragraph">
<p>You can alter the user:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -X PUT localhost:8080/employees/3 -H 'Content-type:application/json' -d '{"name": "Samwise Gamgee", "role": "ring bearer"}'</pre>
</div>
</div>
<div class="paragraph">
<p>Updates the user:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{"id":3,"name":"Samwise Gamgee","role":"ring bearer"}</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tbody>
<tr>
<td class="icon"> <i class="fa icon-warning" title="Warning"></i> </td>
<td class="content"> Depending on how you construct your service can have significant impacts. In this situation, <strong>replace</strong> is a better description than <strong>update</strong>. For example, if the name was NOT provided, it would instead get nulled out. </td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph">
<p>And you can delete…​</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -X DELETE localhost:8080/employees/3
$ curl localhost:8080/employees/3
Could not find employee 3</pre>
</div>
</div>
<div class="paragraph">
<p>This is all well and good, but do we have RESTful service yet? (If you didn’t catch the hint, the answer is no.)</p>
</div>
<div class="paragraph">
<p>What’s missing?</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_makes_something_restful">What makes something RESTful?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>So far, you have a web-based service that handles the core operations involving employee data. But that’s not enough to make things "RESTful".</p>
</div>
<div class="ulist">
<ul>
<li> <p>Pretty URLs like /employees/3 aren’t REST.</p> </li>
<li> <p>Merely using <code>GET</code>, <code>POST</code>, etc. aren’t REST.</p> </li>
<li> <p>Having all the CRUD operations laid out aren’t REST.</p> </li>
</ul>
</div>
<div class="paragraph">
<p>In fact, what we have built so far is better described as <strong>RPC</strong> (<strong>Remote Procedure Call</strong>). That’s because there is no way to know how to interact with this service. If you published this today, you’d also have to write a document or host a developer’s portal somewhere with all the details.</p>
</div>
<div class="paragraph">
<p>This statement of Roy Fielding may further lend a clue to the difference between <strong>REST</strong> and <strong>RPC</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>I am getting frustrated by the number of people calling any HTTP-based interface a REST API. Today’s example is the SocialSite REST API. That is RPC. It screams RPC. There is so much coupling on display that it should be given an X rating.

What needs to be done to make the REST architectural style clear on the notion that hypertext is a constraint? In other words, if the engine of application state (and hence the API) is not being driven by hypertext, then it cannot be RESTful and cannot be a REST API. Period. Is there some broken manual somewhere that needs to be fixed?</pre>
</div>
</div>
<div class="paragraph">
<p>The side effect of NOT including hypermedia in our representations is that clients MUST hard code URIs to navigate the API. This leads to the same brittle nature that predated the rise of e-commerce on the web. It’s a signal that our JSON output needs a little help.</p>
</div>
<div class="paragraph">
<p>Introducing <a href="https://spring.io/projects/spring-hateoas">Spring HATEOAS</a>, a Spring project aimed at helping you write hypermedia-driven outputs. To upgrade your service to being RESTful, add this to your build:</p>
</div>
<div class="listingblock">
<div class="title">
Adding Spring HATEOAS to pom.xml
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
	&lt;artifactId&gt;spring-boot-starter-hateoas&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This tiny library will give us the constructs to define a RESTful service and then render it in an acceptible format for client consumption.</p>
</div>
<div class="paragraph">
<p>A critical ingredient to any RESTful service is adding <a href="https://tools.ietf.org/html/rfc5988">links</a> to relevant operations. To make your controller more RESTful, add links like this:</p>
</div>
<div class="listingblock">
<div class="title">
Getting a single item resource
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@GetMapping("/employees/{id}")
Resource&lt;Employee&gt; one(@PathVariable Long id) {

  Employee employee = repository.findById(id)
    .orElseThrow(() -&gt; new EmployeeNotFoundException(id));

  return new Resource&lt;&gt;(employee,
    linkTo(methodOn(EmployeeController.class).one(id)).withSelfRel(),
    linkTo(methodOn(EmployeeController.class).all()).withRel("employees"));
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">
Relevant import statements
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import static org.springframework.hateoas.mvc.ControllerLinkBuilder.*;
import org.springframework.hateoas.Resource;
import org.springframework.hateoas.Resources;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is very similar to what we had before, but a few things have changed:</p>
</div>
<div class="ulist">
<ul>
<li> <p>The return type of the method has changed from <code>Employee</code> to <code>Resource&lt;Employee&gt;</code>. <code>Resource&lt;T&gt;</code> is a generic container from Spring HATEOAS that includes not only the data but a collection of links.</p> </li>
<li> <p><code>linkTo(methodOn(EmployeeController.class).one(id)).withSelfRel()</code> asks that Spring HATEOAS build a link to the <code>EmployeeController</code> 's <code>one()</code> method, and flag it as a <a href="https://www.iana.org/assignments/link-relations/link-relations.xhtml">self</a> link.</p> </li>
<li> <p><code>linkTo(methodOn(EmployeeController.class).all()).withRel("employees")</code> asks Spring HATEOAS to build a link to the aggregate root, <code>all()</code>, and call it "employees".</p> </li>
</ul>
</div>
<div class="paragraph">
<p>What do we mean by "build a link"? One of Spring HATEOAS’s core types is <code>Link</code>. It includes a <strong>URI</strong> and a <strong>rel</strong> (relation). Links are what empower the web. Before the World Wide Web, other document systems would render information or links, but it was the linking of documents WITH data that stitched the web together.</p>
</div>
<div class="paragraph">
<p>Roy Fielding encourages building APIs with the same techniques that made the web successful, and links are one of them.</p>
</div>
<div class="paragraph">
<p>If you restart the application and query the employee record of <strong>Bilbo</strong>, you’ll get a slightly different response than earlier:</p>
</div>
<div class="listingblock">
<div class="title">
RESTful representation of a single employee
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">{
  "id": 1,
  "name": "Bilbo Baggins",
  "role": "burglar",
  "_links": {
    "self": {
      "href": "http://localhost:8080/employees/1"
    },
    "employees": {
      "href": "http://localhost:8080/employees"
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This decompressed output shows not only the data elements you saw earlier (<code>id</code>, <code>name</code> and <code>role</code>), but also a <code>_links</code> entry containing two URIs. This entire document is formatted using <a href="http://stateless.co/hal_specification.html">HAL</a>.</p>
</div>
<div class="paragraph">
<p>HAL is a lightweight <a href="https://tools.ietf.org/html/draft-kelly-json-hal-08">mediatype</a> that allows encoding not just data but also hypermedia controls, alerting consumers to other parts of the API they can navigate toward. In this case, there is a "self" link (kind of like a <code>this</code> statement in code) along with a link back to the <strong>aggregate root</strong>.</p>
</div>
<div class="paragraph">
<p>To make the aggregate root ALSO more RESTful, you want to include top level links while ALSO including any RESTful components within:</p>
</div>
<div class="listingblock">
<div class="title">
Getting an aggregate root resource
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@GetMapping("/employees")
Resources&lt;Resource&lt;Employee&gt;&gt; all() {

  List&lt;Resource&lt;Employee&gt;&gt; employees = repository.findAll().stream()
    .map(employee -&gt; new Resource&lt;&gt;(employee,
      linkTo(methodOn(EmployeeController.class).one(employee.getId())).withSelfRel(),
      linkTo(methodOn(EmployeeController.class).all()).withRel("employees")))
    .collect(Collectors.toList());

  return new Resources&lt;&gt;(employees,
    linkTo(methodOn(EmployeeController.class).all()).withSelfRel());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Wow! That method, which used to just be <code>repository.findAll()</code> has grown big! Let’s unpack it.</p>
</div>
<div class="paragraph">
<p><code>Resources&lt;&gt;</code> is another Spring HATEOAS container aimed at encapsulating collections. It, too, also lets you include links. Don’t let that first statement slip by. When does "encapsulating collections" mean? Collections of employees?</p>
</div>
<div class="paragraph">
<p>Not quite.</p>
</div>
<div class="paragraph">
<p>Since we’re talking REST, it should encapsulate collections of <strong>employee resources</strong>.</p>
</div>
<div class="paragraph">
<p>That’s why you fetch all the employees, but then transform them into a list of <code>Resource&lt;Employee&gt;</code> objects. (Thanks Java 8 Stream API!)</p>
</div>
<div class="paragraph">
<p>If you restart the application and fetch the aggregate root, you can see what this looks like.</p>
</div>
<div class="listingblock">
<div class="title">
RESTful representation of a collection of employee resources
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">{
  "_embedded": {
    "employeeList": [
      {
        "id": 1,
        "name": "Bilbo Baggins",
        "role": "burglar",
        "_links": {
          "self": {
            "href": "http://localhost:8080/employees/1"
          },
          "employees": {
            "href": "http://localhost:8080/employees"
          }
        }
      },
      {
        "id": 2,
        "name": "Frodo Baggins",
        "role": "thief",
        "_links": {
          "self": {
            "href": "http://localhost:8080/employees/2"
          },
          "employees": {
            "href": "http://localhost:8080/employees"
          }
        }
      }
    ]
  },
  "_links": {
    "self": {
      "href": "http://localhost:8080/employees"
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For this aggregate root, which serves up a collection of employee resources, there is a top-level <strong>"self"</strong> link. The <strong>"collection"</strong> is listed underneath the <strong>"_embedded"</strong> section. This is how HAL represents collections.</p>
</div>
<div class="paragraph">
<p>And each individual member of the collection has their information as well as related links.</p>
</div>
<div class="paragraph">
<p>What is the point of adding all these links? It makes it possible to evolve REST services over time. Existing links can be maintained while new links are added in the future. Newer clients may take advantage of the new links, while legacy clients can sustain themselves on the old links. This is especially helpful if services get relocated and moved around. As long as the link structure is maintained, clients can STILL find and interact with things.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_simplifying_link_creation">Simplifying Link Creation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Did you notice the repetition in single employee link creation? The code to provide a single link to an employee as well as an "employees" link to the aggregate root was shown twice. If that raised your concern, good! There’s a solution.</p>
</div>
<div class="paragraph">
<p>Simply put, you need to define a function that converts <code>Employee</code> objects to <code>Resource&lt;Employee&gt;</code> objects. While you could easily code this method yourself, there are benefits down the road of implementing Spring HATEOAS’s <code>ResourceAssembler</code> interface.</p>
</div>
<div class="listingblock">
<div class="title">
evolution/src/main/java/payroll/EmployeeResourceAssembler.java
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package payroll;

import static org.springframework.hateoas.mvc.ControllerLinkBuilder.*;

import org.springframework.hateoas.Resource;
import org.springframework.hateoas.ResourceAssembler;
import org.springframework.stereotype.Component;

@Component
class EmployeeResourceAssembler implements ResourceAssembler&lt;Employee, Resource&lt;Employee&gt;&gt; {

  @Override
  public Resource&lt;Employee&gt; toResource(Employee employee) {

    return new Resource&lt;&gt;(employee,
      linkTo(methodOn(EmployeeController.class).one(employee.getId())).withSelfRel(),
      linkTo(methodOn(EmployeeController.class).all()).withRel("employees"));
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This simple interface has one method: <code>toResource()</code>. It is based on converting a non-resource object (<code>Employee</code>) into a resource-based object (<code>Resource&lt;Employee&gt;</code>).</p>
</div>
<div class="paragraph">
<p>All the code you saw earlier in the controller can be moved into this class. And by applying Spring Framework’s <code>@Component</code>, this component will be automatically created when the app starts.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody>
<tr>
<td class="icon"> <i class="fa icon-note" title="Note"></i> </td>
<td class="content"> Spring HATEOAS’s abstract base class for all resources is <code>ResourceSupport</code>. But for simplicity, I recommend using <code>Resource&lt;T&gt;</code> as your mechanism to easily wrap all POJOs as resources. </td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph">
<p>To leverage this assembler, you only have to alter the <code>EmployeeController</code> by injecting the assembler in the constructor. Then the</p>
</div>
<div class="listingblock">
<div class="title">
Injecting EmployeeResourceAssembler into the controller
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@RestController
class EmployeeController {

  private final EmployeeRepository repository;

  private final EmployeeResourceAssembler assembler;

  EmployeeController(EmployeeRepository repository,
             EmployeeResourceAssembler assembler) {

    this.repository = repository;
    this.assembler = assembler;
  }

  ...

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>From here, you can use it in the single-item employee method:</p>
</div>
<div class="listingblock">
<div class="title">
Getting single item resource using the assembler
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@GetMapping("/employees/{id}")
Resource&lt;Employee&gt; one(@PathVariable Long id) {

  Employee employee = repository.findById(id)
    .orElseThrow(() -&gt; new EmployeeNotFoundException(id));

  return assembler.toResource(employee);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code is almost the same, except instead of creating the <code>Resource&lt;Employee&gt;</code> instance here, you delegate it to the assembler. Maybe that doesn’t look like much?</p>
</div>
<div class="paragraph">
<p>Applying the same thing in the aggregate root controller method is more impressive:</p>
</div>
<div class="listingblock">
<div class="title">
Getting aggregate root resource using the assembler
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@GetMapping("/employees")
Resources&lt;Resource&lt;Employee&gt;&gt; all() {

  List&lt;Resource&lt;Employee&gt;&gt; employees = repository.findAll().stream()
    .map(assembler::toResource)
    .collect(Collectors.toList());

  return new Resources&lt;&gt;(employees,
    linkTo(methodOn(EmployeeController.class).all()).withSelfRel());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code is, again, almost the same, however you get to replace all that <code>Resource&lt;Employee&gt;</code> creation logic with <code>map(assembler::toResource)</code>. Thanks to Java 8 method references, it’s super easy to plug it in and simplify your controller.</p>
</div>
<div class="admonitionblock important">
<table>
<tbody>
<tr>
<td class="icon"> <i class="fa icon-important" title="Important"></i> </td>
<td class="content"> A key design goal of Spring HATEOAS is to make it easier to do The Right Thing™. In this scenario, adding hypermedia to your service without hard coding a thing. </td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph">
<p>At this stage, you’ve created a Spring MVC REST controller that actually produces hypermedia-powered content! Clients that don’t speak HAL can ignore the extra bits while consuming the pure data. Clients that DO speak HAL can navigate your empowered API.</p>
</div>
<div class="paragraph">
<p>But that is not the only thing needed to build a truly RESTful service with Spring.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_evolving_rest_apis">Evolving REST APIs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With one additional library and a few lines of extra code, you have added hypermedia to your application. But that is not the only thing needed to make your service RESTful. An important facet of REST is the fact that it’s neither a technology stack nor a single standard.</p>
</div>
<div class="paragraph">
<p>REST is a collection of architectural constraints that when adopted make your application much more resilient. A key factor of resilience is that when you make upgrades to your services, your clients don’t suffer from downtime.</p>
</div>
<div class="paragraph">
<p>In the "olden" days, upgrades were notorious for breaking clients. In other words, an upgrade to the server required an update to the client. In this day and age, hours or even minutes of downtime spent doing an upgrade can cost millions in lost revenue.</p>
</div>
<div class="paragraph">
<p>Some companies require that you present management with a plan to minimize downtime. In the past, you could get away with upgrading at 2:00 a.m. on a Sunday when load was at a minimum. But in today’s Internet-based e-commerce with international customers, such strategies are not as effective.</p>
</div>
<div class="paragraph">
<p>SOAP-based services and CORBA-based services were incredibly brittle. It was hard to roll out a server that could support both old and new clients. With REST-based practices, it’s much easier. Especially using the Spring stack.</p>
</div>
<div class="paragraph">
<p>Imagine this design problem: You’ve rolled out a system with this <code>Employee</code> -based record. The system is a major hit. You’ve sold your system to countless enterprises. Suddenly, the need for an employee’s name to be split into <code>firstName</code> and <code>lastName</code> arises.</p>
</div>
<div class="paragraph">
<p>Uh oh. Didn’t think of that.</p>
</div>
<div class="paragraph">
<p>Before you open up the <code>Employee</code> class and replace the single field <code>name</code> with <code>firstName</code> and <code>lastName</code>, stop and think for a second. Will that break any clients? How long will it take to upgrade them. Do you even control all the clients accessing your services?</p>
</div>
<div class="paragraph">
<p>Downtime = lost money. Is management ready for that?</p>
</div>
<div class="paragraph">
<p>There is an old strategy that precedes REST by years.</p>
</div>
<div class="quoteblock">
<blockquote>
Never delete a column in a database.
</blockquote>
<div class="attribution">
— Unknown
</div>
</div>
<div class="paragraph">
<p>You can always add columns (fields) to a database table. But don’t take one away. The principle in RESTful services is the same. Add new fields to your JSON representations, but don’t take any away. Like this:</p>
</div>
<div class="listingblock">
<div class="title">
JSON that supports multiple clients
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">{
  "id": 1,
  "firstName": "Bilbo",
  "lastName": "Baggins",
  "role": "burglar",
  "name": "Bilbo Baggins",
  "_links": {
    "self": {
      "href": "http://localhost:8080/employees/1"
    },
    "employees": {
      "href": "http://localhost:8080/employees"
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice how this format shows <code>firstName</code>, <code>lastName</code>, AND <code>name</code>? While it sports duplication of information, the purpose is to support both old and new clients. That means you can upgrade the server without requiring clients upgrade at the same time. A good move that should reduce downtime.</p>
</div>
<div class="paragraph">
<p>And not only should you show this information in both the "old way" and the "new way", you should also process incoming data both ways.</p>
</div>
<div class="paragraph">
<p>How? Simple. Like this:</p>
</div>
<div class="listingblock">
<div class="title">
Employee record that handles both "old" and "new" clients
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package payroll;

import lombok.Data;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;

@Data
@Entity
class Employee {

  private @Id @GeneratedValue Long id;
  private String firstName;
  private String lastName;
  private String role;

  Employee() {}

  Employee(String firstName, String lastName, String role) {
    this.firstName = firstName;
    this.lastName = lastName;
    this.role = role;
  }

  public String getName() {
    return this.firstName + " " + this.lastName;
  }

  public void setName(String name) {
    String[] parts =name.split(" ");
    this.firstName = parts[0];
    this.lastName = parts[1];
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This class is very similar to the previous version of <code>Employee</code>. Let’s go over the changes:</p>
</div>
<div class="ulist">
<ul>
<li> <p>Field <code>name</code> has been replaced by <code>firstName</code> and <code>lastName</code>. Lombok will generate getters and setters for those.</p> </li>
<li> <p>A "virtual" getter for the old <code>name</code> property, <code>getName()</code> is defined. It uses the <code>firstName</code> and <code>lastName</code> fields to produce a value.</p> </li>
<li> <p>A "virtual" setter for the old <code>name</code> property is also defined, <code>setName()</code>. It parses an incoming string and stores it into the proper fields.</p> </li>
</ul>
</div>
<div class="paragraph">
<p>Of course not EVERY change to your API is as simple as splitting a string or merging two strings. But it’s surely not impossible to come up with a set of transforms for most scenarios, ehh?</p>
</div>
<div class="paragraph">
<p>Another fine tuning is to ensure each of your REST methods returns a proper response. Update the POST method like this:</p>
</div>
<div class="listingblock">
<div class="title">
POST that handles "old" and "new" client requests
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@PostMapping("/employees")
ResponseEntity&lt;?&gt; newEmployee(@RequestBody Employee newEmployee) throws URISyntaxException {

  Resource&lt;Employee&gt; resource = assembler.toResource(repository.save(newEmployee));

  return ResponseEntity
    .created(new URI(resource.getId().expand().getHref()))
    .body(resource);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li> <p>The new <code>Employee</code> object is saved as before. But the resulting object is wrapped using the <code>EmployeeResourceAssembler</code>.</p> </li>
<li> <p>Spring MVC’s <code>ResponseEntity</code> is used to create an <strong>HTTP 201 Created</strong> status message. This type of response typically includes a <strong>Location</strong> response header, and we use the newly formed link.</p> </li>
<li> <p>Additionally, return the resource-based version of the saved object.</p> </li>
</ul>
</div>
<div class="paragraph">
<p>With this tweak in place, you can use the same endpoint to create a new employee resource, and use the legacy <code>name</code> field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -v -X POST localhost:8080/employees -H 'Content-Type:application/json' -d '{"name": "Samwise Gamgee", "role": "gardener"}'</pre>
</div>
</div>
<div class="paragraph">
<p>The output is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; POST /employees HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.54.0
&gt; Accept: */*
&gt; Content-Type:application/json
&gt; Content-Length: 46
&gt;
&lt; Location: http://localhost:8080/employees/3
&lt; Content-Type: application/hal+json;charset=UTF-8
&lt; Transfer-Encoding: chunked
&lt; Date: Fri, 10 Aug 2018 19:44:43 GMT
&lt;
{
  "id": 3,
  "firstName": "Samwise",
  "lastName": "Gamgee",
  "role": "gardener",
  "name": "Samwise Gamgee",
  "_links": {
    "self": {
      "href": "http://localhost:8080/employees/3"
    },
    "employees": {
      "href": "http://localhost:8080/employees"
    }
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>This not only has the resulting object rendered in HAL (both <code>name</code> as well as <code>firstName</code>/<code>lastName</code>), but also the <strong>Location</strong> header populated with <code><a href="http://localhost:8080/employees/3" class="bare">http://localhost:8080/employees/3</a></code>. A hypermedia powered client could opt to "surf" to this new resource and proceed to interact with it.</p>
</div>
<div class="paragraph">
<p>The PUT controller method needs similar tweaks:</p>
</div>
<div class="listingblock">
<div class="title">
Handling a PUT for different clients
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@PutMapping("/employees/{id}")
ResponseEntity&lt;?&gt; replaceEmployee(@RequestBody Employee newEmployee, @PathVariable Long id) throws URISyntaxException {

  Employee updatedEmployee = repository.findById(id)
    .map(employee -&gt; {
      employee.setName(newEmployee.getName());
      employee.setRole(newEmployee.getRole());
      return repository.save(employee);
    })
    .orElseGet(() -&gt; {
      newEmployee.setId(id);
      return repository.save(newEmployee);
    });

  Resource&lt;Employee&gt; resource = assembler.toResource(updatedEmployee);

  return ResponseEntity
    .created(new URI(resource.getId().expand().getHref()))
    .body(resource);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Employee</code> object built from the <code>save()</code> operation is then wrapped using the <code>EmployeeResourceAssembler</code> into a <code>Resource&lt;Employee&gt;</code> object. Since we want a more detailed HTTP response code than <strong>200 OK</strong>, we will use Spring MVC’s <code>ResponseEntity</code> wrapper. It has a handy static method <code>created()</code> where we can plug in the resource’s URI.</p>
</div>
<div class="paragraph">
<p>By grabbing the <code>resource</code> you can fetch it’s "self" link via the <code>getId()</code> method call. This method yields a <code>Link</code> which you can turn into a Java <code>URI</code>. To tie things up nicely, you inject the <code>resource</code> itself into the <code>body()</code> method.</p>
</div>
<div class="admonitionblock important">
<table>
<tbody>
<tr>
<td class="icon"> <i class="fa icon-important" title="Important"></i> </td>
<td class="content"> In REST, a resource’s <strong>id</strong> is the URI of that resource. Hence, Spring HATEOAS doesn’t hand you the <code>id</code> field of the underlying data type (which no client should), but instead, the URI for it. And don’t confuse <code>ResourceSupport.getId()</code> with <code>Employee.getId()</code>. </td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph">
<p>It’s debatable if <strong>HTTP 201 Created</strong> carries the right semantics since we aren’t necessarily "creating" a new resource. But it comes pre-loaded with a <strong>Location</strong> response header, so run with it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -v -X PUT localhost:8080/employees/3 -H 'Content-Type:application/json' -d '{"name": "Samwise Gamgee", "role": "ring bearer"}'

* TCP_NODELAY set
* Connected to localhost (::1) port 8080 (#0)
&gt; PUT /employees/3 HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.54.0
&gt; Accept: */*
&gt; Content-Type:application/json
&gt; Content-Length: 49
&gt;
&lt; HTTP/1.1 201
&lt; Location: http://localhost:8080/employees/3
&lt; Content-Type: application/hal+json;charset=UTF-8
&lt; Transfer-Encoding: chunked
&lt; Date: Fri, 10 Aug 2018 19:52:56 GMT
{
	"id": 3,
	"firstName": "Samwise",
	"lastName": "Gamgee",
	"role": "ring bearer",
	"name": "Samwise Gamgee",
	"_links": {
		"self": {
			"href": "http://localhost:8080/employees/3"
		},
		"employees": {
			"href": "http://localhost:8080/employees"
		}
	}
}</pre>
</div>
</div>
<div class="paragraph">
<p>That employee resource has now been updated and the location URI sent back. Finally, update the DELETE operation suitably:</p>
</div>
<div class="listingblock">
<div class="title">
Handling DELETE requests
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@DeleteMapping("/employees/{id}")
ResponseEntity&lt;?&gt; deleteEmployee(@PathVariable Long id) {

  repository.deleteById(id);

  return ResponseEntity.noContent().build();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This returns an <strong>HTTP 204 No Content</strong> response.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -v -X DELETE localhost:8080/employees/1

* TCP_NODELAY set
* Connected to localhost (::1) port 8080 (#0)
&gt; DELETE /employees/1 HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.54.0
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 204
&lt; Date: Fri, 10 Aug 2018 21:30:26 GMT</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tbody>
<tr>
<td class="icon"> <i class="fa icon-important" title="Important"></i> </td>
<td class="content"> Making changes to the fields in the <code>Employee</code> class will require coordination with your database team, so that they can properly migrate existing content into the new columns. </td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph">
<p>You are now ready for an upgrade that will NOT disturb existing clients while newer clients can take advantage of the enhancements!</p>
</div>
<div class="paragraph">
<p>By the way, are you worried about sending too much information over the wire? In some systems where every byte counts, evolution of APIs may need to take a backseat. But don’t pursue such premature optimization until you measure.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_building_links_into_your_rest_api">Building links into your REST API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>So far, you’ve built an evolvable API with bare bones links. To grow your API and better serve your clients, you need to embrace the concept of <strong>Hypermedia as the Engine of Application State</strong>.</p>
</div>
<div class="paragraph">
<p>What does that mean? In this section, you’ll explore it in detail.</p>
</div>
<div class="paragraph">
<p>Business logic inevitably builds up rules that involve processes. The risk of such systems is we often carry such server-side logic into clients and build up strong coupling. REST is about breaking down such connections and minimizing such coupling.</p>
</div>
<div class="paragraph">
<p>To show how to cope with state changes without triggering breaking changes in clients, imagine adding a system that fulfills orders.</p>
</div>
<div class="paragraph">
<p>As a first step, define an <code>Order</code> record:</p>
</div>
<div class="listingblock">
<div class="title">
links/src/main/java/payroll/Order.java
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package payroll;

import lombok.Data;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.Table;

@Entity
@Data
@Table(name = "CUSTOMER_ORDER")
class Order {

  private @Id @GeneratedValue Long id;

  private String description;
  private Status status;

  Order() {}

  Order(String description, Status status) {

    this.description = description;
    this.status = status;
  }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li> <p>The class requires a JPA <code>@Table</code> annotation changing the table’s name to <code>CUSTOMER_ORDER</code> because <code>ORDER</code> is not a valid name for table.</p> </li>
<li> <p>It includes a <code>description</code> field as well as a <code>status</code> field.</p> </li>
</ul>
</div>
<div class="paragraph">
<p>Orders must go through a certain series of state transitions from the time a customer submits an order and it is either fulfilled or cancelled. This can be captured as a Java <code>enum</code>:</p>
</div>
<div class="listingblock">
<div class="title">
links/src/main/java/payroll/Status.java
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package payroll;

enum Status {

  IN_PROGRESS,
  COMPLETED,
  CANCELLED;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This <code>enum</code> captures the various states an <code>Order</code> can occupy. For this tutorial, let’s keep it simple.</p>
</div>
<div class="paragraph">
<p>To support interacting with orders in the database, you must define a corresponding Spring Data repository:</p>
</div>
<div class="listingblock">
<div class="title">
Spring Data JPA’s
<code>JpaRepository</code> base interface
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">interface OrderRepository extends JpaRepository&lt;Order, Long&gt; {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this in place, you can now define a basic <code>OrderController</code>:</p>
</div>
<div class="listingblock">
<div class="title">
links/src/main/java/payroll/OrderController.java
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@RestController
class OrderController {

  private final OrderRepository orderRepository;
  private final OrderResourceAssembler assembler;

  OrderController(OrderRepository orderRepository,
          OrderResourceAssembler assembler) {

    this.orderRepository = orderRepository;
    this.assembler = assembler;
  }

  @GetMapping("/orders")
  Resources&lt;Resource&lt;Order&gt;&gt; all() {

    List&lt;Resource&lt;Order&gt;&gt; orders = orderRepository.findAll().stream()
      .map(assembler::toResource)
      .collect(Collectors.toList());

    return new Resources&lt;&gt;(orders,
      linkTo(methodOn(OrderController.class).all()).withSelfRel());
  }

  @GetMapping("/orders/{id}")
  Resource&lt;Order&gt; one(@PathVariable Long id) {
    return assembler.toResource(
      orderRepository.findById(id)
        .orElseThrow(() -&gt; new OrderNotFoundException(id)));
  }

  @PostMapping("/orders")
  ResponseEntity&lt;Resource&lt;Order&gt;&gt; newOrder(@RequestBody Order order) {

    order.setStatus(Status.IN_PROGRESS);
    Order newOrder = orderRepository.save(order);

    return ResponseEntity
      .created(linkTo(methodOn(OrderController.class).one(newOrder.getId())).toUri())
      .body(assembler.toResource(newOrder));
  }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li> <p>It contains the same REST controller setup as the controllers you’ve built so far.</p> </li>
<li> <p>It injects both an <code>OrderRepository</code> as well as a (not yet built) <code>OrderResourceAssembler</code>.</p> </li>
<li> <p>The first two Spring MVC routes handle the aggregate root as well as a single item <code>Order</code> resource request.</p> </li>
<li> <p>The third Spring MVC route handles creating new orders, by starting them in the <code>IN_PROGRESS</code> state.</p> </li>
<li> <p>All the controller methods return one of Spring HATEOAS’s <code>ResourceSupport</code> subclasses to properly render hypermedia (or a wrapper around such a type).</p> </li>
</ul>
</div>
<div class="paragraph">
<p>Before building the <code>OrderResourceAssembler</code>, let’s discuss what needs to happen. You are modeling the flow of states between <code>Status.IN_PROGRESS</code>, <code>Status.COMPLETED</code>, and <code>Status.CANCELLED</code>. A natural thing when serving up such data to clients is to let the clients make the decision on what it can do based on this payload.</p>
</div>
<div class="paragraph">
<p>But that would be wrong.</p>
</div>
<div class="paragraph">
<p>What happens when you introduce a new state in this flow? The placement of various buttons on the UI would probably be erroneous.</p>
</div>
<div class="paragraph">
<p>What if you changed the name of each state, perhaps while coding international support and showing locale-specific text for each state? That would most likely break all the clients.</p>
</div>
<div class="paragraph">
<p>Enter <strong>HATEOAS</strong> or <strong>Hypermedia as the Engine of Application State</strong>. Instead of clients parsing the payload, give them links to signal valid actions. Decouple state-based actions from the payload of data. In other words, when <strong>CANCEL</strong> and <strong>COMPLETE</strong> are valid actions, dynamically add them to the list of links. Clients only need show users the corresponding buttons when the links exist.</p>
</div>
<div class="paragraph">
<p>This decouples clients from having to know WHEN such actions are valid, reducing the risk of the server and its clients getting out of sync on the logic of state transitions.</p>
</div>
<div class="paragraph">
<p>Having already embraced the concept of Spring HATEOAS <code>ResourceAssembler</code> components, putting such logic in the <code>OrderResourceAssembler</code> would be the perfect place to capture this business rule:</p>
</div>
<div class="listingblock">
<div class="title">
links/src/main/java/payroll/OrderResourceAssembler.java
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package payroll;

import static org.springframework.hateoas.mvc.ControllerLinkBuilder.*;

import org.springframework.hateoas.Resource;
import org.springframework.hateoas.ResourceAssembler;
import org.springframework.stereotype.Component;

@Component
class OrderResourceAssembler implements ResourceAssembler&lt;Order, Resource&lt;Order&gt;&gt; {

  @Override
  public Resource&lt;Order&gt; toResource(Order order) {

    // Unconditional links to single-item resource and aggregate root

    Resource&lt;Order&gt; orderResource = new Resource&lt;&gt;(order,
      linkTo(methodOn(OrderController.class).one(order.getId())).withSelfRel(),
      linkTo(methodOn(OrderController.class).all()).withRel("orders")
    );

    // Conditional links based on state of the order

    if (order.getStatus() == Status.IN_PROGRESS) {
      orderResource.add(
        linkTo(methodOn(OrderController.class)
          .cancel(order.getId())).withRel("cancel"));
      orderResource.add(
        linkTo(methodOn(OrderController.class)
          .complete(order.getId())).withRel("complete"));
    }

    return orderResource;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This resource assembler always includes the <strong>self</strong> link to the single-item resource as well as a link back to the aggregate root. But it also includes two conditional links to <code>OrderController.cancel(id)</code> as well as <code>OrderController.complete(id)</code> (not yet defined). These links are ONLY shown when the order’s status is <code>Status.IN_PROGRESS</code>.</p>
</div>
<div class="paragraph">
<p>If clients can adopt HAL and the ability to read links instead of simply reading the data of plain old JSON, they can trade in the need for domain knowledge about the order system. This naturally reduces coupling between client and server. And it opens the door to tuning the flow of order fulfillment without breaking clients in the process.</p>
</div>
<div class="paragraph">
<p>To round out order fulfillment, add the following to the <code>OrderController</code> for the <code>cancel</code> operation:</p>
</div>
<div class="listingblock">
<div class="title">
Creating a "cancel" operation in the OrderController
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@DeleteMapping("/orders/{id}/cancel")
ResponseEntity&lt;ResourceSupport&gt; cancel(@PathVariable Long id) {

  Order order = orderRepository.findById(id).orElseThrow(() -&gt; new OrderNotFoundException(id));

  if (order.getStatus() == Status.IN_PROGRESS) {
    order.setStatus(Status.CANCELLED);
    return ResponseEntity.ok(assembler.toResource(orderRepository.save(order)));
  }

  return ResponseEntity
    .status(HttpStatus.METHOD_NOT_ALLOWED)
    .body(new VndErrors.VndError("Method not allowed", "You can't cancel an order that is in the " + order.getStatus() + " status"));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It checks the <code>Order</code> status before allowing it to be cancelled. If it’s not a valid state, it returns a Spring HATEOAS <code>VndError</code>, a hypermedia-supporting error container. If the transition is indeed valid, it transitions the <code>Order</code> to <code>CANCELLED</code>.</p>
</div>
<div class="paragraph">
<p>And add this to the <code>OrderController</code> as well for order completion:</p>
</div>
<div class="listingblock">
<div class="title">
Creating a "complete" operation in the OrderController
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@PutMapping("/orders/{id}/complete")
ResponseEntity&lt;ResourceSupport&gt; complete(@PathVariable Long id) {

    Order order = orderRepository.findById(id).orElseThrow(() -&gt; new OrderNotFoundException(id));

    if (order.getStatus() == Status.IN_PROGRESS) {
      order.setStatus(Status.COMPLETED);
      return ResponseEntity.ok(assembler.toResource(orderRepository.save(order)));
    }

    return ResponseEntity
      .status(HttpStatus.METHOD_NOT_ALLOWED)
      .body(new VndErrors.VndError("Method not allowed", "You can't complete an order that is in the " + order.getStatus() + " status"));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This implements similar logic to prevent an <code>Order</code> status from being completed unless in the proper state.</p>
</div>
<div class="paragraph">
<p>By adding a little extra initialization code to <code>LoadDatabase</code>:</p>
</div>
<div class="listingblock">
<div class="title">
Updating the database pre-loader
</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">orderRepository.save(new Order("MacBook Pro", Status.COMPLETED));
orderRepository.save(new Order("iPhone", Status.IN_PROGRESS));

orderRepository.findAll().forEach(order -&gt; {
  log.info("Preloaded " + order);
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>…​you can test things out!</p>
</div>
<div class="paragraph">
<p>To use the newly minted order service, just perform a few operations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -v http://localhost:8080/orders

{
  "_embedded": {
    "orderList": [
      {
        "id": 3,
        "description": "MacBook Pro",
        "status": "COMPLETED",
        "_links": {
          "self": {
            "href": "http://localhost:8080/orders/3"
          },
          "orders": {
            "href": "http://localhost:8080/orders"
          }
        }
      },
      {
        "id": 4,
        "description": "iPhone",
        "status": "IN_PROGRESS",
        "_links": {
          "self": {
            "href": "http://localhost:8080/orders/4"
          },
          "orders": {
            "href": "http://localhost:8080/orders"
          },
          "cancel": {
            "href": "http://localhost:8080/orders/4/cancel"
          },
          "complete": {
            "href": "http://localhost:8080/orders/4/complete"
          }
        }
      }
    ]
  },
  "_links": {
    "self": {
      "href": "http://localhost:8080/orders"
    }
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>This HAL document immediately shows different links for each order, based upon its present state.</p>
</div>
<div class="ulist">
<ul>
<li> <p>The first order, being <strong>COMPLETED</strong> only has the navigational links. The state transition links are not shown.</p> </li>
<li> <p>The second order, being <strong>IN_PROGRESS</strong> additionally has the <strong>cancel</strong> link as well as the <strong>complete</strong> link.</p> </li>
</ul>
</div>
<div class="paragraph">
<p>Try cancelling an order:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -v -X DELETE http://localhost:8080/orders/4/cancel

&gt; DELETE /orders/4/cancel HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.54.0
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 200
&lt; Content-Type: application/hal+json;charset=UTF-8
&lt; Transfer-Encoding: chunked
&lt; Date: Mon, 27 Aug 2018 15:02:10 GMT
&lt;
{
  "id": 4,
  "description": "iPhone",
  "status": "CANCELLED",
  "_links": {
    "self": {
      "href": "http://localhost:8080/orders/4"
    },
    "orders": {
      "href": "http://localhost:8080/orders"
    }
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>This response shows an <strong>HTTP 200</strong> status code indicating it was successful. The response HAL document shows that order in its new state (<code>CANCELLED</code>). And the state-altering links gone.</p>
</div>
<div class="paragraph">
<p>If you try the same operation again…​</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -v -X DELETE http://localhost:8080/orders/4/cancel

* TCP_NODELAY set
* Connected to localhost (::1) port 8080 (#0)
&gt; DELETE /orders/4/cancel HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.54.0
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 405
&lt; Content-Type: application/hal+json;charset=UTF-8
&lt; Transfer-Encoding: chunked
&lt; Date: Mon, 27 Aug 2018 15:03:24 GMT
&lt;
{
  "logref": "Method not allowed",
  "message": "You can't cancel an order that is in the CANCELLED status"
}</pre>
</div>
</div>
<div class="paragraph">
<p>…​you see an <strong>HTTP 405 Method Not Allowed</strong> response. <strong>DELETE</strong> has become an invalid operation. The <code>VndError</code> response object clearly indicates that you aren’t allowed to "cancel" an order already in the "CANCELLED" status.</p>
</div>
<div class="paragraph">
<p>Additionally, trying to complete the same order also fails:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -v -X PUT localhost:8080/orders/4/complete

* TCP_NODELAY set
* Connected to localhost (::1) port 8080 (#0)
&gt; PUT /orders/4/complete HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.54.0
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 405
&lt; Content-Type: application/hal+json;charset=UTF-8
&lt; Transfer-Encoding: chunked
&lt; Date: Mon, 27 Aug 2018 15:05:40 GMT
&lt;
{
  "logref": "Method not allowed",
  "message": "You can't complete an order that is in the CANCELLED status"
}</pre>
</div>
</div>
<div class="paragraph">
<p>With all this in place, your order fulfillment service is capable of conditionally showing what operations are available. It also guards against invalid operations.</p>
</div>
<div class="paragraph">
<p>By leveraging the protocol of hypermedia and links, clients can be built sturdier and less likely to break simply because of a change in the data. And Spring HATEOAS eases building the hypermedia you need to serve to your clients.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary">Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Throughout this tutorial, you have engaged in various tactics to build REST API. As it turns out, REST isn’t just about pretty URIs and returning JSON instead of XML.</p>
</div>
<div class="paragraph">
<p>Instead, the following tactics help make your services less likely to break existing clients you may or may not control:</p>
</div>
<div class="ulist">
<ul>
<li> <p>Don’t remove old fields. Instead, support them.</p> </li>
<li> <p>Use rel-based links so clients don’t have to hard code URIs.</p> </li>
<li> <p>Retain old links as long as possible. Even if you have to change the URI, keep the rels so older clients have a path onto the newer features.</p> </li>
<li> <p>Use links, not payload data, to instruct clients when various state-driving operations are available.</p> </li>
</ul>
</div>
<div class="paragraph">
<p>It may appear to be a bit of effort to build up <code>ResourceAssembler</code> implementations for each resource type and to use these components in all of your controllers. But this extra bit of server-side setup (made easy thanks to Spring HATEOAS) can ensure the clients you control (and more importantly, those you don’t) can upgrade with ease as you evolve your API.</p>
</div>
<div class="paragraph">
<p>This concludes our tutorial on how to build RESTful services using Spring. Each section of this tutorial is managed as a separate subproject in a single github repo:</p>
</div>
<div class="ulist">
<ul>
<li> <p><strong>nonrest</strong> - Simple Spring MVC app with no hypermedia</p> </li>
<li> <p><strong>rest</strong> - Spring MVC + Spring HATEOAS app with HAL representations of each resource</p> </li>
<li> <p><strong>evolution</strong> - REST app where a field is evolved but old data is retained for backward compatibility</p> </li>
<li> <p><strong>links</strong> - REST app where conditional links are used to signal valid state changes to clients</p> </li>
</ul>
</div>
<div class="paragraph">
<p>To view more examples of using Spring HATEOAS see <a href="https://github.com/spring-projects/spring-hateoas-examples" class="bare">https://github.com/spring-projects/spring-hateoas-examples</a>.</p>
</div>
<div class="paragraph">
<p>To do some more exploring check out the following video by Spring teammate Oliver Gierke:</p>
</div>
<div class="videoblock">
<div class="content">
<iframe src="https://www.youtube.com/embed/WDBUlu_lYas?rel=0" frameborder="0" allowfullscreen></iframe>
</div>
</div>
<div class="paragraph">
<p>Want to write a new guide or contribute to an existing one? Check out our <a href="https://github.com/spring-guides/getting-started-guides/wiki">contribution guidelines</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tbody>
<tr>
<td class="icon"> <i class="fa icon-important" title="Important"></i> </td>
<td class="content"> All guides are released with an ASLv2 license for the code, and an <a href="https://creativecommons.org/licenses/by-nd/3.0/">Attribution, NoDerivatives creative commons license</a> for the writing. </td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</article>
</div>
<aside class="span4 content-right-pane--container mobile-left-pane" id="sidebar">
<a class="ci-status desktop-only" href="https://travis-ci.org/spring-guides/tut-rest">
<img src="https://travis-ci.org/spring-guides/tut-rest.svg?branch=master" />
</a>
<div class="right-pane-widget--container desktop-only">
<div class="github-actions https">
<h2>Get the Code</h2>
<div class="btn-group">
<button class="btn" data-protocol="https">HTTPS</button>
<button class="btn" data-protocol="ssh">SSH</button>
</div>
<div class="clone-url https">
<input id="clone-url-https" readonly="readonly" type="text" value="https://github.com/spring-guides/tut-rest.git" />
<button class="copy-button github" data-toggle="tooltip" data-clipboard-text="https://github.com/spring-guides/tut-rest.git"></button>
</div>
<div class="clone-url ssh">
<input id="clone-url-ssh" readonly="readonly" type="text" value="git@github.com:spring-guides/tut-rest.git" />
<button class="copy-button github" data-toggle="tooltip" data-clipboard-text="git@github.com:spring-guides/tut-rest.git"></button>
</div>
<a class="github_download btn btn-black uppercase" href="https://github.com/spring-guides/tut-rest/archive/master.zip">Download ZIP</a>
<a class="gs-guide-import" href="https://github.com/spring-guides/tut-rest.git">Import into STS</a>
<div class="go-to-repo--container">
<a href="https://github.com/spring-guides/tut-rest"><i class="icon-github"></i>Go To Repo</a>
</div>
<div class="go-to-repo--container">
</div>
</div>
</div>
<div class="right-pane-widget--container">
<div>
<h3><a class="anchor" href="#table-of-contents" name="table-of-contents"></a>Table of contents</h3>
<div><ul class="sectlevel1">
<li><a href="#_getting_started">Getting Started</a></li>
<li><a href="#_the_story_so_far">The Story so Far…​</a></li>
<li><a href="#_http_is_the_platform">HTTP is the Platform</a></li>
<li><a href="#_what_makes_something_restful">What makes something RESTful?</a></li>
<li><a href="#_simplifying_link_creation">Simplifying Link Creation</a></li>
<li><a href="#_evolving_rest_apis">Evolving REST APIs</a></li>
<li><a href="#_building_links_into_your_rest_api">Building links into your REST API</a></li>
<li><a href="#_summary">Summary</a></li>
</ul></div>
</div>
</div>
</aside>
</div>
</main>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
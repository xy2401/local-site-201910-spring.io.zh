<html  data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>Behind the Spring Security Namespace</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="Behind the Spring Security Namespace">
<meta name="twitter:description" content="<p>With the introduction of the security schema in Spring Security 2, it became much easier to get a simple secured application up and running. In older versions, users had to declare and wire-up all the implementation beans individually, resulting in large and complicated Spring application context files which were difficult to understand and maintain. There was a pretty steep learning curve and I can still remember that it took me some time to get my head round it all when I started working on the project (then Acegi Security), back in 2004. On the positive side, this exposure to the basic building blocks of the framework meant that once you had managed to put together a working configuration, it was almost impossible not to have gained at least some awareness of the important classes and how they work together. This knowledge in turn put you in a good position to take advantage of the opportunities for customization that are one of the biggest benefits of using Spring Security.</p>
">
<meta name="twitter:creator" content="@tekul">
<meta name="twitter:image:src" content="https://gravatar.com/avatar/91c15183d9efc15c30ff1e65f084314d?s=200">

<meta property="og:title" content="Behind the Spring Security Namespace">
<meta property="og:image" content="https://gravatar.com/avatar/91c15183d9efc15c30ff1e65f084314d?s=200">
<meta property="og:description" content="<p>With the introduction of the security schema in Spring Security 2, it became much easier to get a simple secured application up and running. In older versions, users had to declare and wire-up all the implementation beans individually, resulting in large and complicated Spring application context files which were difficult to understand and maintain. There was a pretty steep learning curve and I can still remember that it took me some time to get my head round it all when I started working on the project (then Acegi Security), back in 2004. On the positive side, this exposure to the basic building blocks of the framework meant that once you had managed to put together a working configuration, it was almost impossible not to have gained at least some awareness of the important classes and how they work together. This knowledge in turn put you in a good position to take advantage of the opportunities for customization that are one of the biggest benefits of using Spring Security.</p>
">
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2010-03-06 21:38:00.0">
</head>
<body >

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Behind the Spring Security Namespace</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/91c15183d9efc15c30ff1e65f084314d?s=20&d=mm">
<span class="author">Luke Taylor</span>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2010-03-06 21:38:00.0">March 06, 2010</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2010/03/06/behind-the-spring-security-namespace#disqus_thread" data-disqus-identifier="305">
</a></div>
</div>
</header>
<div class="blog--post"><p>With the introduction of the security schema in Spring Security 2, it became much easier to get a simple secured application up and running. In older versions, users had to declare and wire-up all the implementation beans individually, resulting in large and complicated Spring application context files which were difficult to understand and maintain. There was a pretty steep learning curve and I can still remember that it took me some time to get my head round it all when I started working on the project (then Acegi Security), back in 2004. On the positive side, this exposure to the basic building blocks of the framework meant that once you had managed to put together a working configuration, it was almost impossible not to have gained at least some awareness of the important classes and how they work together. This knowledge in turn put you in a good position to take advantage of the opportunities for customization that are one of the biggest benefits of using Spring Security.</p><p>We now have many Spring Security users who have started out using the namespace and have benefited from the simplicity and rapid development opportunities that it offers, but things get more difficult when you want to move beyond the features offered by the namespace. At that point you have to start to understand the framework architecture and how your custom classes will fit in. You have to know which classes to extend, which strategy interfaces to implement and where to plug them in. The learning curve is still there, it has just moved. The namespace intentionally provides a high-level view of the problem domain addressed by Spring Security and as such it actually hides the implementation details, making it difficult to know what is really going on. It does provide a lot of extension points, but for whatever reason you may feel you need to dig deeper.</p><p>In this article we’ll take a look at a simple namespace configuration for a web application and what it would look like as a full-blown Spring bean configuration. We won’t go into all the details of what the beans do, but you can find more information on specific classes and interfaces in the reference manual and Javadoc. The material here is mainly targeted at existing users who are already familiar with the basics, so if you haven’t used Spring Security before you should at least read the namespace chapter in the <a href="http://static.springsource.org/spring-security/site/docs/3.0.x/reference/ns-config.html">reference manual </a> and spend some time looking at the sample applications.</p>
<h2>Namespace Configuration</h2><p>First let’s look at the namespace configuration we want to replace. </p>
<pre><code class="prettyprint xml"><br />&lt;beans:beans xmlns=&quot;http://www.springframework.org/schema/security&quot;
    xmlns:beans=&quot;http://www.springframework.org/schema/beans&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xsi:schemaLocation=&quot;
      http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
      http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.0.xsd&quot;&gt;

    &lt;http&gt;
        &lt;intercept-url pattern=&quot;/secure/extreme/**&quot; access=&quot;ROLE_SUPERVISOR&quot; /&gt;
        &lt;intercept-url pattern=&quot;/secure/**&quot; access=&quot;IS_AUTHENTICATED_FULLY&quot; /&gt;
        &lt;intercept-url pattern=&quot;/login.htm&quot; access=&quot;IS_AUTHENTICATED_ANONYMOUSLY&quot; /&gt;
        &lt;intercept-url pattern=&quot;/images/*&quot; filters=&quot;none&quot; /&gt;
        &lt;intercept-url pattern=&quot;/**&quot; access=&quot;ROLE_USER&quot; /&gt;
        &lt;form-login login-page=&quot;/login.htm&quot; default-target-url=&quot;/home.htm&quot; /&gt;
        &lt;logout logout-success-url=&quot;/logged_out.htm&quot; /&gt;
    &lt;/http&gt;

    &lt;authentication-manager&gt;
        &lt;authentication-provider&gt;
            &lt;password-encoder hash=&quot;md5&quot;/&gt;
            &lt;user-service&gt;
                &lt;user name=&quot;bob&quot; password=&quot;12b141f35d58b8b3a46eea65e6ac179e&quot; authorities=&quot;ROLE_SUPERVISOR, ROLE_USER&quot; /&gt;
                &lt;user name=&quot;sam&quot; password=&quot;d1a5e26d0558c455d386085fad77d427&quot; authorities=&quot;ROLE_USER&quot; /&gt;
            &lt;/user-service&gt;
        &lt;/authentication-provider&gt;
    &lt;/authentication-manager&gt;

&lt;/beans:beans&gt;
</code></pre><p>This is a pretty straightforward example, similar to what you’ll see in online examples and the sample applications that come with the project. It defines an in-memory list of user accounts to authenticate against, with a list of authorities (in this case simple roles) for each user. It also configures a set of protected URL patterns within the web application, a form-based authentication mechanism and support for a basic logout URL.</p><p>How would we reproduce this with an old-fashioned bean configuration? Time for a trip down memory lane for those who were around in the Acegi Security days.</p>
<h2>Spring Bean Version</h2>
<h3>Authentication Beans</h3><p>Let’s look at the <authentication-manager> element first, which (as of Spring Security 3.0) must be declared in any namespace-based configuration. In this example, the <http> part depends on this element (the form-login authentication mechanism uses it to authenticate against). The actual dependency is on the interface <tt>AuthenticationManager</tt>, which encapsulates the authentication services provided by a Spring Security configuration. You could provide your own implementation at this level, but most people use the default, <tt>ProviderManager</tt>, which delegates to a list of <tt>AuthenticationProvider</tt> instances. The configuration could look like this:</http></authentication-manager></p>
<pre><code class="prettyprint xml"><br />&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
    xmlns:sec=&quot;http://www.springframework.org/schema/security&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xsi:schemaLocation=&quot;
      http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
      http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.0.xsd&quot;&gt;

    &lt;bean id=&quot;authenticationManager&quot; class=&quot;org.springframework.security.authentication.ProviderManager&quot;&gt;
        &lt;property name=&quot;providers&quot;&gt;
            &lt;list&gt;
                &lt;ref bean=&quot;authenticationProvider&quot; /&gt;
                &lt;ref bean=&quot;anonymousProvider&quot; /&gt;
            &lt;/list&gt;
        &lt;/property&gt;
    &lt;/bean&gt;

    &lt;bean id=&quot;authenticationProvider&quot; class=&quot;org.springframework.security.authentication.dao.DaoAuthenticationProvider&quot;&gt;
        &lt;property name=&quot;passwordEncoder&quot;&gt;
            &lt;bean class=&quot;org.springframework.security.authentication.encoding.Md5PasswordEncoder&quot; /&gt;
        &lt;/property&gt;
        &lt;property name=&quot;userDetailsService&quot; ref=&quot;userService&quot; /&gt;
    &lt;/bean&gt;

    &lt;bean id=&quot;anonymousProvider&quot; class=&quot;org.springframework.security.authentication.AnonymousAuthenticationProvider&quot;&gt;
        &lt;property name=&quot;key&quot; value=&quot;SomeUniqueKeyForThisApplication&quot; /&gt;
    &lt;/bean&gt;

    &lt;sec:user-service id=&quot;userService&quot;&gt;
        &lt;sec:user name=&quot;bob&quot; password=&quot;12b141f35d58b8b3a46eea65e6ac179e&quot; authorities=&quot;ROLE_SUPERVISOR, ROLE_USER&quot; /&gt;
        &lt;sec:user name=&quot;sam&quot; password=&quot;d1a5e26d0558c455d386085fad77d427&quot; authorities=&quot;ROLE_USER&quot; /&gt;
    &lt;/sec:user-service&gt;

&lt;/beans&gt;
</code></pre><p>At this stage we’ve left the <user-service> element in place to illustrate that it can be used in isolation to create a <tt>UserDetailsService</tt> instance which is injected into the <tt>DaoAuthenticationProvider</tt>. We’ve also switched to using “beans” as the default XML namespace. We’ll assume this from now on. <tt>UserDetailsService</tt> is an important interface in the framework and is just a DAO for user information. Its only responsibility is to load the data for a named user account. The bean equivalent would be</user-service></p>
<pre><code class="prettyprint xml"><br />&lt;bean id=&quot;userService&quot; class=&quot;org.springframework.security.core.userdetails.memory.InMemoryDaoImpl&quot;&gt;
    &lt;property name=&quot;userMap&quot;&gt;
        &lt;value&gt;
            bob=12b141f35d58b8b3a46eea65e6ac179e,ROLE_SUPERVISOR,ROLE_USER
            sam=d1a5e26d0558c455d386085fad77d427,ROLE_USER
        &lt;/value&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</code></pre><p>In this case, the namespace syntax is clearer, but you may want to use your own <tt>UserDetailsService</tt> implementation. Spring Security also has standard JDBC and LDAP-based versions. We’ve also added in an <tt>AnonymousAuthenticationProvider</tt> which is purely there to support the <tt>AnonymousAuthenticationFiter</tt> which appears in the web configuration below.</p>
<h3>Web Beans</h3><p>Now we’ll take a look at how the <http> block can be expanded. This is more complicated as the created beans do not not map as obviously to the element names used in the namespace. </http></p>
<h4>The <tt>FilterChainProxy</tt></h4><p>As you probably already know, Spring Security’s web functionality is implemented using servlet filters. It maintains its own chain of filters in the application context and delegates to this using an instance of Spring’s <tt>DelegatingFilterProxy</tt> defined in the web.xml file. The class which implements this delegate filter chain (or potentially multiple chains) is called <tt>FilterChainProxy</tt>. You can think of the <http> block as creating the <tt>FilterChainProxy bean</tt>. <tt>FilterChainProxy</tt> has a property called <tt>filterChainMap</tt>, which is a map of patterns to lists of filter beans. So for example, you might have something like this:</http></p>
<pre><code class="prettyprint xml"><br />    &lt;bean id=&quot;filterChainProxy&quot; class=&quot;org.springframework.security.web.FilterChainProxy&quot;&gt;
        &lt;property name=&quot;matcher&quot;&gt;
            &lt;bean class=&quot;org.springframework.security.web.util.AntUrlPathMatcher&quot;/&gt;
        &lt;/property&gt;
        &lt;property name=&quot;filterChainMap&quot;&gt;
            &lt;map&gt;
                &lt;entry key=&quot;/somepath/**&quot;&gt;
                    &lt;list&gt;
                      &lt;ref local=&quot;filter1&quot;/&gt;
                    &lt;/list&gt;
                &lt;/entry&gt;
                &lt;entry key=&quot;/images/*&quot;&gt;
                    &lt;list/&gt;
                &lt;/entry&gt;
                &lt;entry key=&quot;/**&quot;&gt;
                    &lt;list&gt;
                      &lt;ref local=&quot;filter1&quot;/&gt;
                      &lt;ref local=&quot;filter2&quot;/&gt;
                      &lt;ref local=&quot;filter3&quot;/&gt;
                    &lt;/list&gt;
                &lt;/entry&gt;
            &lt;/map&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
</code></pre><p>where filter1, filter2 etc. are the names of other beans in the application context which implement the <tt>javax.servlet.Filter</tt> interface.</p><p>So <tt>FilterChainProxy</tt> matches incoming requests to lists of filters and passes a request through the first matching chain it finds. Note that with the exception of the “/images/*” pattern (which maps to an empty filter chain), these are not connected with the patterns in the <intercept-url>< namespace="" elements.="" the="" <http=""> configuration is currently only capable of maintaining a single list of filters mapped to all requests (except those which are configured to bypass the filter chain completely).</http=""></intercept-url><></p><p>Since the configuration above is a bit on the verbose side, there is a more compact namespace syntax which can be used to configure a <tt>FilterChainProxy</tt> map, without losing any functionality. The equivalent of the above would then be:</p>
<pre><code class="prettyprint xml"><br />    &lt;bean id=&quot;filterChainProxy&quot; class=&quot;org.springframework.security.web.FilterChainProxy&quot;&gt;
        &lt;sec:filter-chain-map path-type=&quot;ant&quot;&gt;
            &lt;sec:filter-chain pattern=&quot;/somepath/**&quot; filters=&quot;filter1&quot;/&gt;
            &lt;sec:filter-chain pattern=&quot;/images/*&quot; filters=&quot;none&quot;/&gt;
            &lt;sec:filter-chain pattern=&quot;/**&quot; filters=&quot;filter1, filter2, filter3&quot;/&gt;
        &lt;/sec:filter-chain-map&gt;
    &lt;/bean&gt;
</code></pre><p>The filter chains are now specified as an ordered list of bean names, in the order the filters will be applied. So what filters would our original namespace configuration create? In this case the <tt>FilterChainProxy</tt> would be:</p>
<pre><code class="prettyprint xml"><br />    &lt;alias name=&quot;filterChainProxy&quot; alias=&quot;springSecurityFilterChain&quot;/&gt;

    &lt;bean id=&quot;filterChainProxy&quot; class=&quot;org.springframework.security.web.FilterChainProxy&quot;&gt;
        &lt;sec:filter-chain-map path-type=&quot;ant&quot;&gt;
            &lt;sec:filter-chain pattern=&quot;/images/*&quot; filters=&quot;none&quot;/&gt;
            &lt;sec:filter-chain pattern=&quot;/**&quot; filters=&quot;securityContextFilter, logoutFilter, formLoginFilter, requestCacheFilter, 
                     servletApiFilter, anonFilter, sessionMgmtFilter, exceptionTranslator, filterSecurityInterceptor&quot; /&gt;
        &lt;/sec:filter-chain-map&gt;
    &lt;/bean&gt;
</code></pre><p>So there are nine filters in there, some of which are optional and some of which are essential. At this point you can see that you are now exposed to many of the the details which the namespace protects you from. You control both the filters used and the order they are invoked in, both of which are crucial.</p><p>We’ve also added alias for the bean, to match the name used previously in <tt>web.xml</tt>. Alternatively, you could just use “filterChainProxy” directly.</p>
<h4>The Filter Beans</h4><p>We’ll now look at those nine filter beans and the other beans that are required to support them.</p>
<pre><code class="prettyprint xml"><br />&lt;bean id=&quot;securityContextFilter&quot; class=&quot;org.springframework.security.web.context.SecurityContextPersistenceFilter&quot; &gt;
    &lt;property name=&quot;securityContextRepository&quot; ref=&quot;securityContextRepository&quot; /&gt;
&lt;/bean&gt;

&lt;bean id=&quot;securityContextRepository&quot; 
        class=&quot;org.springframework.security.web.context.HttpSessionSecurityContextRepository&quot; /&gt;

&lt;bean id=&quot;logoutFilter&quot; class=&quot;org.springframework.security.web.authentication.logout.LogoutFilter&quot;&gt;
    &lt;constructor-arg value=&quot;/logged_out.htm&quot; /&gt;
    &lt;constructor-arg&gt;
        &lt;list&gt;&lt;bean class=&quot;org.springframework.security.web.authentication.logout.SecurityContextLogoutHandler&quot; /&gt;&lt;/list&gt;
    &lt;/constructor-arg&gt;
&lt;/bean&gt;

&lt;bean id=&quot;formLoginFilter&quot; class=&quot;org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter&quot;&gt;
    &lt;property name=&quot;authenticationManager&quot; ref=&quot;authenticationManager&quot; /&gt;
    &lt;property name=&quot;authenticationSuccessHandler&quot;&gt;
        &lt;bean class=&quot;org.springframework.security.web.authentication.SavedRequestAwareAuthenticationSuccessHandler&quot;&gt;
            &lt;property name=&quot;defaultTargetUrl&quot; value=&quot;/index.jsp&quot; /&gt;
        &lt;/bean&gt;
    &lt;/property&gt;
    &lt;property name=&quot;sessionAuthenticationStrategy&quot;&gt;
        &lt;bean class=&quot;org.springframework.security.web.authentication.session.SessionFixationProtectionStrategy&quot; /&gt;
    &lt;/property&gt;
&lt;/bean&gt;

&lt;bean id=&quot;requestCacheFilter&quot; class=&quot;org.springframework.security.web.savedrequest.RequestCacheAwareFilter&quot; /&gt;

&lt;bean id=&quot;servletApiFilter&quot; class=&quot;org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter&quot; /&gt;

&lt;bean id=&quot;anonFilter&quot; class=&quot;org.springframework.security.web.authentication.AnonymousAuthenticationFilter&quot; &gt;
    &lt;property name=&quot;key&quot; value=&quot;SomeUniqueKeyForThisApplication&quot; /&gt;
    &lt;property name=&quot;userAttribute&quot; value=&quot;anonymousUser,ROLE_ANONYMOUS&quot; /&gt;
&lt;/bean&gt;

&lt;bean id=&quot;sessionMgmtFilter&quot; class=&quot;org.springframework.security.web.session.SessionManagementFilter&quot; &gt;
    &lt;constructor-arg ref=&quot;securityContextRepository&quot; /&gt;
&lt;/bean&gt;

&lt;bean id=&quot;exceptionTranslator&quot; class=&quot;org.springframework.security.web.access.ExceptionTranslationFilter&quot;&gt;
    &lt;property name=&quot;authenticationEntryPoint&quot;&gt;
        &lt;bean class=&quot;org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint&quot;&gt;
            &lt;property name=&quot;loginFormUrl&quot; value=&quot;/login.htm&quot;/&gt;
        &lt;/bean&gt;
    &lt;/property&gt;
&lt;/bean&gt;

&lt;bean id=&quot;filterSecurityInterceptor&quot; class=&quot;org.springframework.security.web.access.intercept.FilterSecurityInterceptor&quot;&gt;
    &lt;property name=&quot;securityMetadataSource&quot;&gt;
        &lt;sec:filter-security-metadata-source&gt;
            &lt;sec:intercept-url pattern=&quot;/secure/extreme/*&quot; access=&quot;ROLE_SUPERVISOR&quot;/&gt;
            &lt;sec:intercept-url pattern=&quot;/secure/**&quot; access=&quot;IS_AUTHENTICATED_FULLY&quot; /&gt;
            &lt;sec:intercept-url pattern=&quot;/login.htm&quot; access=&quot;IS_AUTHENTICATED_ANONYMOUSLY&quot; /&gt;
            &lt;sec:intercept-url pattern=&quot;/**&quot; access=&quot;ROLE_USER&quot; /&gt;
        &lt;/sec:filter-security-metadata-source&gt;
    &lt;/property&gt;
    &lt;property name=&quot;authenticationManager&quot; ref=&quot;authenticationManager&quot; /&gt;
    &lt;property name=&quot;accessDecisionManager&quot; ref=&quot;accessDecisionManager&quot; /&gt;
&lt;/bean&gt;

</code></pre><p>Again, we’ve used a convenient namespace element, <tt>filter-security-metadata-source</tt>, to create the <tt>SecurityMetadataSource</tt> instance which is used by the <tt>FilterSecurityInterceptor</tt>, but you can insert your own bean here (see <a href="http://static.springsource.org/spring-security/site/faq.html#faq-dynamic-url-metadata">this FAQ</a> for an example). The <tt>filter-security-metadata-source</tt> element creates an instance of <tt>DefaultFilterInvocationSecurityMetadataSource</tt>.</p>
<h5><tt>SecurityContextPersistenceFilter</tt></h5><p>This filter must be included in any filter chain. It is responsible for storing authentication information (a <tt>SecurityContext</tt> instance) between requests. It also for sets up the thread-local variable in which it is stored during a request and clears it when the request completes. Its default strategy is to store the <tt>SecurityContext</tt> in the HTTP session, hence the use of the <tt>HttpSessionSecurityContextRepository</tt> bean.</p>
<h5>Access Control</h5><p><tt>FilterSecurityInterceptor</tt> sits at the end of the stack and applies the configured security contraints to incoming requests. If the request is not authorized (either because the user isn’t authenticated, or because they don’t have the required authorities) it will raise an exception. This will be handled by the <tt>ExceptionTranslationFilter</tt> which will either send the user an access denied message, or start the authentication process by invoking the configured <tt>AuthenticationEntryPoint</tt>. In this case, a <tt>LoginUrlAuthenticationEntryPoint</tt> is in use, which redirects the user to a login page. Before doing this, <tt>ExceptionTranslationFilter</tt> will cache the current request information, so that it can be restored after authentication, if required.</p>
<h5>The Authentication Process</h5><p><tt>UsernamePasswordAuthenticationFilter</tt> is responsible for processing a submitted login form (it’s created by the <form-login> namespace element). The bean has been configured with a <tt>SavedRequestAwareAuthenticationSuccessHandler</tt> which means that it will redirect the user to the URL that they originally requested before they were asked to authenticate. The original request is then restored by the <tt>RequestCacheFilter</tt> which using a request wrapper, allowing the user to continue from the point they left off.</form-login></p>
<h5>Other Miscellaneous Filters</h5><p><tt>LogoutFilter</tt> is simply responsible for processing a logout link (<tt>/j_spring_security_logout</tt> by default), clearing the security context and invalidating the session. <tt>AnonymousAuthenticationFilter</tt> is responsible for populating the security context for anonymous users, making it easier to apply default security restrictions which are relaxed for certain URLs. For example, in the above configuration, the <tt>IS_AUTHENTICATED_ANONYMOUSLY</tt> attribute implies that anonymous users can access the login page (but nothing else). Check out the chapter on this in the manual for more information. Its use is optional, and you can remove the extra <tt>AnonymousAuthenticationProvider</tt> if you aren’t using it.</p><p><tt>SecurityContextHolderAwareRequestFilter</tt> provides the standard servlet API security methods, using a request wrapper which accesses the SecurityContext. If you don’t need these methods, you can omit this filter. <tt>SessionManagementFilter</tt> is responsible for applying a session-related strategy if the user is authenticated <em>during the current request</em> (for example, by remember-me authentication). In it’s default configuration it will create a new session (copying the attributes from the existing one) with the aim of changing the session identifier, and providing a defence against session-fixation attacks. It is also used when Spring Security’s concurrent session control is being used. In this configuration, the <tt>UsernamePasswordAuthenticationFilter</tt> is the only authentication mechanism in place, and is also injected with a <tt>SessionFixationProtectionStrategy</tt>. This means we can safely remove the session-management filter.</p>
<h4>The <tt>AccessDecisionManager</tt></h4><p>If you’ve been paying close attention, you’ll notice that we are still missing a bean reference from the above configuration. The security interceptor needs to be configured with an <tt>AccessDecisionManager</tt>. If you’re using the namespace, then one is created internally, though you can also plug in a custom bean. Without the namespace, we need to supply one explicitly. The equivalent of the namespace internal version would look like this:</p>
<pre><code class="prettyprint xml"><br />    &lt;bean id=&quot;accessDecisionManager&quot; class=&quot;org.springframework.security.access.vote.AffirmativeBased&quot;&gt;
        &lt;property name=&quot;decisionVoters&quot;&gt;
            &lt;list&gt;
                &lt;bean class=&quot;org.springframework.security.access.vote.RoleVoter&quot;/&gt;
                &lt;bean class=&quot;org.springframework.security.access.vote.AuthenticatedVoter&quot;/&gt;                
            &lt;/list&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
</code></pre>
<h4><tt>WebInvocationPrivilegeEvaluator</tt></h4><p>This is another bean which is registered by the namespace, even though it it isn’t directly required (it may be used in some JSP tags). It allows you to query whether the current user is allowed to invoke a particular URL. It can be useful in your controller beans to establish what information or navigation links should be made available in a presented view.</p>
<pre><code class="prettyprint xml"><br />    &lt;bean id=&quot;webPrivilegeEvaluator&quot; class=&quot;org.springframework.security.web.access.DefaultWebInvocationPrivilegeEvaluator&quot;&gt;
        &lt;constructor-arg ref=&quot;filterSecurityInterceptor&quot; /&gt;
    &lt;/bean&gt;
</code></pre>
<h5>Conclusion</h5><p>Once again, this article isn’t intended to explain in detail how all these beans work, but mainly to provide a reference to help to move on from a basic namespace configuration and to understand what lies underneath. As you can see, it’s quite complicated! But remember that it’s possible to plug quite a few of these beans into the namespace configuration itself, and you can now see where they’re actually going. And now that you know which classes are involved, you know where to look for further information in the Spring Security Reference Manual, the Javadoc and of course the source code itself. </p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 305;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
© <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
 <a href="https://pivotal.io/terms-of-use">Terms of Use</a> •
<a href="https://pivotal.io/privacy-policy">Privacy</a> •
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
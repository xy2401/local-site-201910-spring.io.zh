<html  data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>Hyperic 4.5发布</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="Hyperic 4.5 Released">
<meta name="twitter:description" content="<p>After many months of development, I am proud to announce the release of <a href=" http:="" ="" blog.hyperic.com="" substantial-infrastructure-upgrade-in-hyperic-4-5-releas="=" _blan=""></head><body >Hyperic 4.5. In this release, we migrated Hyperic from an EJB application running on JBoss to a Spring web application running on Tomcat. The detailed migration steps are covered in my <a href="http://www.slideshare.net/hyperic/hyperic-casestudy-jenniferhickey1up" target="_blank">Case Study on Migrating Hyperic from EJB to Spring</a>, originally presented at the recent SpringOne 2GX. In this post, I would like to highlight a few of my favorite things about the conversion.<br>
<h2>Improved testability</h2>
<br>
<p></p>
<p>After the conversion, we were able to take advantage of Spring’s integration testing support to test our new service layer of converted EJBs as well as their underlying DAOs. By simply adding a few annotations, we were able to bootstrap our entire application context in less than 30 seconds and run each test method in a dedicated transaction that was automatically rolled back at the end of the test. This support proved very valuable in allowing us to quickly increase our test coverage by 18% and 12% in our open source and enterprise codebases respectively.</p>
">
<meta name="twitter:creator" content="@jencompgeek">
<meta name="twitter:image:src" content="https://gravatar.com/avatar/bce9d31f84872b48996a554465ab5f6a?s=200">

<meta property="og:title" content="Hyperic 4.5 Released">
<meta property="og:image" content="https://gravatar.com/avatar/bce9d31f84872b48996a554465ab5f6a?s=200">
<meta property="og:description" content="<p>After many months of development, I am proud to announce the release of <a href=" http:="" ="" blog.hyperic.com="" substantial-infrastructure-upgrade-in-hyperic-4-5-releas="=" _blan="">Hyperic 4.5. In this release, we migrated Hyperic from an EJB application running on JBoss to a Spring web application running on Tomcat. The detailed migration steps are covered in my <a href="http://www.slideshare.net/hyperic/hyperic-casestudy-jenniferhickey1up" target="_blank">Case Study on Migrating Hyperic from EJB to Spring</a>, originally presented at the recent SpringOne 2GX. In this post, I would like to highlight a few of my favorite things about the conversion.<br>
<h2>Improved testability</h2>
<br>
<p></p>
<p>After the conversion, we were able to take advantage of Spring’s integration testing support to test our new service layer of converted EJBs as well as their underlying DAOs. By simply adding a few annotations, we were able to bootstrap our entire application context in less than 30 seconds and run each test method in a dedicated transaction that was automatically rolled back at the end of the test. This support proved very valuable in allowing us to quickly increase our test coverage by 18% and 12% in our open source and enterprise codebases respectively.</p>
">
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2010-11-10 21:32:00.0">



<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">专案</a>
</li>
<li class="navbar-link">
<a href="/guides">导游</a>
</li>
<li class="navbar-link active">
<a href="/blog">博客</a>
</li>
<li class="navbar-link">
<a href="/services">培训与认证</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索文档，指南和帖子..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">家<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">专案<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">导游<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">博客<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">培训与认证<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>工程</div>
</div>
<div class="blog-category content--title">
<div>发布</div>
</div>
<div class="blog-category content--title">
<div>新闻与活动</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Hyperic 4.5发布</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">工程</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/bce9d31f84872b48996a554465ab5f6a?s=20&d=mm"> <span class="author">珍妮弗·希基</span>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2010-11-10 21:32:00.0">2010年11月10日</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2010/11/10/hyperic-4-5-released#disqus_thread" data-disqus-identifier="375">
</a></div>
</div>
</header>
<div class="blog--post"><p>经过几个月的开发，我很自豪地宣布<a href="http://blog.hyperic.com/substantial-infrastructure-upgrade-in-hyperic-4-5-release" target="_blank">Hyperic 4.5</a>的发布。在此版本中，我们将Hyperic从运行在JBoss上的EJB应用程序迁移到了运行在Tomcat上的Spring Web应用程序。我最近在SpringOne 2GX上提出的“将<a href="http://www.slideshare.net/hyperic/hyperic-casestudy-jenniferhickey1up" target="_blank">Hyperic从EJB迁移到Spring的案例研究”</a>中涵盖了详细的迁移步骤。在这篇文章中，我想重点介绍一些我最喜欢的有关转换的内容。<br></p><h2>改善的可测试性</h2><br>切换到Spring允许我们将现有的Stateless Session EJB转换为具有自动关联的POJO。这消除了相当多的静态JNDI查找代码，这些代码使单元测试变得如此困难。Spring还大大简化了集成测试。在转换之前，我们进行了一些集成测试，每个集成测试花费几分钟来引导EJB容器的近似值。该过程麻烦且容易出错。此外，测试经常使数据库处于不一致状态，从而有必要添加数据库设置或拆卸代码，从而增加了额外的开销来测试执行时间，并偶尔导致不一致的测试结果。<p></p><p>转换后，我们能够利用Spring的集成测试支持来测试转换后的EJB及其基础DAO的新服务层。通过简单地添加一些注释，我们能够在不到30秒的时间内引导整个应用程序上下文，并在专用事务中运行每种测试方法，该事务在测试结束时会自动回滚。事实证明，这种支持非常有价值，可以使我们在开放源代码和企业代码库中分别将测试覆盖率分别提高18％和12％。</p>
<pre><code class="prettyprint java"><br />@Transactional
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = &quot;classpath*:META-INF/spring/*-context.xml&quot;)
public class AppdefManagerTest  {

  @Autowired
  private AppdefManager appdefManager;

  @Before
  public void setUp() throws Exception {
      createPlatformType(&quot;TestPlatform&quot;, &quot;test&quot;);
  }

  @Test
  public void testGetControllablePlatformTypes() throws Exception {
      Map&lt;String, AppdefEntityID&gt; platformTypes = appdefManager
          .getControllablePlatformTypes(subject);
      assertEquals(1, platformTypes.size());
      assertEquals(&quot;TestPlatform&quot;, platformTypes.keySet().iterator().next());
  }
}
</code></pre>
<h2>降低代码复杂度</h2><p>只需引入Spring进行依赖注入，就可以消除冗长的依赖查找，从而在许多方面大大简化了代码。但是，在许多其他地方，Spring的引入大大提高了代码的清晰度，减少了基础结构的混乱，并使我们能够专注于真正的业务逻辑。我在Hyperic中最喜欢的两个示例是使用JmsTemplate发布JMS消息和使用JdbcTemplate进行数据访问。</p>
<h3>消息发布之前</h3>
<pre><code class="prettyprint java"><br />public void publishMessage(String name, Serializable sObj) {
       TopicConnection conn = null;
       TopicSession session = null;
       if (_ic == null)
               _ic = new InitialContext();
            if (_factory == null)
               _factory = _ic.lookup(CONN_FACTORY_JNDI);
            TopicConnectionFactory tFactory = (TopicConnectionFactory) _factory;
            Topic topic = getTopic(name);
            if (topic != null) {
               // Now create a connection to send a message
               if (_tConn != null)
                   conn = _tConn;
               else
                   conn = tFactory.createTopicConnection();
               if (conn == null)
                   _log.error(&quot;TopicConnection cannot be created&quot;);
               if (_tSession != null)
                   session = _tSession;
               else
                   session = conn.createTopicSession(false,
                                                     Session.AUTO_ACKNOWLEDGE);
               // Create a publisher and publish the message
               TopicPublisher publisher = session.createPublisher(topic);
               ObjectMessage msg = session.createObjectMessage();
               msg.setObject(sObj);
               publisher.publish(msg);
       ...
}
</code></pre>
<h3>消息发布后</h3>
<pre><code class="prettyprint java"><br />public void publishMessage(String name, Serializable sObj) {
       eventsJmsTemplate.convertAndSend(name, sObj);
}
</code></pre>
<h3>数据访问之前</h3>
<pre><code class="prettyprint java"><br />public int getServicesCount(AuthzSubject subject) {
       Statement stmt = null;
       ResultSet rs = null;
       Integer subjectId = subject.getId();
        try {
           Connection conn = getDBConn();
           String sql = &quot;SELECT COUNT(SVC.ID) FROM TBL_SERVICE&quot;;
           stmt = conn.createStatement();
           rs = stmt.executeQuery(sql);
           if (rs.next()) {
               return rs.getInt(1);
           }
       } catch (SQLException e) {
           log.error(&quot;Caught SQL Exception finding Services by type: &quot; + e, e);
                    throw new SystemException(e);
       } finally {
           DBUtil.closeJDBCObjects(LOG_CTX, null, stmt, rs);
       }
       return 0;
}
</code></pre>
<h3>之后的数据访问</h3>
<pre><code class="prettyprint java"><br />public int getServicesCount(AuthzSubject subject) {
       return jdbcTemplate.queryForInt(&quot;SELECT COUNT(SVC.ID) FROM TBL_SERVICE&quot;);
   }
</code></pre><p>那真是一个减肥计划！只需转换为Spring且不更改任何功能，我们就将开源和企业代码库减少了大约7％。</p>
<h2>提高开发人员生产力</h2><p>如上所述，Spring对集成测试的支持使我们能够在不到30秒的时间内启动整个应用程序上下文，以进行端到端集成测试。测试新功能或调试问题时，这可以节省大量时间。当我们确实需要启动整个Web应用程序时，切换到Tomcat可以显着减少启动时间，从而提高了生产率。现在，由一个开发人员对应用程序进行编码和调试，每次他/她启动该应用程序时，大约可以节省5分钟的等待时间。考虑到开发人员每天可能需要重启应用12次，因此每天可以腾出一整个小时来开发新功能！此外，更清晰的代码和改进的单元可测试性使查找和解决问题的速度变得更快，更容易，而灵活的体系结构使添加新功能和增强功能变得更加容易。</p><p>这些只是此版本中切换到Spring和Tomcat所提供的一些好处。在单个博客文章中确实有太多东西要列出！</p><p>此版本还包含对三个VMware vFabric平台服务的监视和管理，包括<a href="http://support.hyperic.com/display/EVO/Monitor+GemFire" target="_blank">vFabric GemFire 6.5分布式缓存系统</a> ， <a href="http://support.hyperic.com/display/EVO/Monitoring+RabbitMQ" target="_blank">RabbitMQ企业消息传递系统</a>以及本周也发布的新<a href="http://support.hyperic.com/display/EVO/SpringSource+tc+Runtime+6.0+server" target="_blank">vFabric tc Server</a> 2.1 Java运行时服务器。Hyperic的早期版本中已有对vFabric tc Server的支持。但是，在4.5中，该插件现已与Hyperic发行版捆绑在一起，不再是单独下载。在将来的博客文章中查找有关监视GemFire和RabbitMQ的更多信息。</p><p>在迁移时，我们还借此机会将代码存储库从Subversion迁移到git。要从git代码存储库下载源代码，请转到<a href="http://git.springsource.org/hq" target="_blank"></a> <a href="http://git.springsource.org/hq">http://git.springsource.org/hq</a> 。我们还将构建系统从ant切换到了maven。开发自定义插件或功能所需的所有Hyperic模块现在都可以从我们的maven存储库中下载，网址为： <a href="http://maven.hyperic.org/release" target="_blank"></a> <a href="http://maven.hyperic.org/release">http://maven.hyperic.org/release</a> 。</p>
<h2>结论</h2><p>我建议您下载<a href="http://www.hyperic.com/downloads" target="_blank">Hyperic 4.5</a>和/或<a href="http://git.springsource.org/hq" target="_blank">查看代码</a> 。与往常一样，非常感谢社区通过<a href="http://forums.hyperic.com/jiveforums/index.jspa" target="_blank">论坛提供的</a>反馈。我们期待在我们转换为Spring所提供的易于扩展的体系结构的基础上进行开发。请继续关注更多令人兴奋的增强功能！</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 375;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>请启用JavaScript以查看<a href="http://disqus.com/?ref_noscript">由Disqus提供</a>的<a href="http://disqus.com/?ref_noscript">评论。</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">由<span class="logo-disqus">Disqus</span>提供动力的评论</a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>背部</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">所有帖子</a> <a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">工程</a> <a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">发布</a> <a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">新闻与活动</a> <a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>将The Spring Team的更新发送到您的收件箱</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">球队</a></li>
<li><a href="/tools">工具类</a></li>
<li><a href="https://store.pivotal.io/">商店</a></li>
<li><a href="/blog">通讯</a></li>
</ul>
</div>
</div>© <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a> ，Inc.保留所有权利。
<a href="https://pivotal.io/terms-of-use">使用条款</a> • <a href="https://pivotal.io/privacy-policy">隐私</a> • <a href="/trademarks">商标准则</a>
<div id="teconsent" style="display:inline-block"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
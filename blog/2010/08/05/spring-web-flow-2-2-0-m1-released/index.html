<html  data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>Spring Web Flow 2.2.0。M1发布</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="Spring Web Flow 2.2.0.M1 Released">
<meta name="twitter:description" content="<p>I’m pleased to announce the first milestone of Spring Web Flow 2.2 is now available for <a href=" http:="" ="" www.springsource.com="" download="" community?project="Spring Web Flow""></head><body >download. The release is also available through the Maven milestone repository at <a href="http://maven.springframework.org/milestone">http://maven.springframework.org/milestone</a>. As with Spring Web Flow 2.1, this release requires JDK 1.5, Spring 3 and Spring Security 3. 
<p>The main focus of the release is to address the needs of JSF users by extending the list of supported <a href="http://andyschwartz.wordpress.com/2009/07/31/whats-new-in-jsf-2/">JSF 2 features</a>. Not long ago <a href="http://static.springsource.org/spring-webflow/docs/2.1.x/reference/htmlsingle/spring-webflow-reference.html#whatsnew">Web Flow 2.1</a> made it possible to use JSF 2 dependencies without the need for the separate Sun Facelets jar that is commonly used with JSF 1.2 today. </p>
">
<meta name="twitter:creator" content="@rstoya05">
<meta name="twitter:image:src" content="https://gravatar.com/avatar/4b12b9c0c665bc0345467c1a218ed0f7?s=200">

<meta property="og:title" content="Spring Web Flow 2.2.0.M1 Released">
<meta property="og:image" content="https://gravatar.com/avatar/4b12b9c0c665bc0345467c1a218ed0f7?s=200">
<meta property="og:description" content="<p>I’m pleased to announce the first milestone of Spring Web Flow 2.2 is now available for <a href=" http:="" ="" www.springsource.com="" download="" community?project="Spring Web Flow"">download. The release is also available through the Maven milestone repository at <a href="http://maven.springframework.org/milestone">http://maven.springframework.org/milestone</a>. As with Spring Web Flow 2.1, this release requires JDK 1.5, Spring 3 and Spring Security 3. 
<p>The main focus of the release is to address the needs of JSF users by extending the list of supported <a href="http://andyschwartz.wordpress.com/2009/07/31/whats-new-in-jsf-2/">JSF 2 features</a>. Not long ago <a href="http://static.springsource.org/spring-webflow/docs/2.1.x/reference/htmlsingle/spring-webflow-reference.html#whatsnew">Web Flow 2.1</a> made it possible to use JSF 2 dependencies without the need for the separate Sun Facelets jar that is commonly used with JSF 1.2 today. </p>
">
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2010-08-05 11:02:00.0">



<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">专案</a>
</li>
<li class="navbar-link">
<a href="/guides">导游</a>
</li>
<li class="navbar-link active">
<a href="/blog">博客</a>
</li>
<li class="navbar-link">
<a href="/services">培训与认证</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索文档，指南和帖子..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">家<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">专案<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">导游<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">博客<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">培训与认证<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>工程</div>
</div>
<div class="blog-category content--title">
<div>发布</div>
</div>
<div class="blog-category content--title">
<div>新闻与活动</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Spring Web Flow 2.2.0。M1发布</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">工程</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/4b12b9c0c665bc0345467c1a218ed0f7?s=20&d=mm"> <a class="author" rel="author" href="/team/rstoyanchev">罗森·斯托扬切夫（Rossen Stoyanchev）</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2010-08-05 11:02:00.0">2010年8月5日</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2010/08/05/spring-web-flow-2-2-0-m1-released#disqus_thread" data-disqus-identifier="346">
</a></div>
</div>
</header>
<div class="blog--post"><p>我很高兴地宣布，Spring Web Flow 2.2的第一个里程碑现已可供<a href="http://www.springsource.com/download/community?project=Spring Web Flow">下载</a> 。也可以通过Maven里程碑资料库（ <a href="http://maven.springframework.org/milestone">http://maven.springframework.org/milestone）</a>获得该版本。与Spring Web Flow 2.1一样，此发行版需要JDK 1.5，Spring 3和Spring Security 3。</p><p>该发行版的主要焦点是通过扩展受支持的<a href="https://andyschwartz.wordpress.com/2009/07/31/whats-new-in-jsf-2/">JSF 2功能</a>列表来满足JSF用户的需求。不久前， <a href="http://static.springsource.org/spring-webflow/docs/2.1.x/reference/htmlsingle/spring-webflow-reference.html#whatsnew">Web Flow 2.1</a>使得使用JSF 2依赖关系成为可能，而无需使用当今JSF 1.2常用的单独的Sun Facelets jar。</p><p>在Spring Web Flow 2.2中，您可以期待利用核心JSF 2功能和JSF 2组件库。这篇文章稍后会详细介绍组件库。首先，这里是新功能的概述。</p>
<h2>JSF 2 Ajax请求</h2><p>JSF 2定义了用于处理Ajax请求的客户端和服务器端工具。您可以使用<f:ajax>标记</f:ajax>将Ajax行为添加到组件， <f:ajax>如下所示：</f:ajax></p>
<pre><code class="prettyprint xml"><br />&lt;h:commandButton value=&quot;More Results&quot; action=&quot;next&quot;&gt;
    &lt;f:ajax render=&quot;@form&quot; /&gt;
&lt;/h:commandButton&gt;
</code></pre><p>当按下上述按钮时，会将Ajax请求发送到服务器，这将导致部分请求处理，渲染以及按钮所属表单的更新。</p><p>该<f:ajax>标记还支持其他属性，例如用于指定客户端事件（模糊，鼠标悬停等）的“事件”和用于指定应包含在请求处理生命周期的执行阶段中的组件的“执行”。<f:ajax>标签可以嵌套在其他标签内或周围。还有一个JavaScript API。有关更多详细信息和示例，请参见10.4.1.1节和JSF 2规范的第14章。</f:ajax></f:ajax></p><p>如果您是Web Flow 2用户，您将像今天一样熟悉处理上述请求：</p>
<pre><code class="prettyprint xml"><br />&lt;view-state id=&quot;reviewHotels&quot;&gt;
    &lt;transition on=&quot;next&quot;&gt;
        &lt;evaluate expression=&quot;searchCriteria.nextPage()&quot; /&gt;
    &lt;/transition&gt;
&lt;/view-state&gt;
</code></pre><p>“下一个”上的过渡没有目标视图状态。这将使我们保持当前视图，同时将SearchCriteria支持bean推进到下一页。为了确保在没有客户端重定向（POST-redirect-GET模式）的情况下进行渲染，您需要将Web Flow配置为能够识别JSF 2 Ajax请求：</p>
<pre><code class="prettyprint xml"><br />&lt;bean class=&quot;org.springframework.webflow.mvc.servlet.FlowHandlerAdapter&quot;&gt;
    &lt;property name=&quot;flowExecutor&quot; ref=&quot;flowExecutor&quot; /&gt;
    &lt;property name=&quot;ajaxHandler&quot;&gt;
        &lt;bean class=&quot;org.springframework.faces.webflow.JsfAjaxHandler&quot;/&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</code></pre><p>2.2.0中的预订界面示例。M1版本使用<f:ajax></f:ajax>标记整个使用案例，例如搜索结果分页和基于Ajax的表单验证。</p>
<h2>JSF 2资源请求</h2><p>JSF 2引入了ResourceHandler API，用于提供相对于Web应用程序根目录（在/ resources / **下）或在META-INF / resources / **下的类路径下打包的资源（图像，.js，.css文件）。JSF组件库可以通过API或@ResourceDependency批注透明地添加资源。或者，您也可以<outputscript>向视图</outputscript>添加<outputscript>标签。</outputscript></p><p>JSF呈现资源URL，以使它们指向相同的servlet，如下所示：<br>/myApp/myServlet/javax.faces.resources/<resourceidentifier></resourceidentifier></p><p>注意servlet映射之后的“ /javax.faces.resources”部分。这就是将其区别为JSF资源请求的原因。</p><p>在Web Flow中，JSF资源URL指向Spring MVC DispatcherServlet。为了处理这样的请求，提供了一个新的Spring MVC HttpRequestHandler来将资源请求委托给JSF 2资源处理机制。以下是配置此处理程序所需的配置。最终版本将<a href="https://jira.springframework.org/browse/SWF-1375">简化</a>此配置。</p>
<pre><code class="prettyprint xml"><br />&lt;bean class=&quot;org.springframework.web.servlet.handler.SimpleUrlHandlerMapping&quot;&gt;
    &lt;property name=&quot;mappings&quot; value=&quot;/javax.faces.resource/**=jsfResourceHandler&quot;/&gt;
&lt;/bean&gt;

&lt;bean class=&quot;org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter&quot; /&gt;

&lt;bean id=&quot;jsfResourceHandler&quot; class=&quot;org.springframework.faces.webflow.FacesJsfResourceRequestHandler&quot;/&gt;
</code></pre><p>2.2.0中的预订界面示例。M1版本包含必要的配置。</p>
<h2>部分状态保存</h2><p>可以说，部分状态保存是JSF 2（仅限于Facelets）中最重要的更改之一。它的工作方式是，不为每个视图存储整个组件树状态，部分状态保存算法始终将树恢复到其初始状态，然后应用并跟踪仅更改的内容。这样做的合理性是，组件树的更改可能小于整个组件树的状态，从而导致较少的内存使用。</p><p>在Web Flow中，JSF组件树状态始终存储在视图范围内的Web Flow变量中，而不是直接存储在HTTP会话中。不幸的是，要在JSF 1.2中实现这一目标，Web Flow必须接管整个状态保存算法。这就是为什么部分状态在Web Flow 2.1中无法立即使用，而必须通过“ javax.faces”禁用的原因。web.xml中的PARTIAL_STATE_SAVING”上下文参数。</p><p>通过对JSF 2状态保存的总体改进，可以委派给标准JSF StateManager实现并插入自定义ResponseStateManager以仅覆盖进行组件状态的实际读取和写入的部分。这就是Web Flow 2.2所做的，以提供对部分状态保存的支持。</p><p>此更改已通过Mojarra进行了测试，尤其是Mojarra 2.0.3版（推荐版本）。如果暂时使用Apache MyFaces JSF 2实现，则需要继续使用“ javax.faces”。PARTIAL_STATE_SAVING”参数可禁用部分状态保存。不幸的是，在MyFaces中，自定义状态是如何读取和写入状态并不是那么简单，因此将花费更多时间。</p>
<h2>每个请求一个FacesContext</h2><p>需要进行部分更改以保存部分状态，以确保在单个流程请求期间使用一个FacesContext实例。正如您在JIRA中的一些评论所证明的那样，这对于JSF用户而言可能是一个可喜的变化。为了避免在FacesContext上获得NullPointerException，您将需要添加以下FlowExecutionListener：</p>
<pre><code class="prettyprint xml"><br />&lt;webflow:flow-executor id=&quot;flowExecutor&quot;&gt;
    &lt;webflow:flow-execution-listeners&gt;
        &lt;webflow:listener ref=&quot;facesContextListener&quot; /&gt;
    &lt;/webflow:flow-execution-listeners&gt;
&lt;/webflow:flow-executor&gt;

&lt;bean id=&quot;facesContextListener&quot; class=&quot;org.springframework.faces.webflow.FlowFacesContextLifecycleListener&quot;/&gt;
</code></pre><p>无论使用哪种JSF版本，都需要这样做。</p>
<h2>更多JSF 2功能</h2><p>不支持的唯一功能是Web Flow提供核心价值的功能，包括导航和范围。JSF 2使用约定来简化导航规则，添加条件导航，并提供视图，Flash和自定义范围。您会发现Web Flow继续在这两个领域提供重要价值。</p><p>查看参数是不支持的另一个功能。Web Flow确实提供了一种访问请求参数并将其绑定到作用域Bean字段的方法。但是，如果您有任何好的用例，请向我们提供反馈。</p><p>尚未提及的任何其他功能（复合组件，JSR-303验证，系统事件等）都可以使用。关于复合组件，以下Mojarra <a href="https://javaserverfaces.dev.java.net/issues/show_bug.cgi?id=1690">问题</a>可能会影响您。如果是这样，请投票。</p>
<h2>JSF 2组件库</h2><p>除了与JSF集成外，Spring Web Flow当前还附带一个小型组件库。Spring Faces组件库基于Dojo JavaScript工具箱构建，并以渐进增强样式提供Ajax行为，资源处理和客户端验证。其中大部分与JSF 2提供的功能重叠。因此，我们可以选择扩展对JSF 2的支持以包括Spring Faces组件库，或者与JSF社区中流行的其他组件库紧密集成。我们相信后一种选择将为您提供更多的价值。</p><p>在此，我很高兴地宣布，我们正在与<a href="http://www.primefaces.org/">PrimeFaces</a>背后的团队紧密合作，为您带来与其组件库的紧密集成。PrimeFaces是第一个支持JSF 2的组件库，并且正在迅速普及。就像Spring Faces一样，它建立在客户端JavaScript工具箱（jQuery）上，并且具有不断增加的令人印象深刻的组件。如果您尚未签出PrimeFaces组件<a href="http://www.primefaces.org:8080/prime-showcase/ui/home.jsf">展示柜，</a>请这样做。</p><p>结果，您可以期望Spring Web Flow 2.2随带有PrimeFaces组件的JSF 2示例一起发布，这些示例演示了Web Flow，JSF 2和一流的JSF 2组件库的有效使用。</p>
<h2>结论</h2><p>Web Flow 2.2将是第一个提供对核心JSF 2功能的支持并与PrimeFaces组件库紧密集成的版本。如果您是JSF用户，我希望您会发现这是令人兴奋的一步。要尝试发布，请<a href="http://www.springsource.com/download/community?project=Spring Web Flow">下载</a>它，运行更新的预订界面示例，然后给我们您的反馈。您可以在本月底与<a href="https://code.google.com/p/primefaces/wiki/Roadmap">PrimeFaces 2.2</a>版本同步发布候选版本。</p><p>同时，Web Flow 3的工作正在朝着第一个里程碑继续。Web Flow 3的定义功能是Java流定义。在2.2分支中完成的JSF工作将输入到3.0分支中。</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 346;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>请启用JavaScript以查看<a href="http://disqus.com/?ref_noscript">由Disqus提供</a>的<a href="http://disqus.com/?ref_noscript">评论。</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">由<span class="logo-disqus">Disqus</span>提供动力的评论</a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>背部</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">所有帖子</a> <a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">工程</a> <a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">发布</a> <a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">新闻与活动</a> <a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>将The Spring Team的更新发送到您的收件箱</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">球队</a></li>
<li><a href="/tools">工具类</a></li>
<li><a href="https://store.pivotal.io/">商店</a></li>
<li><a href="/blog">通讯</a></li>
</ul>
</div>
</div>© <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a> ，Inc.保留所有权利。
<a href="https://pivotal.io/terms-of-use">使用条款</a> • <a href="https://pivotal.io/privacy-policy">隐私</a> • <a href="/trademarks">商标准则</a>
<div id="teconsent" style="display:inline-block"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
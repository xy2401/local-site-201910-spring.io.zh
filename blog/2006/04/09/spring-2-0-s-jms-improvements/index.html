<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>Spring 2.0&#39;s JMS Improvements</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="Spring 2.0&#39;s JMS Improvements" />
<meta name="twitter:description" content="&lt;p&gt;With the release of Spring 1.1 the Spring community was given it’s first taste of JMS support. This support included exception translation, message conversion, and a template class much like &lt;a href=&quot;http://static.springframework.org/spring/docs/2.0-m3/api/org/springframework/jdbc/core/JdbcTemplate.html&quot; style=&quot;font-family:courier&quot;&gt;JdbcTemplate&lt;/a&gt;. This support also took care of domain unification between the JMS 1.0.2 and 1.1 specs. The centerpieces of this support are the &lt;a href=&quot;http://static.springframework.org/spring/docs/1.2.x/api/org/springframework/jms/core/JmsTemplate.html&quot; style=&quot;font-family:courier&quot;&gt;JmsTemplate&lt;/a&gt; class and it’s JMS 1.0.2 counterpart &lt;a href=&quot;http://static.springframework.org/spring/docs/1.2.x/api/org/springframework/jms/core/JmsTemplate102.html&quot; style=&quot;font-family:courier&quot;&gt;JmsTemplate102&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This support was a great improvement over using the raw JMS APIs to do enterprise messaging. However it did have a shortcoming; the &lt;span style=&quot;font-family:courier&quot;&gt;JmsTemplate&lt;/span&gt; only supported synchronous reception of messages using the &lt;a href=&quot;http://static.springframework.org/spring/docs/1.2.x/api/org/springframework/jms/core/JmsTemplate.html#receive()&quot; style=&quot;font-family:courier&quot;&gt;JmsTemplate.receive()&lt;/a&gt; methods. This behavior worked well for many people but the vast majority of users of ended up rolling their own implementations of an asynchronous consumer. In short, they wanted what EJB 2 called &lt;a href=&quot;http://java.sun.com/j2ee/tutorial/1_3-fcs/doc/EJBConcepts5.html&quot;&gt;Message Driven Beans&lt;/a&gt;.&lt;/p&gt;
" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/329c22b36844c1d9c698d5e9b6709dc5?s=200" />

<meta property="og:title" content="Spring 2.0&#39;s JMS Improvements" />
<meta property="og:image" content="https://gravatar.com/avatar/329c22b36844c1d9c698d5e9b6709dc5?s=200" />
<meta property="og:description" content="&lt;p&gt;With the release of Spring 1.1 the Spring community was given it’s first taste of JMS support. This support included exception translation, message conversion, and a template class much like &lt;a href=&quot;http://static.springframework.org/spring/docs/2.0-m3/api/org/springframework/jdbc/core/JdbcTemplate.html&quot; style=&quot;font-family:courier&quot;&gt;JdbcTemplate&lt;/a&gt;. This support also took care of domain unification between the JMS 1.0.2 and 1.1 specs. The centerpieces of this support are the &lt;a href=&quot;http://static.springframework.org/spring/docs/1.2.x/api/org/springframework/jms/core/JmsTemplate.html&quot; style=&quot;font-family:courier&quot;&gt;JmsTemplate&lt;/a&gt; class and it’s JMS 1.0.2 counterpart &lt;a href=&quot;http://static.springframework.org/spring/docs/1.2.x/api/org/springframework/jms/core/JmsTemplate102.html&quot; style=&quot;font-family:courier&quot;&gt;JmsTemplate102&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This support was a great improvement over using the raw JMS APIs to do enterprise messaging. However it did have a shortcoming; the &lt;span style=&quot;font-family:courier&quot;&gt;JmsTemplate&lt;/span&gt; only supported synchronous reception of messages using the &lt;a href=&quot;http://static.springframework.org/spring/docs/1.2.x/api/org/springframework/jms/core/JmsTemplate.html#receive()&quot; style=&quot;font-family:courier&quot;&gt;JmsTemplate.receive()&lt;/a&gt; methods. This behavior worked well for many people but the vast majority of users of ended up rolling their own implementations of an asynchronous consumer. In short, they wanted what EJB 2 called &lt;a href=&quot;http://java.sun.com/j2ee/tutorial/1_3-fcs/doc/EJBConcepts5.html&quot;&gt;Message Driven Beans&lt;/a&gt;.&lt;/p&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2006-04-09 20:22:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
 <li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Spring 2.0&#39;s JMS Improvements</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/329c22b36844c1d9c698d5e9b6709dc5?s=20&amp;d=mm" />
<a class="author" rel="author" href="/team/bhale">Ben Hale</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2006-04-09 20:22:00.0">April 09, 2006</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="1" href="/blog/2006/04/09/spring-2-0-s-jms-improvements#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><p>With the release of Spring 1.1 the Spring community was given it’s first taste of JMS support. This support included exception translation, message conversion, and a template class much like <a href="http://static.springframework.org/spring/docs/2.0-m3/api/org/springframework/jdbc/core/JdbcTemplate.html" style="font-family:courier">JdbcTemplate</a>. This support also took care of domain unification between the JMS 1.0.2 and 1.1 specs. The centerpieces of this support are the <a href="http://static.springframework.org/spring/docs/1.2.x/api/org/springframework/jms/core/JmsTemplate.html" style="font-family:courier">JmsTemplate</a> class and it’s JMS 1.0.2 counterpart <a href="http://static.springframework.org/spring/docs/1.2.x/api/org/springframework/jms/core/JmsTemplate102.html" style="font-family:courier">JmsTemplate102</a>.</p><p>This support was a great improvement over using the raw JMS APIs to do enterprise messaging. However it did have a shortcoming; the <span style="font-family:courier">JmsTemplate</span> only supported synchronous reception of messages using the <a href="http://static.springframework.org/spring/docs/1.2.x/api/org/springframework/jms/core/JmsTemplate.html#receive()" style="font-family:courier">JmsTemplate.receive()</a> methods. This behavior worked well for many people but the vast majority of users of ended up rolling their own implementations of an asynchronous consumer. In short, they wanted what EJB 2 called <a href="http://java.sun.com/j2ee/tutorial/1_3-fcs/doc/EJBConcepts5.html">Message Driven Beans</a>.</p><p>But no longer will users do without. With the release of 2.0M1 and the final 2.0 release later, native support for asynchronous reception of JMS messages has been added. The <span style="font-family:courier">JmsTemplate</span> is still used for sending of messages at his always been, but it has now been joined by subclasses of <a href="http://static.springframework.org/spring/docs/2.0-m3/api/org/springframework/jms/listener/AbstractMessageListenerContainer.html" style="font-family:courier">AbstractMessageListenerContainer</a> such as <a href="http://static.springframework.org/spring/docs/2.0-m3/api/org/springframework/jms/listener/DefaultMessageListenerContainer.html" style="font-family:courier">DefaultMessageListenerContainer</a>, <a href="http://static.springframework.org/spring/docs/2.0-m3/api/org/springframework/jms/listener/SimpleMessageListenerContainer.html" style="font-family:courier">SimpleMessageListenerContainer</a>, and <a href="http://static.springframework.org/spring/docs/2.0-m3/api/org/springframework/jms/listener/serversession/ServerSessionMessageListenerContainer.html" style="font-family:courier">ServerSessionMessageListener</a>.</p><p>Let’s take a look at how to use these <span style="font-family:courier">MessageListenerContainer</span>s. The first step is to create a class that can receive the messages. To do this, one must create a class that implements the <a href="http://java.sun.com/j2ee/1.4/docs/api/javax/jms/MessageListener.html" style="font-family:courier">MessageListener</a> interface.</p>
<pre><code class="prettyprint java"><br />package jmsexample;

import javax.jms.JMSException;
import javax.jms.Message;
import javax.jms.MessageListener;
import javax.jms.TextMessage;

public class ExampleListener implements MessageListener {

	public void onMessage(Message message) {
		if (message instanceof TextMessage) {
			try {
				System.out.println(((TextMessage)message).getText());
			} catch (JMSException e) {
				throw new RuntimeException(e);
			}
		} else {
			throw new IllegalArgumentException(
					&quot;Message must be of type TestMessage&quot;);
		}
	}

}
</code></pre><p>Once you have that, you’ll need a message producer. This code is the same as it was back before Spring 2.0, so if you have code that does this already, it should not require any changes.</p>
<pre><code class="prettyprint java"><br />package jmsexample;

import org.springframework.jms.core.JmsTemplate;

public class ExampleProducer {

	private JmsTemplate jmsTemplate;

	public ExampleProducer(JmsTemplate jmsTemplate) {
		this.jmsTemplate = jmsTemplate;
	}

	public void sendMessage() {
		jmsTemplate.convertAndSend(&quot;Example Message&quot;);
	}

}
</code></pre><p>Next, you need to configure your context to create a <span style="font-family:courier">MessageListenerContainer</span> that routes messages to this bean. You’ll notice that I’m using ActiveMQ implementation classes in this example. This just happens to be one of many JMS implementations and happens to be the one that I’m most familiar with.</p>
<pre><code class="prettyprint xml"><br />&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
	xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;

	&lt;bean id=&quot;messageListener&quot; class=&quot;jmsexample.ExampleListener&quot; /&gt;

	&lt;bean id=&quot;messageProducer&quot; class=&quot;jmsexample.ExampleProducer&quot;&gt;
		&lt;constructor-arg ref=&quot;jmsTemplate&quot; /&gt;
	&lt;/bean&gt;

	&lt;bean id=&quot;jmsTemplate&quot;
		class=&quot;org.springframework.jms.core.JmsTemplate&quot;&gt;
		&lt;property name=&quot;connectionFactory&quot; ref=&quot;connectionFactory&quot; /&gt;
		&lt;property name=&quot;defaultDestination&quot; ref=&quot;destination&quot; /&gt;
	&lt;/bean&gt;

	&lt;bean id=&quot;destination&quot; class=&quot;org.activemq.message.ActiveMQQueue&quot;&gt;
		&lt;constructor-arg value=&quot;jmsExample&quot; /&gt;
	&lt;/bean&gt;

	&lt;bean id=&quot;listenerContainer&quot;
		class=&quot;org.springframework.jms.listener.DefaultMessageListenerContainer&quot;&gt;
		&lt;property name=&quot;connectionFactory&quot; ref=&quot;connectionFactory&quot; /&gt;
		&lt;property name=&quot;destination&quot; ref=&quot;destination&quot; /&gt;
		&lt;property name=&quot;messageListener&quot; ref=&quot;messageListener&quot; /&gt;
	&lt;/bean&gt;

	&lt;bean id=&quot;connectionFactory&quot;
		class=&quot;org.activemq.ActiveMQConnectionFactory&quot;&gt;
		&lt;property name=&quot;brokerURL&quot; value=&quot;tcp://localhost:61616&quot; /&gt;
	&lt;/bean&gt;

&lt;/beans&gt;
</code></pre><p>I’m going to skip it for now, but obviously you’ll need to have an MQ started, and a main method that bootstraps your context. I’ve added an <a id="p6" href="http://blog.springframework.com/main/wp-content/uploads/2006/04/JmsExample.zip" title="JmsExample Source Code">archive of the project</a> from this example so that you can see the rest of the code if you need it.</p><p>Finally, you just need to run your application and take a look at the output.</p>
<pre><code class="prettyprint code">Example Message
</code></pre><p>One thing to note is that so far we’ve been dealing with asynchronous reception with a single consumer thread. It is possible to multithread to your consumers (remember that you’ll still have to make them stateless or thread-safe) using the concurrent consumers property of the <span style="font-family:courier">MessageListenerContainer</span>.</p>
<pre><code class="prettyprint xml"><br />&lt;bean id=&quot;listenerContainer&quot;
	class=&quot;org.springframework.jms.listener.DefaultMessageListenerContainer&quot;&gt;
	&lt;property name=&quot;concurrentConsumers&quot; value=&quot;5&quot; /&gt;
	&lt;property name=&quot;connectionFactory&quot; ref=&quot;connectionFactory&quot; /&gt;
	&lt;property name=&quot;destination&quot; ref=&quot;destination&quot; /&gt;
	&lt;property name=&quot;messageListener&quot; ref=&quot;messageListener&quot; /&gt;
&lt;/bean&gt;
</code></pre><p>One thing I’d like to note (from my own painful experience) is to make sure that you don’t use concurrent consumers with a Topic. Remember that in a JMS topic all messages are delivered to all consumers on a topic. This means that if you have concurrent consumers on a topic, all of them will receive the same message; typically something that you’d want to avoid. However, if you’re using a queue, obviously this would dispatch each new message to the consumers in a round-robin fashion.</p><p>So, there you have it. It isn’t very flashy and is probably very similar to something you may have written at some point, but now all you have to do is use it, you don’t have to maintain it. Let me also say that this is just the tip of the iceberg. The <span style="font-family:courier">MessageListenerContainer</span>s have the ability to take part in transactions, use custom threadpools (like the ones provided with an app server) with the new Spring <a href="http://static.springframework.org/spring/docs/2.0-m3/api/org/springframework/core/task/TaskExecutor.html" style="font-family:courier">TaskExecutor</a>abstraction, and even expose the native JMS session to the consumer. Each of those things is a topic for another post though.</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 1;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
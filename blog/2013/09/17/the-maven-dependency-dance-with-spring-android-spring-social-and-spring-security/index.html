<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>The Maven Dependency Dance with Spring Android, Spring Social and Spring Security</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="The Maven Dependency Dance with Spring Android, Spring Social and Spring Security" />
<meta name="twitter:description" content="&lt;p&gt;&lt;a href=&quot;http://twitter.com/royclarkson&quot;&gt;Roy Clarkson (@royclarkson)&lt;/a&gt; and I gave a talk at &lt;a href=&quot;http://SpringOne2GX.com/&quot;&gt;SpringOne2GX 2013&lt;/a&gt; in which we talked about building REST services with an eye towards consuming those services on mobile platforms like Android and iOS. This talk demonstrates the progressive evolution of an application using Spring MVC, Spring HATEOAS, Spring Data REST, Spring Security, Spring Security OAuth, and Spring Android. The code’s benefited from a lot of help from Rob Winch, &lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;#layout-of-the-code&quot; class=&quot;anchor&quot; name=&quot;layout-of-the-code&quot;&gt;&lt;/a&gt;Layout of the Code&lt;/h2&gt;
&lt;p&gt;The code for the talk is on my &lt;a href=&quot;http://github.com/joshlong/the-spring-rest-stack/&quot;&gt;GitHub account (github.com/joshlong/**the-spring-rest-stack**)&lt;/a&gt;. Importantly, the code lives in the &lt;code&gt;code&lt;/code&gt; directory. Beneath that there are two choices: &lt;code&gt;web&lt;/code&gt; (where you’ll find the &lt;code&gt;rest&lt;/code&gt;, &lt;code&gt;hateoas&lt;/code&gt;, &lt;code&gt;hateoas-data&lt;/code&gt;, and &lt;code&gt;oauth&lt;/code&gt;, &lt;code&gt;social&lt;/code&gt; modules) and &lt;code&gt;client&lt;/code&gt; (where you can load the Android module and the iOS module). The modules in the &lt;code&gt;web&lt;/code&gt; folder in respective order, demonstrate the evolution of a simple REST service which incorporates hypermedia, Spring Data repositories and OAuth security. The &lt;code&gt;social&lt;/code&gt; module demonstrates how to build an OAuth client that consumes the service.&lt;/p&gt;
" />
<meta name="twitter:creator" content="@starbuxman" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/fb22593caf24e4bb4c98d467cdd247e6?s=200" />

<meta property="og:title" content="The Maven Dependency Dance with Spring Android, Spring Social and Spring Security" />
<meta property="og:image" content="https://gravatar.com/avatar/fb22593caf24e4bb4c98d467cdd247e6?s=200" />
<meta property="og:description" content="&lt;p&gt;&lt;a href=&quot;http://twitter.com/royclarkson&quot;&gt;Roy Clarkson (@royclarkson)&lt;/a&gt; and I gave a talk at &lt;a href=&quot;http://SpringOne2GX.com/&quot;&gt;SpringOne2GX 2013&lt;/a&gt; in which we talked about building REST services with an eye towards consuming those services on mobile platforms like Android and iOS. This talk demonstrates the progressive evolution of an application using Spring MVC, Spring HATEOAS, Spring Data REST, Spring Security, Spring Security OAuth, and Spring Android. The code’s benefited from a lot of help from Rob Winch, &lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;#layout-of-the-code&quot; class=&quot;anchor&quot; name=&quot;layout-of-the-code&quot;&gt;&lt;/a&gt;Layout of the Code&lt;/h2&gt;
&lt;p&gt;The code for the talk is on my &lt;a href=&quot;http://github.com/joshlong/the-spring-rest-stack/&quot;&gt;GitHub account (github.com/joshlong/**the-spring-rest-stack**)&lt;/a&gt;. Importantly, the code lives in the &lt;code&gt;code&lt;/code&gt; directory. Beneath that there are two choices: &lt;code&gt;web&lt;/code&gt; (where you’ll find the &lt;code&gt;rest&lt;/code&gt;, &lt;code&gt;hateoas&lt;/code&gt;, &lt;code&gt;hateoas-data&lt;/code&gt;, and &lt;code&gt;oauth&lt;/code&gt;, &lt;code&gt;social&lt;/code&gt; modules) and &lt;code&gt;client&lt;/code&gt; (where you can load the Android module and the iOS module). The modules in the &lt;code&gt;web&lt;/code&gt; folder in respective order, demonstrate the evolution of a simple REST service which incorporates hypermedia, Spring Data repositories and OAuth security. The &lt;code&gt;social&lt;/code&gt; module demonstrates how to build an OAuth client that consumes the service.&lt;/p&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2013-09-17 17:26:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">The Maven Dependency Dance with Spring Android, Spring Social and Spring Security</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/fb22593caf24e4bb4c98d467cdd247e6?s=20&amp;d=mm" />
<a class="author" rel="author" href="/team/jlong">Josh Long</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2013-09-17 17:26:00.0">September 17, 2013</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="1163" href="/blog/2013/09/17/the-maven-dependency-dance-with-spring-android-spring-social-and-spring-security#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><p><a href="https://twitter.com/royclarkson">Roy Clarkson (@royclarkson)</a> and I gave a talk at <a href="http://SpringOne2GX.com/">SpringOne2GX 2013</a> in which we talked about building REST services with an eye towards consuming those services on mobile platforms like Android and iOS. This talk demonstrates the progressive evolution of an application using Spring MVC, Spring HATEOAS, Spring Data REST, Spring Security, Spring Security OAuth, and Spring Android. The code&rsquo;s benefited from a lot of help from Rob Winch, </p><h2><a href="#layout-of-the-code" class="anchor" name="layout-of-the-code"></a>Layout of the Code</h2><p>The code for the talk is on my <a href="https://github.com/joshlong/the-spring-rest-stack/">GitHub account (github.com/joshlong/**the-spring-rest-stack**)</a>. Importantly, the code lives in the <code>code</code> directory. Beneath that there are two choices: <code>web</code> (where you&rsquo;ll find the <code>rest</code>, <code>hateoas</code>, <code>hateoas-data</code>, and <code>oauth</code>, <code>social</code> modules) and <code>client</code> (where you can load the Android module and the iOS module). The modules in the <code>web</code> folder in respective order, demonstrate the evolution of a simple REST service which incorporates hypermedia, Spring Data repositories and OAuth security. The <code>social</code> module demonstrates how to build an OAuth client that consumes the service.</p><h2><a href="#building-and-editing-the-code" class="anchor" name="building-and-editing-the-code"></a>Building and Editing the Code</h2><p>The project is all, at the moment, Maven based, though moving to Gradle seems imminent as that is the Google-endorsed route for Android builds. I know the Android client to be importable and buildable using IntelliJ IDEA&rsquo;s Android support (which in theory should work in <a href="http://intellij.com/android-studio">Android Studio</a>, which is freely available). </p><h2><a href="#the-dependency-dance-and-android" class="anchor" name="the-dependency-dance-and-android"></a>The Dependency Dance and Android</h2><p>We used up-to-date revisions of major libraries in our <a href="https://github.com/spring-projects/spring-android/tree/master/spring-android-rest-template">build file, linked for reference</a>. Up-to-date and sometimes bleeding edge. The Android application uses the Spring Android project, which - basically - provides an API compatible implementation of the <code>RestTemplate</code> found in Spring core. </p><p>It does <em>not</em> however provide the entire framework, and if you bring in certain libraries from the core you&rsquo;ll get weird issues because some classes in the Spring Android modules are <em>mostly</em> the same in Spring Android and in the core, but they&rsquo;re not identical, due to the differing natures of the environments in which they run. The easiest way to ensure everything&rsquo;s OK is to explicitly exclude all Spring modules <em>except</em> the Spring Android dependencies then, <em>selectively</em>, re-introduce the types as you need them. </p><p>The types in the <a href="https://github.com/spring-projects/spring-android/tree/master/spring-android-rest-template">Spring Android RestTemplate module</a> provides more than enough compatibility to let Spring Social&rsquo;s client machinery work unchanged on Android. This, of course, means that we can use the Spring Social-powered OAuth client in the <code>social</code> module in our Android application. Awesome! </p><p>For example, while I needed the Spring Social core types and implementations, I didn&rsquo;t need the core Spring libraries that it brought in. So, we get this rather dramatic stanza:</p>
<pre><code class="prettyprint xml">&lt;dependency&gt;    
    &lt;groupId&gt;org.springframework.social&lt;/groupId&gt;
    &lt;artifactId&gt;spring-social-core&lt;/artifactId&gt;
    &lt;version&gt;${spring-social.version}&lt;/version&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;com.h2database&lt;/groupId&gt;
            &lt;artifactId&gt;h2&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-expression&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;aopalliance&lt;/groupId&gt;
            &lt;artifactId&gt;aopalliance&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;com.joshlong.restfuliterations&lt;/groupId&gt;
            &lt;artifactId&gt;services&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;    
</code></pre><p>These dependencies can be hard to find. Use the <code>mvn dependency:tree</code> command to see where things are being imported <em>transitively</em>. Spring Security, another library whose top level types we wanted on the <code>CLASSPATH</code>, also required <code>exclusion</code> elements because it drags in Spring core. </p><h2><a href="#some-classes-like-jaxb-you-just-can-rsquo-t-avoid" class="anchor" name="some-classes-like-jaxb-you-just-can-rsquo-t-avoid"></a>Some Classes - like JAXB - You Just Can&rsquo;t Avoid</h2><p>Any class that&rsquo;s not in Android&rsquo;s JDK-class whitelist is not available on Android and thus renders code that depends on it incompatible. Some classes, like those in the JAXB module, are hard to ignore as they&rsquo;re pervasive. I wanted to use the Spring HATEOAS <code>Resource</code>, <code>Link</code>, types. These types are used as representations of various entities in REST responses that are sometimes rendered as XML using JAXB, they could not be loaded in Android! So, I <a href="https://github.com/joshlong/the-spring-rest-stack/tree/master/code/client/android/src/org/springframework/hateoas">had to copy those types locally</a> and mirror the package structure and remove the offending annotations. Hopefully I can clean this up going forward. </p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 1163;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
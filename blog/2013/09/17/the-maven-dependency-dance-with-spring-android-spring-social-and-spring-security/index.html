<html dir="ltr" data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>Spring Android，Spring Social和Spring Security的Maven依赖舞蹈</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>System.config({baseURL: "/b92013b"});</script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>System.import('app/main.js')</script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="The Maven Dependency Dance with Spring Android, Spring Social and Spring Security">
<meta name="twitter:description" content="<p><a href=" http:="" ="" twitter.com="" royclarkso="="></head><body dir="ltr">Roy Clarkson (@royclarkson) and I gave a talk at <a href="http://SpringOne2GX.com/">SpringOne2GX 2013</a> in which we talked about building REST services with an eye towards consuming those services on mobile platforms like Android and iOS. This talk demonstrates the progressive evolution of an application using Spring MVC, Spring HATEOAS, Spring Data REST, Spring Security, Spring Security OAuth, and Spring Android. The code’s benefited from a lot of help from Rob Winch, 
<h2><a href="#layout-of-the-code" class="anchor" name="layout-of-the-code"></a>Layout of the Code</h2>
<p>The code for the talk is on my <a href="http://github.com/joshlong/the-spring-rest-stack/">GitHub account (github.com/joshlong/**the-spring-rest-stack**)</a>. Importantly, the code lives in the <code>code</code> directory. Beneath that there are two choices: <code>web</code> (where you’ll find the <code>rest</code>, <code>hateoas</code>, <code>hateoas-data</code>, and <code>oauth</code>, <code>social</code> modules) and <code>client</code> (where you can load the Android module and the iOS module). The modules in the <code>web</code> folder in respective order, demonstrate the evolution of a simple REST service which incorporates hypermedia, Spring Data repositories and OAuth security. The <code>social</code> module demonstrates how to build an OAuth client that consumes the service.</p>
">
<meta name="twitter:creator" content="@starbuxman">
<meta name="twitter:image:src" content="https://gravatar.com/avatar/fb22593caf24e4bb4c98d467cdd247e6?s=200">

<meta property="og:title" content="The Maven Dependency Dance with Spring Android, Spring Social and Spring Security">
<meta property="og:image" content="https://gravatar.com/avatar/fb22593caf24e4bb4c98d467cdd247e6?s=200">
<meta property="og:description" content="<p><a href=" http:="" ="" twitter.com="" royclarkso="=">Roy Clarkson (@royclarkson) and I gave a talk at <a href="http://SpringOne2GX.com/">SpringOne2GX 2013</a> in which we talked about building REST services with an eye towards consuming those services on mobile platforms like Android and iOS. This talk demonstrates the progressive evolution of an application using Spring MVC, Spring HATEOAS, Spring Data REST, Spring Security, Spring Security OAuth, and Spring Android. The code’s benefited from a lot of help from Rob Winch, 
<h2><a href="#layout-of-the-code" class="anchor" name="layout-of-the-code"></a>Layout of the Code</h2>
<p>The code for the talk is on my <a href="http://github.com/joshlong/the-spring-rest-stack/">GitHub account (github.com/joshlong/**the-spring-rest-stack**)</a>. Importantly, the code lives in the <code>code</code> directory. Beneath that there are two choices: <code>web</code> (where you’ll find the <code>rest</code>, <code>hateoas</code>, <code>hateoas-data</code>, and <code>oauth</code>, <code>social</code> modules) and <code>client</code> (where you can load the Android module and the iOS module). The modules in the <code>web</code> folder in respective order, demonstrate the evolution of a simple REST service which incorporates hypermedia, Spring Data repositories and OAuth security. The <code>social</code> module demonstrates how to build an OAuth client that consumes the service.</p>
">
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2013-09-17 17:26:00.0">



<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">// Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }</script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">专案</a>
</li>
<li class="navbar-link">
<a href="/guides">导游</a>
</li>
<li class="navbar-link active">
<a href="/blog">博客</a>
</li>
<li class="navbar-link">
<a href="/services">培训与认证</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索文档，指南和帖子..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">家<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">专案<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">导游<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">博客<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">培训与认证<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>工程</div>
</div>
<div class="blog-category content--title">
<div>发布</div>
</div>
<div class="blog-category content--title">
<div>新闻与活动</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Spring Android，Spring Social和Spring Security的Maven依赖舞蹈</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">工程</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/fb22593caf24e4bb4c98d467cdd247e6?s=20&d=mm"> <a class="author" rel="author" href="/team/jlong">乔什·朗（Josh Long）</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2013-09-17 17:26:00.0">2013年9月17日</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2013/09/17/the-maven-dependency-dance-with-spring-android-spring-social-and-spring-security#disqus_thread" data-disqus-identifier="1163">
</a></div>
</div>
</header>
<div class="blog--post"><p><a href="https://twitter.com/royclarkson">Roy Clarkson（@royclarkson）</a>和我在<a href="http://SpringOne2GX.com/">SpringOne2GX 2013上</a>发表了演讲，我们在讨论建立REST服务时着眼于在Android和iOS等移动平台上使用这些服务。本演讲演示了使用Spring MVC，Spring HATEOAS，Spring Data REST，Spring Security，Spring Security OAuth和Spring Android的应用程序的逐步发展。该代码受益于Rob Winch的大量帮助，</p><h2><a href="#layout-of-the-code" class="anchor" name="layout-of-the-code"></a>代码的布局</h2><p>演讲的代码在我的<a href="https://github.com/joshlong/the-spring-rest-stack/">GitHub帐户（github.com/joshlong/**the-spring-rest-stack**）上</a> 。重要的是，代码位于<code>code</code>目录中。在下面有两个选择： <code>web</code> （在其中可以找到<code>rest</code> ， <code>hateoas</code> ， <code>hateoas-data</code>和<code>oauth</code> <code>social</code>模块）和<code>client</code> （可以在其中加载Android模块和iOS模块）。<code>web</code>文件夹中的模块按照各自的顺序演示了一个简单的REST服务的演进，该服务结合了超媒体，Spring Data存储库和OAuth安全性。<code>social</code>模块演示了如何构建使用该服务的OAuth客户端。</p><h2><a href="#building-and-editing-the-code" class="anchor" name="building-and-editing-the-code"></a>建立和编辑代码</h2><p>目前，该项目全部基于Maven，尽管迁移到Gradle似乎迫在眉睫，因为这是Google认可的Android构建途径。我知道可以使用IntelliJ IDEA的Android支持来导入和构建Android客户端（从理论上讲，它应该在可免费提供的<a href="http://intellij.com/android-studio">Android Studio中</a>工作）。</p><h2><a href="#the-dependency-dance-and-android" class="anchor" name="the-dependency-dance-and-android"></a>依赖性舞蹈和Android</h2><p>我们在<a href="https://github.com/spring-projects/spring-android/tree/master/spring-android-rest-template">构建文件中</a>使用了主要库的最新修订版，以<a href="https://github.com/spring-projects/spring-android/tree/master/spring-android-rest-template">供参考</a> 。最新的，有时流血的边缘。Android应用程序使用Spring Android项目，该项目基本上提供了Spring核心中<code>RestTemplate</code>的API兼容实现。</p><p>但是，它<em>不能</em>提供完整的框架，如果从核心引入某些库，则会遇到奇怪的问题，因为Spring Android模块中的某些类在Spring Android和核心中<em>几乎</em>是相同的，但它们并非相同由于它们所运行的环境的不同性质而完全相同。确保一切正常的最简单方法是明确排除<em>除</em> Spring Android依赖项<em>之外</em>的所有Spring模块，然后根据需要<em>有选择地</em>重新引入类型。</p><p><a href="https://github.com/spring-projects/spring-android/tree/master/spring-android-rest-template">Spring Android RestTemplate模块中</a>的类型提供了足够的兼容性，可以让Spring Social的客户端机制在Android上保持不变。当然，这意味着我们可以在Android应用程序的<code>social</code>模块中使用Spring Social支持的OAuth客户端。太棒了！</p><p>例如，虽然我需要Spring Social核心类型和实现，但我并不需要它带来的核心Spring库。因此，我们得到了一个相当引人注目的节：</p>
<pre><code class="prettyprint xml"><dependency>    
    <groupId>org.springframework.social</groupId>
    <artifactId>spring-social-core</artifactId>
    <version>${spring-social.version}</version>
    <exclusions>
        <exclusion>
            <groupId>org.springframework</groupId>
            <artifactId>spring-jdbc</artifactId>
        </exclusion>
        <exclusion>
            <groupId>com.h2database</groupId>
            <artifactId>h2</artifactId>
        </exclusion>
        <exclusion>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
        </exclusion>
        <exclusion>
            <groupId>org.springframework</groupId>
            <artifactId>spring-web</artifactId>
        </exclusion>
        <exclusion>
            <groupId>org.springframework</groupId>
            <artifactId>spring-tx</artifactId>
        </exclusion>
        <exclusion>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
        </exclusion>
        <exclusion>
            <groupId>org.springframework</groupId>
            <artifactId>spring-beans</artifactId>
        </exclusion>
        <exclusion>
            <groupId>org.springframework</groupId>
            <artifactId>spring-expression</artifactId>
        </exclusion>
        <exclusion>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aop</artifactId>
        </exclusion>
        <exclusion>
            <groupId>aopalliance</groupId>
            <artifactId>aopalliance</artifactId>
        </exclusion>
        <exclusion>
            <groupId>com.joshlong.restfuliterations</groupId>
            <artifactId>services</artifactId>
        </exclusion>
    </exclusions>
</dependency>    
</code></pre><p>这些依赖关系可能很难找到。使用<code>mvn dependency:tree</code>命令来查看事物在何处被<em>传递</em> 。Spring Security是另一个我们希望在<code>CLASSPATH</code>上使用其顶层类型的库，它也需要<code>exclusion</code>元素，因为它拖入了Spring核心。</p><h2><a href="#some-classes-like-jaxb-you-just-can-rsquo-t-avoid" class="anchor" name="some-classes-like-jaxb-you-just-can-rsquo-t-avoid"></a>一些类-例如JAXB-您无法避免</h2><p>不在Android的JDK类白名单中的任何类在Android上均不可用，因此将依赖于它的代码呈现为不兼容。有些类（如JAXB模块中的类）很普遍，因此很难忽略。我想使用Spring HATEOAS <code>Resource</code> ， <code>Link</code>和类型。这些类型用作REST响应中各种实体的表示，有时使用JAXB呈现为XML，因此无法在Android中加载它们！因此，我<a href="https://github.com/joshlong/the-spring-rest-stack/tree/master/code/client/android/src/org/springframework/hateoas">不得不在本地复制这些类型</a>并镜像包结构并删除有问题的注释。希望我可以继续进行清理。</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">var disqus_shortname = 'spring-io';
      var disqus_identifier = 1163;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));</script>
<noscript>请启用JavaScript以查看<a href="http://disqus.com/?ref_noscript">由Disqus提供</a>的<a href="http://disqus.com/?ref_noscript">评论。</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">由<span class="logo-disqus">Disqus</span>提供动力的评论</a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>背部</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">所有帖子</a> <a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">工程</a> <a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">发布</a> <a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">新闻与活动</a> <a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>将The Spring Team的更新发送到您的收件箱</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });</script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">球队</a></li>
<li><a href="/tools">工具类</a></li>
<li><a href="https://store.pivotal.io/">商店</a></li>
<li><a href="/blog">通讯</a></li>
</ul>
</div>
</div>© <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a> ，Inc.保留所有权利。
<a href="https://pivotal.io/terms-of-use">使用条款</a> • <a href="https://pivotal.io/privacy-policy">隐私</a> • <a href="/trademarks">商标准则</a>
<div id="teconsent" style="display:inline-block"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>Spring Security 3.2.0.RC1 Highlights: CSRF Protection</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="Spring Security 3.2.0.RC1 Highlights: CSRF Protection" />
<meta name="twitter:description" content="&lt;p&gt;&lt;/p&gt;
&lt;div class=&quot;callout&quot;&gt; 
 &lt;div class=&quot;callout-title&quot;&gt;
  Update
 &lt;/div&gt; 
 &lt;br&gt;
 &lt;p&gt;This blog post is no longer maintained. Refer to the &lt;a href=&quot;http://docs.spring.io/spring-security/site/docs/3.2.x/reference/htmlsingle/#csrf&quot;&gt;CSRF documentation&lt;/a&gt; for up to date information about Spring Security and CSRF protection.&lt;/p&gt;
 &lt;br&gt; 
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;On Monday I announced the &lt;a href=&quot;http://www.springsource.org/node/22675&quot; onclick=&quot;javascript:urchinTracker(&#39;/outbound/www.springsource.org&#39;);&quot;&gt;release of Spring Security 3.2.0.RC1&lt;/a&gt;. This is the first of a two part blog series going over the new features found in Spring Security 3.2.0.RC1.&lt;/p&gt;
&lt;p&gt;In this first entry, I will go over Spring Security&#39;s CSRF support. In the &lt;a href=&quot;http://blog.springsource.org/2013/08/23/spring-security-3-2-0-rc1-highlights-security-headers/&quot;&gt;next post&lt;/a&gt;, I will go over the various security headers that have been added.&lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;#csrf-attacks&quot; class=&quot;anchor&quot; name=&quot;csrf-attacks&quot;&gt;&lt;/a&gt;CSRF Attacks&lt;/h2&gt;
&lt;p&gt;Spring Security has added protection against &lt;a href=&quot;http://en.wikipedia.org/wiki/Cross-site_request_forgery&quot;&gt;Cross Site Request Forgery (CSRF) attacks&lt;/a&gt;. Great, but what is a CSRF attack and how can Spring Security protect me against it? Let&#39;s take a look at a concrete example to get a better understanding.&lt;/p&gt;
" />
<meta name="twitter:creator" content="@rob_winch" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/30ed046efb35c67d4c055dab109b8933?s=200" />

<meta property="og:title" content="Spring Security 3.2.0.RC1 Highlights: CSRF Protection" />
<meta property="og:image" content="https://gravatar.com/avatar/30ed046efb35c67d4c055dab109b8933?s=200" />
<meta property="og:description" content="&lt;p&gt;&lt;/p&gt;
&lt;div class=&quot;callout&quot;&gt; 
 &lt;div class=&quot;callout-title&quot;&gt;
  Update
 &lt;/div&gt; 
 &lt;br&gt;
 &lt;p&gt;This blog post is no longer maintained. Refer to the &lt;a href=&quot;http://docs.spring.io/spring-security/site/docs/3.2.x/reference/htmlsingle/#csrf&quot;&gt;CSRF documentation&lt;/a&gt; for up to date information about Spring Security and CSRF protection.&lt;/p&gt;
 &lt;br&gt; 
&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;On Monday I announced the &lt;a href=&quot;http://www.springsource.org/node/22675&quot; onclick=&quot;javascript:urchinTracker(&#39;/outbound/www.springsource.org&#39;);&quot;&gt;release of Spring Security 3.2.0.RC1&lt;/a&gt;. This is the first of a two part blog series going over the new features found in Spring Security 3.2.0.RC1.&lt;/p&gt;
&lt;p&gt;In this first entry, I will go over Spring Security&#39;s CSRF support. In the &lt;a href=&quot;http://blog.springsource.org/2013/08/23/spring-security-3-2-0-rc1-highlights-security-headers/&quot;&gt;next post&lt;/a&gt;, I will go over the various security headers that have been added.&lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;#csrf-attacks&quot; class=&quot;anchor&quot; name=&quot;csrf-attacks&quot;&gt;&lt;/a&gt;CSRF Attacks&lt;/h2&gt;
&lt;p&gt;Spring Security has added protection against &lt;a href=&quot;http://en.wikipedia.org/wiki/Cross-site_request_forgery&quot;&gt;Cross Site Request Forgery (CSRF) attacks&lt;/a&gt;. Great, but what is a CSRF attack and how can Spring Security protect me against it? Let&#39;s take a look at a concrete example to get a better understanding.&lt;/p&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2013-08-21 03:05:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Spring Security 3.2.0.RC1 Highlights: CSRF Protection</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/30ed046efb35c67d4c055dab109b8933?s=20&amp;d=mm" />
<a class="author" rel="author" href="/team/rwinch">Rob Winch</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2013-08-21 03:05:00.0">August 21, 2013</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="1148" href="/blog/2013/08/21/spring-security-3-2-0-rc1-highlights-csrf-protection#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><p><div class="callout">
<div class="callout-title">Update</div>
<br /><p>This blog post is no longer maintained. Refer to the <a href="https://docs.spring.io/spring-security/site/docs/3.2.x/reference/htmlsingle/#csrf">CSRF documentation</a> for up to date information about Spring Security and CSRF protection.</p><br />
</div></p><p>On Monday I announced the <a href="http://www.springsource.org/node/22675" onclick="javascript:urchinTracker('/outbound/www.springsource.org');">release of Spring Security 3.2.0.RC1</a>. This is the first of a two part blog series going over the new features found in Spring Security 3.2.0.RC1.</p><p>In this first entry, I will go over Spring Security&#039;s CSRF support. In the <a href="http://blog.springsource.org/2013/08/23/spring-security-3-2-0-rc1-highlights-security-headers/">next post</a>, I will go over the various security headers that have been added.</p><h2><a href="#csrf-attacks" class="anchor" name="csrf-attacks"></a>CSRF Attacks</h2><p>Spring Security has added protection against <a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery">Cross Site Request Forgery (CSRF) attacks</a>. Great, but what is a CSRF attack and how can Spring Security protect me against it? Let&#039;s take a look at a concrete example to get a better understanding.</p><p>Assume that your bank&#039;s website provides a form that allows transferring money from the currently logged in user to another bank account. For example, the HTTP request might look like:</p>
<pre><code class="prettyprint">POST /transfer HTTP/1.1
Host: bank.example.com
Cookie: JSESSIONID=randomid; Domain=bank.example.com; Secure; HttpOnly
Content-Type: application/x-www-form-urlencoded

amount=100.00&amp;routingNumber=1234&amp;account=9876
</code></pre><p>Now pretend you authenticate to your bank&rsquo;s website and then, without logging out, visit an evil website. The evil website contains an HTML page with the following form:</p>
<pre><code class="prettyprint html">&lt;form action=&quot;https://bank.example.com/transfer&quot; method=&quot;post&quot;&gt;
  &lt;input type=&quot;hidden&quot;
      name=&quot;amount&quot;
      value=&quot;100.00&quot;/&gt;
  &lt;input type=&quot;hidden&quot;
      name=&quot;routingNumber&quot;
      value=&quot;evilsRoutingNumber&quot;/&gt;
  &lt;input type=&quot;hidden&quot;
      name=&quot;account&quot;
      value=&quot;evilsAccountNumber&quot;/&gt;
  &lt;input type=&quot;submit&quot;
      value=&quot;Win Money!&#39;/&gt;
&lt;/form&gt;
</code></pre>
<p>You like to win money, so you click on the submit button. In the process, you have unintentionally transferred $100 to a malicious user. This happens because, while the evil website cannot see your cookies, the cookies associated with your bank are still sent along with the request.</p>
<p>Worst yet, this whole process could have been automated using JavaScript. This means you didn&#039;t even need to click on the button. So how do we protect ourselves from such attacks?</p>
<h2>Synchronizer Token Pattern</h2>
<p>The issue is that the HTTP request from the bank&#039;s website and the request from the evil website are exactly the same. This means there is no way to reject requests coming from the evil website and allow requests coming from the bank&#039;s website. To protect against CSRF attacks we need to ensure there is something in the request that the evil site is unable to provide.</p>
<p>One solution is to use the <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet#General_Recommendation:_Synchronizer_Token_Pattern">Synchronizer Token Pattern</a>. This solution is to ensure that each request requires, in addition to our session cookie, a randomly generated token as an HTTP parameter. When a request is submitted, the server must look up the expected value for the parameter and compare it against the actual value in the request. If the values do not match, the request should fail.</p>
<p>We can relax the expectations to only require the token for each HTTP request that updates state. This can be safely done since the <a href="https://en.wikipedia.org/wiki/Same-origin_policy" onclick="javascript:urchinTracker('/outbound/en.wikipedia.org');">same origin policy</a> ensures the evil site cannot read the response. Additionally, we do not want to include the random token in HTTP GET as this can <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet#Disclosure_of_Token_in_URL">cause the tokens to be leaked</a>. </p>
<p>Let&#039;s take a look at how our example would change. Assume the randomly generated token is present in an HTTP parameter named _csrf. For example, the request to transfer money would look like this:</p>
<pre><code class="prettyprint">POST /transfer HTTP/1.1
Host: bank.example.com
Cookie: JSESSIONID=randomid; Domain=bank.example.com; Secure; HttpOnly
Content-Type: application/x-www-form-urlencoded

amount=100.00&amp;routingNumber=1234&amp;account=9876&amp;_csrf=&lt;secure-random&gt;
</code></pre><p>You will notice that we added the <code>_csrf</code> parameter with a random value. Now the evil website will not be able to guess the correct value for the _csrf parameter (which must be explicitly provided on the evil website) and the transfer will fail when the server compares the actual token to the expected token.</p><h2><a href="#using-spring-security-csrf-support" class="anchor" name="using-spring-security-csrf-support"></a>Using Spring Security CSRF Support</h2><p>So what are the steps necessary to use Spring Security&#039;s to protect our site against CSRF attacks? The steps to using Spring Security&#039;s CSRF protection are outlined below:</p>
<ul>
<li><a href="#use-proper-http-verbs">Use proper HTTP verbs</a></li>
<li><a href="#configure-csrf-protection">Configure CSRF Protection</a></li>
<li><a href="#include-csrf-token">Include CSRF Token</a></li>
</ul><h3><a href="#use-proper-http-verbs" class="anchor" name="use-proper-http-verbs"></a>Use proper HTTP Verbs</h3><p>The first step to protecting against CSRF attacks is to ensure your website uses proper HTTP verbs. Specifically, before Spring Security&#039;s CSRF support can be of use, you need to be certain that your application is using PATCH, POST, PUT, and/or DELETE for anything that modifies state. This is not a limitation of Spring Security&#039;s support, but instead a general requirement for proper CSRF prevention.</p><h3><a href="#configuring-csrf-protection" class="anchor" name="configuring-csrf-protection"></a>Configuring CSRF Protection</h3><p>The next step is to include Spring Security&#039;s CSRF protection within your application. If you are using the XML configuration, this can be done using the <a href="http://static.springsource.org/spring-security/site/docs/3.2.0.RELEASE/reference/htmlsingle/appendix-namespace.html#nsa-csrf" onclick="javascript:urchinTracker('/outbound/static.springsource.org');"><code>&lt;csrf /&gt;</code></a> element:</p>
<pre><code class="prettyprint xml">&lt;http ...&gt;
    ...
    &lt;csrf /&gt;
&lt;/http&gt;
</code></pre><p>CSRF protection is enabled by default with Java configuration. If you would like to disable CSRF, the corresponding Java configuration can be seen below:</p>
<pre><code class="prettyprint java">@EnableWebSecurity
@Configuration
public class WebSecurityConfig extends
   WebSecurityConfigurerAdapter {

  @Override
  protected void configure(HttpSecurity http) throws Exception {
    http
      .csrf().disable()
      ...;
  }
}
</code></pre><h2><a href="#include-csrf-token" class="anchor" name="include-csrf-token"></a>Include CSRF token</h2><h4><a href="#form-submissions" class="anchor" name="form-submissions"></a>Form Submissions</h4><p>If you are using Spring MVC &lt;form:form&gt; tag, the CsrfToken is automatically included for you using the <a href="http://static.springsource.org/spring-security/site/docs/3.2.x/apidocs/org/springframework/security/web/servlet/support/csrf/CsrfRequestDataValueProcessor.html" onclick="javascript:urchinTracker('/outbound/static.springsource.org');">CsrfRequestDataValueProcessor</a>. </p><p>Also of interest is that once <a href="https://github.com/thymeleaf/thymeleaf-spring3/issues/7">issue 7</a> is resolved, Thymeleaf should have automatic integration.</p>
<p>The last step is to ensure that you include the CSRF token in all PATCH, POST, PUT, and DELETE methods. This can be done using the _csrf request attribute to obtain the current <a href="http://static.springsource.org/spring-security/site/docs/3.2.0.RC1/apidocs/org/springframework/security/web/csrf/CsrfToken.html" onclick="javascript:urchinTracker('/outbound/static.springsource.org');">CsrfToken</a>. An example of doing this with a JSP is shown below:</p>
<pre><code class="prettyprint xml"><br />&lt;c:url var=&quot;logoutUrl&quot; value=&quot;/logout&quot;/&gt;
&lt;form action=&quot;${logoutUrl}&quot;
    method=&quot;post&quot;&gt;
  &lt;input type=&quot;submit&quot;
    value=&quot;Log out&quot; /&gt;
  &lt;input type=&quot;hidden&quot;
    name=&quot;${_csrf.parameterName}&quot;
    value=&quot;${_csrf.token}&quot;/&gt;
&lt;/form&gt;
</code></pre><h4><a href="#ajax-requests" class="anchor" name="ajax-requests"></a>AJAX Requests</h4><p>If you using JSON, then it is not possible to submit the CSRF token within an HTTP parameter. Instead you can submit the token within a HTTP header. A typical pattern would be to include the CSRF token within your meta tags:</p>
<pre><code class="prettyprint xml">&lt;html&gt;
  &lt;head&gt;
    &lt;meta name=&quot;_csrf&quot; content=&quot;${_csrf.token}&quot;/&gt;
    &lt;!-- default header name is X-CSRF-TOKEN --&gt;
    &lt;meta name=&quot;_csrf_header&quot; content=&quot;${_csrf.headerName}&quot;/&gt;
    ...
  &lt;/head&gt;
  ...
</code></pre><p>You can then include the token within all your AJAX requests. If you were using JQuery, this could be done with the following:</p>
<pre><code class="prettyprint javascript">$(function () {
    var token = $(&quot;meta[name=&#39;_csrf&#39;]&quot;).attr(&quot;content&quot;);
    var header = $(&quot;meta[name=&#39;_csrf_header&#39;]&quot;).attr(&quot;content&quot;);
    $(document).ajaxSend(function(e, xhr, options) {
        xhr.setRequestHeader(header, token);
    });
});
</code></pre><h3><a href="#csrf-caveats" class="anchor" name="csrf-caveats"></a>CSRF Caveats</h3><p>There are a few caveats when implementing CSRF.</p><h4><a href="#timeouts" class="anchor" name="timeouts"></a>Timeouts</h4>
<blockquote><h4><a href="#csrf-in-cookies" class="anchor" name="csrf-in-cookies"></a>CSRF in Cookies</h4><p>One might ask why the CsrfToken isn&#039;t stored in a cookie. This is because there are known exploits in which headers (i.e. set cookies) can be set by another domain. Another disadvantage is that by removing the state (i.e. the timeout) you lose the ability to forcibly terminate the token if something got compromised.</p>
</blockquote><p>One issue is that the expected CSRF token is stored in the HttpSession, so as soon as the HttpSession expires your configured AccessDeniedHandler will receive a <code>InvalidCsrfTokenException</code>. If you are using the default <code>AccessDeniedHandler</code>, the browser will get an HTTP 403 and display a poor error message.</p><p>A simple way to mitigate an active user experiencing a timeout is to have some JavaScript that lets the user know their session is about to expire. The user can click a button to continue and refresh the session.</p><p>Alternatively, specifying a custom AccessDeniedHandler allows you to process the <code>InvalidCsrfTokenException</code> anyway you like. For an example of how to customize the AccessDeniedHandler refer to the provided links for both <a href="http://static.springsource.org/spring-security/site/docs/3.2.0.RELEASE/reference/htmlsingle/#nsa-access-denied-handler" onclick="javascript:urchinTracker('/outbound/static.springsource.org');">xml</a> and <a href="https://github.com/SpringSource/spring-security/blob/3.2.0.RC1/config/src/test/groovy/org/springframework/security/config/annotation/web/configurers/NamespaceHttpAccessDeniedHandlerTests.groovy#L64">Java configuration</a>.</p><h4><a href="#logging-in" class="anchor" name="logging-in"></a>Logging In</h4><p>In order to protect against <a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery#Forging_login_requests" onclick="javascript:urchinTracker('/outbound/en.wikipedia.org');">forging log in requests</a> the log in form should be protected against CSRF attacks too. Since the CsrfToken is stored in HttpSession, this means an HttpSession will be created immediately. While this sounds bad in a RESTful / stateless architecture the reality is that state is necessary to implement practical security. Without state, we have nothing we can do if a token is compromised. Practically speaking, the CSRF token is quite small in size and should have a negligible impact on our architecture.</p><h4><a href="#logging-out" class="anchor" name="logging-out"></a>Logging out</h4><p>Adding CSRF will update the LogoutFilter to only use HTTP POST. This ensures that log out requires a CSRF token and that a malicious user cannot forcibly log out your users.</p><p>One approach is to use a form for log out. If you really want a link, you can use JavaScript to have the link perform a POST (i.e. maybe on a hidden form). For browsers with JavaScript that is disabled, you can optionally have the link take the user to a log out confirmation page that will perform the POST.</p><h4><a href="#hiddenhttpmethodfilter" class="anchor" name="hiddenhttpmethodfilter"></a>HiddenHttpMethodFilter</h4><p>The <code>HiddenHttpMethodFilter</code> should be placed before the Spring Security filter. In general this is true, but it could have additional implications when protecting against CSRF attacks.</p></p><p>Note that the HiddenHttpMethodFilter only overrides the HTTP method on a POST, so this is actually unlikely to cause any real problems. However, it is still best practice to ensure it is placed before Spring Security&#039;s filters.</p><h3><a href="#overriding-defaults" class="anchor" name="overriding-defaults"></a>Overriding Defaults</h3><p>Spring Security&#039;s goal is to provide defaults that protect your users from exploits. This does not mean that you are forced to accept all of its defaults.</p><p>For example, you can provide a custom <a href="http://static.springsource.org/spring-security/site/docs/3.2.0.RELEASE/reference/htmlsingle/#nsa-csrf-token-repository-ref" onclick="javascript:urchinTracker('/outbound/static.springsource.org');">CsrfTokenRepository</a> to override the way in which the CsrfToken is stored.</p><p>You can also specify a custom <a href="http://static.springsource.org/spring-security/site/docs/3.2.0.RELEASE/reference/htmlsingle/#nsa-csrf-request-matcher-ref" onclick="javascript:urchinTracker('/outbound/static.springsource.org');">RequestMatcher</a> to determine which requests are protected by CSRF (i.e. perhaps you don&#039;t care if log out is exploited). In short, if Spring Security&#039;s CSRF protection doesn&#039;t behave exactly as you want it, you are able to customize the behavior.</p><h2><a href="#conclusion" class="anchor" name="conclusion"></a>Conclusion</h2><p>You should now have a good idea what CSRF is and how to use Spring Security to protect your application from CSRF exploits.</p><p>In the <a href="http://blog.springsource.org/2013/08/23/spring-security-3-2-0-rc1-highlights-security-headers/">next post</a>, I will discuss how to use Spring Security&#039;s headers support can protect your application from exploits like clickjacking.</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 1148;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
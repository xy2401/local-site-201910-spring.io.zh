<html dir="ltr" data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>宣布Spring Cloud Function 3.0.0。M2</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>System.config({baseURL: "/b92013b"});</script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>System.import('app/main.js')</script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="Announcing Spring Cloud Function 3.0.0.M2">
<meta name="quick-highlights" content="<p>We are pleased to announce the second Milestone of the Spring Cloud Function 3.0.0.M2. </p>
<blockquote> 
 <p>NOTE: Spring Cloud Function 3.0.0.M1 was primarily to establish compatibility with Spring Boot 2.2.x. and therefore went unannounced. </p> 
</blockquote>
<p>Spring Cloud Function 3.0.0.M2 modules are available for use in the <a href=" https:="" ="" repo.spring.io="" libs-milestone-local="" org="" springframework="" cloud="" ="="></meta>Spring Milestone repository. 
<h3><a href=" #quick-highlights" class="anchor"></head><body dir="ltr">Quick highlights:
<ul> 
 <li>Spring Boot 2.2.x</li> 
 <li>Enhanced deployer (requires a separate blog)</li> 
</ul>
<h3><a href="#notable-features-and-enhancements" class="anchor" name="notable-features-and-enhancements"></a>Notable features and enhancements:</h3>
<h5><a href="#function-arity-multiple-inputs-outputs" class="anchor" name="function-arity-multiple-inputs-outputs"></a>Function arity (multiple inputs/outputs)</h5>
<p>One of the biggest features introduced with this milestone is support for functions with multiple inputs and outputs. Important thing to point out is that this feature only makes sense in reactive world where you may want to pass several streams to a function for purposes of doing some type of aggregate/merge operation on such streams. For conventional cases you can always send multiple arguments using a Collection of some type.</p>
">
<meta name="twitter:creator" content="@z_oleg">
<meta name="twitter:image:src" content="https://gravatar.com/avatar/b44844c62a496e582a467cf95806ae92?s=200">

<meta property="og:title" content="Announcing Spring Cloud Function 3.0.0.M2">
<meta property="og:image" content="https://gravatar.com/avatar/b44844c62a496e582a467cf95806ae92?s=200">
<meta property="og:description" content="<p>We are pleased to announce the second Milestone of the Spring Cloud Function 3.0.0.M2. </p>
<blockquote> 
 <p>NOTE: Spring Cloud Function 3.0.0.M1 was primarily to establish compatibility with Spring Boot 2.2.x. and therefore went unannounced. </p> 
</blockquote>
<p>Spring Cloud Function 3.0.0.M2 modules are available for use in the <a href=" https:="" ="" repo.spring.io="" libs-milestone-local="" org="" springframework="" cloud="" ="="></meta>Spring Milestone repository. 
<h3><a href=" #quick-highlights" class="anchor" name="quick-highlights">Quick highlights:
<ul> 
 <li>Spring Boot 2.2.x</li> 
 <li>Enhanced deployer (requires a separate blog)</li> 
</ul>
<h3><a href="#notable-features-and-enhancements" class="anchor" name="notable-features-and-enhancements"></a>Notable features and enhancements:</h3>
<h5><a href="#function-arity-multiple-inputs-outputs" class="anchor" name="function-arity-multiple-inputs-outputs"></a>Function arity (multiple inputs/outputs)</h5>
<p>One of the biggest features introduced with this milestone is support for functions with multiple inputs and outputs. Important thing to point out is that this feature only makes sense in reactive world where you may want to pass several streams to a function for purposes of doing some type of aggregate/merge operation on such streams. For conventional cases you can always send multiple arguments using a Collection of some type.</p>
">
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2019-08-15 13:57:00.0">



<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">// Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }</script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">专案</a>
</li>
<li class="navbar-link">
<a href="/guides">导游</a>
</li>
<li class="navbar-link active">
<a href="/blog">博客</a>
</li>
<li class="navbar-link">
<a href="/services">培训与认证</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索文档，指南和帖子..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">家<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">专案<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">导游<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">博客<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">培训与认证<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>工程</div>
</div>
<div class="blog-category content--title">
<div>发布</div>
</div>
<div class="blog-category content--title">
<div>新闻与活动</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">宣布Spring Cloud Function 3.0.0。M2</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">工程</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/b44844c62a496e582a467cf95806ae92?s=20&d=mm"> <a class="author" rel="author" href="/team/olegz">奥列格·朱拉库斯基（Oleg Zhurakousky）</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2019-08-15 13:57:00.0">2019年8月15日</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2019/08/15/announcing-spring-cloud-function-3-0-0-m2#disqus_thread" data-disqus-identifier="3773">
</a></div>
</div>
</header>
<div class="blog--post"><p>我们很高兴地宣布Spring Cloud Function 3.0.0的第二个里程碑。M2。</p>
<blockquote>
<p>注意：Spring Cloud Function 3.0.0。M1主要是为了建立与Spring Boot 2.2.x的兼容性。因此不作宣布。</p>
</blockquote>
<p>Spring Cloud Function 3.0.0。M2模块可在<a href="https://repo.spring.io/libs-milestone-local/org/springframework/cloud/">Spring Milestone</a>存储库中使用。</p><h3><a href="#quick-highlights" class="anchor" name="quick-highlights"></a>快速亮点：</h3>
<ul>
<li>Spring Boot 2.2.x</li>
<li>增强的部署程序（需要单独的博客）</li>
</ul><h3><a href="#notable-features-and-enhancements" class="anchor" name="notable-features-and-enhancements"></a>显着的功能和增强：</h3><h5><a href="#function-arity-multiple-inputs-outputs" class="anchor" name="function-arity-multiple-inputs-outputs"></a>功能组合（多个输入/输出）</h5>
<p>此里程碑引入的最大功能之一是支持具有多个输入和输出的功能。需要指出的重要一点是，此功能仅在响应世界中才有意义，在响应世界中，您可能希望将多个流传递给函数，以对此类流执行某种类型的聚合/合并操作。对于传统情况，您始终可以使用某种类型的Collection发送多个参数。</p>
<p>为了<em>以类型安全的方式</em>表示多个输入/输出，以从类型转换和前面提到的其他功能中受益，我们从<a href="https://projectreactor.io/docs/core/release/api/index.html?reactor/util/function/Tuples.html">项目反应堆中</a>选择了<code>Tuple</code>库，因为spring-cloud-function从一开始就将其作为依赖项。但是，将来，如果我们可以通过某种类型的约定确定输入和输出的类型和类型，那么我们还将打算支持<code>BiFunction</code>和POJO样式的类型。</p>
<p>虽然该功能是新增功能，并且正在增强中，但很少有内部项目在使用它，您也可以尝试使用。这是一个例子：</p>
<p>假设具有以下功能：</p>
<pre><code class="prettyprint java">@Bean
public Function<Tuple2<Flux<String>, Flux<Integer>>, Flux<?>[]> repeater() {
  return tuple -> {
    Flux<String> stringFlux = tuple.getT1();
    Flux<Integer> integerFlux = tuple.getT2();

    Flux<Integer> sharedIntFlux = integerFlux.publish().autoConnect(2);

    Flux<String> repeated = stringFlux
      .zipWith(sharedIntFlux)
      .flatMap(t -> 
            Flux.fromIterable(Collections.nCopies(t.getT2(), t.getT1())));

    Flux<Integer> sum = sharedIntFlux
	.buffer(3, 1)
	.map(l -> l.stream().mapToInt(Integer::intValue).sum());

    return new Flux[] { repeated, sum };
  };
}
</code></pre>
<p>You can invoke it as such:</p>
<pre gtc:encodedoriginal="PHByZSBkYXRhLW1hcmt4PSIxNDQiPg=="><code class="prettyprint java">Function<Tuple2<Flux<String>, Flux<Integer>>, Flux<?>[]> repeater = catalog.lookup("repeater");
Flux<String> stringStream = Flux.just("one", "two", "three");
Flux<Integer> intStream = Flux.just(3, 2, 1);
Flux<?>[] result = repeater.apply(Tuples.of(stringStream, intStream));
result[0].subscribe(System.out::println);
result[1].subscribe(System.out::println);
</code></pre>
<p>将来将会有一个关于此主题的单独博客。</p><h5><a href="#choice-of-programming-styles-reactive-imperative" class="anchor" name="choice-of-programming-styles-reactive-imperative"></a>编程风格选择-反应式，命令式</h5>
<p>和以前一样，可以通过<a href="https://projectreactor.io/">项目反应器</a>以命令式或反应式方式实现功能。但是，在以前的版本中，我们<em>总是</em>将反应式转换应用于使用命令式样式实现的函数。例如<code>Function<Foo, Foo></code>会变成<code>Function<Flux<Foo>, Flux<Foo>></code> 。在此版本中，情况不再如此。可以按命令方式（命令式）或<em>反应</em>式查找和调用<em>以</em>命令式方式实现的功能。<br>例如，假设以下配置：</p>
<pre><code class="prettyprint java">@Bean
public Function<String, String> uppercase() {
	return v -> v.toUpperCase();
}
</code></pre>
<p>您可以按以下方式访问此函数：</p>
<pre><code class="prettyprint java">Function<String, String> function = functionCatalog.lookup("uppercase");
</code></pre>
<p>或等效为无功：</p>
<pre><code class="prettyprint java">Function<Flux<String>, Flux<String>> reactiveFunction = functionCatalog.lookup("uppercase");
</code></pre>
<p>Spring Cloud Function将自动适应。</p><h5><a href="#transparent-type-conversion-of-inputs-and-outputs" class="anchor" name="transparent-type-conversion-of-inputs-and-outputs"></a>输入和输出的透明类型转换。</h5>
<p>此里程碑附带的新功能之一是功能核心处的透明类型转换，因此，尽管其中一些功能已在Web适配器中提供，但现在可以在功能调用级别使用，允许任何类型的功能使用者（非只是网络）从中受益。组合功能时会实现此功能的主要优点之一（稍后会对此进行更多介绍）。<br>例如，假定以下函数：组成<code>foo|bar</code> <code>Function<Foo, Foo> foo()</code>和<code>Function<Bar, Bar> bar()</code> 。在给定一个输出与另一个输入之间类型不兼容的情况下，尽管它在以前的版本中不起作用，但只要有适当的<em>转换策略</em>可用，它现在就受到支持。<br>这种<em>转换策略</em>是标准的Spring的<code>ConversionService</code>和<code>MessageConverters</code> 。虽然我们仍在完善此功能并提供详细的文档，但是默认情况下已经初始化了适用于大多数情况（例如JSON）的<code>ConversionService</code>和<code>MessageConverters</code> 。</p>
<p>例如，假定以下功能配置：</p>
<pre><code class="prettyprint java">@Bean
public Function<Person, Person> uppercasePerson() {
  return person -> {
    return new Person(person.getName().toUpperCase(), person.getId());
  };
}
</code></pre>
<p>为了从<code>MessageConverters</code>受益，我们可以将该函数调用为<code>Function<Message<String>, Person></code> （或byte []作为有效负载），从而利用可用的JSON <code>MessageConverter</code>将<code>String</code>转换为<code>Person</code> （请参见下文）。</p>
<pre><code class="prettyprint java">Function<Message<String>, Person> uppercasePerson = catalog.lookup("uppercasePerson");
Person person =  uppercasePerson.apply(MessageBuilder.withPayload("{\"name\":\"bill\",\"id\":2}").build()); 
</code></pre>
<p>请记住，对于使用反应式样式编写的函数，不会进行任何更改，并且将应用相同的<em>转换策略</em> 。</p><h5><a href="#function-composition-and-adaptation" class="anchor" name="function-composition-and-adaptation"></a>功能组成和适应；</h5>
<p>虽然功能组合不是Spring Cloud Function的新功能，但此里程碑对其进行了完善。</p>
<p>和以前一样，您可以通过“ |”或“，”字符组成函数。</p>
<p>另外一个好处是，您可以使用不同的编程样式（例如，反应式和命令式）来编写<em>函数</em> ，可以将<em>Supplier</em>与<em>Function</em>组合在一起， <em>Supplier</em>与<em>Consumer组合使用</em> ， <em>Function</em> with <em>Consumer</em>等组合，我们将进行调整。<br>您可以在生产者函数的输出与使用者函数的输入不匹配的地方编写函数-我们将进行转换。<br>将来，将有一个关于此主题的单独博客，我们也正在完善文档。</p><h4><a href="#next-steps" class="anchor" name="next-steps"></a>下一步</h4>
<p>与往常一样，我们欢迎您提供反馈和意见，因此请通过<a href="https://stackoverflow.com/questions/tagged/spring-cloud-function">Stackoverflow</a>或<a href="https://github.com/spring-cloud/spring-cloud-function/">GitHub</a>与我们联系。</p>
</div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">var disqus_shortname = 'spring-io';
      var disqus_identifier = 3773;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));</script>
<noscript>请启用JavaScript以查看<a href="http://disqus.com/?ref_noscript">由Disqus提供</a>的<a href="http://disqus.com/?ref_noscript">评论。</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">由<span class="logo-disqus">Disqus</span>提供动力的评论</a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>背部</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">所有帖子</a> <a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">工程</a> <a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">发布</a> <a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">新闻与活动</a> <a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>将The Spring Team的更新发送到您的收件箱</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });</script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">球队</a></li>
<li><a href="/tools">工具类</a></li>
<li><a href="https://store.pivotal.io/">商店</a></li>
<li><a href="/blog">通讯</a></li>
</ul>
</div>
</div>© <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a> ，Inc.保留所有权利。
<a href="https://pivotal.io/terms-of-use">使用条款</a> • <a href="https://pivotal.io/privacy-policy">隐私</a> • <a href="/trademarks">商标准则</a>
<div id="teconsent" style="display:inline-block"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
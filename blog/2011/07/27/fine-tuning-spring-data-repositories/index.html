<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>Fine-tuning Spring Data repositories</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="Fine-tuning Spring Data repositories" />
<meta name="twitter:description" content="&lt;p&gt;It’s only been a few days only since we’ve released Spring Data JPA 1.0 GA which is the first major version of a &lt;a href=&quot;http://www.springsource.org/spring-data&quot;&gt;Spring Data&lt;/a&gt; project shipping with an implementation of the repository abstraction inside our Spring Data Commons module. The repository abstraction consists of three major parts: defining a repository interface, exposing CRUD methods and adding query methods. Adding query methods was discussed in detail in the &lt;a href=&quot;http://blog.springsource.com/2011/02/10/getting-started-with-spring-data-jpa/&quot;&gt;first Spring Data JPA blog post&lt;/a&gt;. But defining a repository interface and exposing CRUD methods triggered quite some questions in earlier blog posts. That’s why will have a closer look at them right now discussing the options available to users.&lt;/p&gt;
" />
<meta name="twitter:creator" content="@odrotbohm" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/977c74bb044a9d4fa90b305824eda390?s=200" />

<meta property="og:title" content="Fine-tuning Spring Data repositories" />
<meta property="og:image" content="https://gravatar.com/avatar/977c74bb044a9d4fa90b305824eda390?s=200" />
<meta property="og:description" content="&lt;p&gt;It’s only been a few days only since we’ve released Spring Data JPA 1.0 GA which is the first major version of a &lt;a href=&quot;http://www.springsource.org/spring-data&quot;&gt;Spring Data&lt;/a&gt; project shipping with an implementation of the repository abstraction inside our Spring Data Commons module. The repository abstraction consists of three major parts: defining a repository interface, exposing CRUD methods and adding query methods. Adding query methods was discussed in detail in the &lt;a href=&quot;http://blog.springsource.com/2011/02/10/getting-started-with-spring-data-jpa/&quot;&gt;first Spring Data JPA blog post&lt;/a&gt;. But defining a repository interface and exposing CRUD methods triggered quite some questions in earlier blog posts. That’s why will have a closer look at them right now discussing the options available to users.&lt;/p&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2011-07-27 18:37:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Fine-tuning Spring Data repositories</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/977c74bb044a9d4fa90b305824eda390?s=20&amp;d=mm" />
<a class="author" rel="author" href="/team/ogierke">Oliver Drotbohm</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2011-07-27 18:37:00.0">July 27, 2011</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="427" href="/blog/2011/07/27/fine-tuning-spring-data-repositories#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><p>It&rsquo;s only been a few days only since we&rsquo;ve released Spring Data JPA 1.0 GA which is the first major version of a <a href="http://www.springsource.org/spring-data">Spring Data</a> project shipping with an implementation of the repository abstraction inside our Spring Data Commons module. The repository abstraction consists of three major parts: defining a repository interface, exposing CRUD methods and adding query methods. Adding query methods was discussed in detail in the <a href="http://blog.springsource.com/2011/02/10/getting-started-with-spring-data-jpa/">first Spring Data JPA blog post</a>. But defining a repository interface and exposing CRUD methods triggered quite some questions in earlier blog posts. That&rsquo;s why will have a closer look at them right now discussing the options available to users.</p>
<h2>Declaring a Spring Data repository interface</h2><p>The declaration of a repository interface can be done in two ways: using annotations or by extending a marker interface:</p>
<pre><code class="prettyprint java"><br />@RepositoryDefinition(domainClass=Customer.class, idClass=Long.class)
public interface CustomerRepository {
  // declare query methods
}

public interface AccountRepository extends Repository&lt;Account, Long&gt; {
  // declare query methods
}
</code></pre><p>Which style to pick is pretty much a matter of taste. Purists who like to reduce the dependencies of there code as much as possible will probably stick to the annotation based approach but the inheritance based one is actually more consistent to the rest of the programming model. Whatever approach you choose, the Spring Data infrastructure will understand how to implement repository methods defined in these interfaces.</p>
<h2>CRUD methods</h2><p>The next step you might wanna do is exposing CRUD methods. To aid in doing so we provide two separate interfaces: <a href="http://static.springsource.org/spring-data/data-commons/docs/1.1.0.RELEASE/api/org/springframework/data/repository/CrudRepository.html"><code>CrudRepository</code></a> and <a href="http://static.springsource.org/spring-data/data-commons/docs/1.1.0.RELEASE/api/org/springframework/data/repository/PagingAndSortingRepository.html"><code>PagingAndSortingRepository</code></a> where the latter extends the former. As the name suggests <code>CrudRepository</code> exposes basic CRUD methods like <code>T save(T entity)</code>, <code>T findOne(ID id)</code> and <code>void delete(T entity)</code>. <code>PagingAndSortingRepository</code> exposes methods to do pagination out of the box, like <code>Page<T> findAll(Pageable pageable)</code>. To expose these methods to your clients simply extend these interfaces like this:</p>
<pre><code class="prettyprint java">public interface CustomerRepository extends PagingAndSortingRepository&lt;Customer, Long&gt; {
  // declare query methods here
}
</code></pre>
<h2>Fine-tuning repository interfaces</h2><p>Extending the previously shown interfaces is quite neat for a quick start but has a significant downside: you expose a pre-defined set of operations to clients that are not under you control, it&rsquo;s pretty much all or nothing until now. There&rsquo;s seemingly no way to only expose read operations while hiding state changing operations entirely. </p><p>To circumvent this issue we allow you to define custom base interfaces for your repositories where you can selectively expose the CRUD methods you like:</p>
<pre><code class="prettyprint java"><br />@NoRepositoryBean
public interface ReadOnlyRepository&lt;T, ID extends Serializable&gt; extends Repository&lt;T, ID&gt; {
  T findOne(ID id);
  Iterable&lt;T&gt; findAll();
  Iterable&lt;T&gt; findAll(Sort sort);
  Page&lt;T&gt; findAll(Pageable pageable);
}
</code></pre><p>There are a few crucial things to consider here: First, the intermediate interface has to be a Spring Data repository interface as well, which means it either has to be annotated with <code>@RepositoryDefinition</code> or extend <code>Repository</code> as shown here. You should also annotate the interface with <code>@NoRepositoryBean</code> to prevent an interface with formal type parameters <code>T</code> and <code>ID</code> from being picked up by the Spring Data classpath scanning. The last - and probably most crucial - part is that the method signatures have to match the ones in <code>CrudRepository</code> or <code>PagingAndSortingRepository</code>. Your actual repository interface would then look like this:</p>
<pre><code class="prettyprint java">public interface CustomerRepository extends ReadOnlyRepository&lt;Customer, Long&gt; {
  // declare query methods here
}
</code></pre><p>As the repository implementations backing the proxy created for that interface implement the methods declared in your custom intermediate interface we can route the calls to those into the implementations. You can even declare shared query methods inside a shared base interface:</p>
<pre><code class="prettyprint java">@NoRepositoryBean
public interface NamedRepository&lt;T, ID extends Serializable&gt; extends ReadOnlyRepository&lt;T, ID&gt; {
  List&lt;T&gt; findByName(String name);
}

public interface CustomerRepository extends NamedRepository&lt;Customer, Long&gt; { … }

public interface PersonRepository extends NamedRepository&lt;Person, Long&gt; { … }
</code></pre><p>This assumes <code>Customer</code> and <code>Person</code> share a <code>name</code> property (not necessarily through inheritance). since the query will be automatically derived from the method name then. It&rsquo;s even possible to manually define the queries executed for both concrete repositories by simply declaring JPA named queries <code>Customer.findByName</code> and <code>Person.findByName</code>. Using this approach you can easily come up with tailor-made base interfaces for your application scenario.</p>
<h2>Technology specific interfaces</h2><p>This leaves us with the question of when to use the technology specific base interfaces like <a href="http://static.springsource.org/spring-data/data-jpa/docs/1.0.0.RELEASE/api/org/springframework/data/jpa/repository/JpaRepository.html"><code>JpaRepository</code></a>. The first reason might be just the quick-start one: it exposes <code>List</code>-based read methods (e.g. <code>List<T> findAll()</code>) which developers using JPA are probably more used to as well as all the CRUD methods derived from it&rsquo;s super interfaces. We also expose some JPA specific methods here as some client&rsquo;s might need to call them. We actually recommend not to expose technology specifics to clients but sometimes it&rsquo;s simply pragmatism over theory. All these specialties can be exposed through a custom base interface as well (redeclare read methods returning <code>List</code>s, exposing JPA-specific methods), so you pretty much choose what&rsquo;s the least possible effort in your specific situation.</p><p>So if you want to get started with the repository abstraction of Spring Data feel free to have a look at our example projects for <a href="https://github.com/SpringSource/spring-data-jpa-examples">JPA</a> and <a href="https://github.com/SpringSource/spring-data-document-examples">Mongo</a> at Github.</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 427;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
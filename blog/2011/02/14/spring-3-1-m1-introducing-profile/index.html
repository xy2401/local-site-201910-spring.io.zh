<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>Spring 3.1 M1: Introducing @Profile</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="Spring 3.1 M1: Introducing @Profile" />
<meta name="twitter:description" content="&lt;h3&gt;Introduction&lt;/h3&gt;
&lt;p&gt;In my &lt;a href=&quot;http://blog.springsource.com/2011/02/11/spring-framework-3-1-m1-released/&quot;&gt;earlier post&lt;/a&gt; announcing Spring 3.1 M1, I discussed the new &lt;em&gt;bean definition profiles&lt;/em&gt; feature as applied when using Spring &lt;code&gt;&amp;lt;beans/&amp;gt;&lt;/code&gt; XML to configure the container. Today we’ll introduce the new &lt;code&gt;@Profile&lt;/code&gt; annotation and see how this same feature can be applied when using &lt;code&gt;@Configuration&lt;/code&gt; classes instead of XML. Along the way we’ll cover some best practices for designing &lt;code&gt;@Configuration&lt;/code&gt; classes.&lt;/p&gt;
&lt;h3&gt;Recall @Configuration&lt;/h3&gt;
&lt;p&gt;For those unfamiliar with @Configuration classes, you can think of them as a pure-Java equivalent to Spring &lt;code&gt;&amp;lt;beans/&amp;gt;&lt;/code&gt; XML files. We’ve blogged &lt;a href=&quot;http://blog.springsource.com/2006/11/28/a-java-configuration-option-for-spring/&quot;&gt;about&lt;/a&gt; &lt;a href=&quot;http://blog.springsource.com/2007/11/04/spring-java-configuration-moving-ahead/&quot;&gt;this&lt;/a&gt; &lt;a href=&quot;http://blog.springsource.com/2009/12/22/configuration-simplifications-in-spring-3-0/&quot;&gt;featureset&lt;/a&gt; before, and the reference documentation &lt;a href=&quot;http://static.springsource.org/spring/docs/3.1.0.M1/spring-framework-reference/html/beans.html#beans-java&quot;&gt;covers it well&lt;/a&gt;. You may want to revisit those resources if you need an introduction or a refresher.&lt;/p&gt;
" />
<meta name="twitter:creator" content="@cbeams" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/1e63dcf15fa29bebc0c68bc4d28b87e6?s=200" />

<meta property="og:title" content="Spring 3.1 M1: Introducing @Profile" />
<meta property="og:image" content="https://gravatar.com/avatar/1e63dcf15fa29bebc0c68bc4d28b87e6?s=200" />
<meta property="og:description" content="&lt;h3&gt;Introduction&lt;/h3&gt;
&lt;p&gt;In my &lt;a href=&quot;http://blog.springsource.com/2011/02/11/spring-framework-3-1-m1-released/&quot;&gt;earlier post&lt;/a&gt; announcing Spring 3.1 M1, I discussed the new &lt;em&gt;bean definition profiles&lt;/em&gt; feature as applied when using Spring &lt;code&gt;&amp;lt;beans/&amp;gt;&lt;/code&gt; XML to configure the container. Today we’ll introduce the new &lt;code&gt;@Profile&lt;/code&gt; annotation and see how this same feature can be applied when using &lt;code&gt;@Configuration&lt;/code&gt; classes instead of XML. Along the way we’ll cover some best practices for designing &lt;code&gt;@Configuration&lt;/code&gt; classes.&lt;/p&gt;
&lt;h3&gt;Recall @Configuration&lt;/h3&gt;
&lt;p&gt;For those unfamiliar with @Configuration classes, you can think of them as a pure-Java equivalent to Spring &lt;code&gt;&amp;lt;beans/&amp;gt;&lt;/code&gt; XML files. We’ve blogged &lt;a href=&quot;http://blog.springsource.com/2006/11/28/a-java-configuration-option-for-spring/&quot;&gt;about&lt;/a&gt; &lt;a href=&quot;http://blog.springsource.com/2007/11/04/spring-java-configuration-moving-ahead/&quot;&gt;this&lt;/a&gt; &lt;a href=&quot;http://blog.springsource.com/2009/12/22/configuration-simplifications-in-spring-3-0/&quot;&gt;featureset&lt;/a&gt; before, and the reference documentation &lt;a href=&quot;http://static.springsource.org/spring/docs/3.1.0.M1/spring-framework-reference/html/beans.html#beans-java&quot;&gt;covers it well&lt;/a&gt;. You may want to revisit those resources if you need an introduction or a refresher.&lt;/p&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2011-02-14 07:45:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Spring 3.1 M1: Introducing @Profile</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/1e63dcf15fa29bebc0c68bc4d28b87e6?s=20&amp;d=mm" />
<span class="author">Chris Beams</span>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2011-02-14 07:45:00.0">February 14, 2011</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="393" href="/blog/2011/02/14/spring-3-1-m1-introducing-profile#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><h3>Introduction</h3><p>In my <a href="http://blog.springsource.com/2011/02/11/spring-framework-3-1-m1-released/">earlier post</a> announcing Spring 3.1 M1, I discussed the new <em>bean definition profiles</em> feature as applied when using Spring <code>&lt;beans/&gt;</code> XML to configure the container. Today we&rsquo;ll introduce the new <code>@Profile</code> annotation and see how this same feature can be applied when using <code>@Configuration</code> classes instead of XML. Along the way we&rsquo;ll cover some best practices for designing <code>@Configuration</code> classes.</p>
<h3>Recall @Configuration</h3><p>For those unfamiliar with @Configuration classes, you can think of them as a pure-Java equivalent to Spring <code>&lt;beans/&gt;</code> XML files. We&rsquo;ve blogged <a href="http://blog.springsource.com/2006/11/28/a-java-configuration-option-for-spring/">about</a> <a href="http://blog.springsource.com/2007/11/04/spring-java-configuration-moving-ahead/">this</a> <a href="http://blog.springsource.com/2009/12/22/configuration-simplifications-in-spring-3-0/">featureset</a> before, and the reference documentation <a href="http://static.springsource.org/spring/docs/3.1.0.M1/spring-framework-reference/html/beans.html#beans-java">covers it well</a>. You may want to revisit those resources if you need an introduction or a refresher.</p><p>As we&rsquo;ll see in this and subsequent posts, much attention has been given to the <code>@Configuration</code> approach in Spring 3.1 in order to round it out and make it a truly first-class option for those who wish to configure their applications without XML. Today&rsquo;s post will cover just one of these enhancements: the new <code>@Profile</code> annotation.</p><p>As with the previous post, I&rsquo;ve worked up a brief sample where you can follow along and try things out for yourself. You can find it at <a href="https://bit.ly/huhvjD"><a href="https://github.com/cbeams/spring-3.1-profiles-java">https://github.com/cbeams/spring-3.1-profiles-java</a></a> and all the details for getting set up are in the README. This sample contains both the XML-based configuration covered in the last post, as well as <code>@Configuration</code> classes, in the com.bank.config.xml and com.bank.config.code packages, respectively. The <code>IntegrationTests</code> JUnit test case has been duplicated for each package; this should help you compare and contrast the two styles of bootstrapping the container.</p>
<h3>From XML to <code>@Configuration</code></h3><p>Let&rsquo;s dive in! Our task is simple: take the XML-based application shown previously and port it to an <code>@Configuration</code> style. We started the last post with an XML configuration looking like the following:</p>
<pre><code class="prettyprint xml"><br />&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
	xmlns:jdbc=&quot;http://www.springframework.org/schema/jdbc&quot;
	xsi:schemaLocation=&quot;...&quot;&gt;

	&lt;bean id=&quot;transferService&quot; class=&quot;com.bank.service.internal.DefaultTransferService&quot;&gt;
		&lt;constructor-arg ref=&quot;accountRepository&quot;/&gt;
		&lt;constructor-arg ref=&quot;feePolicy&quot;/&gt;
	&lt;/bean&gt;

	&lt;bean id=&quot;accountRepository&quot; class=&quot;com.bank.repository.internal.JdbcAccountRepository&quot;&gt;
		&lt;constructor-arg ref=&quot;dataSource&quot;/&gt;
	&lt;/bean&gt;

	&lt;bean id=&quot;feePolicy&quot; class=&quot;com.bank.service.internal.ZeroFeePolicy&quot;/&gt;

	&lt;jdbc:embedded-database id=&quot;dataSource&quot;&gt;
		&lt;jdbc:script location=&quot;classpath:com/bank/config/sql/schema.sql&quot;/&gt;
		&lt;jdbc:script location=&quot;classpath:com/bank/config/sql/test-data.sql&quot;/&gt;
	&lt;/jdbc:embedded-database&gt;
&lt;/beans&gt;
</code></pre><p>And this is straightforward to port into a <code>@Configuration</code> class:</p><p><code>src/main/com/bank/config/code/TransferServiceConfig.java</code></p>
<pre><code class="prettyprint java"><br />@Configuration
public class TransferServiceConfig {

	@Bean
	public TransferService transferService() {
		return new DefaultTransferService(accountRepository(), feePolicy());
	}

	@Bean
	public AccountRepository accountRepository() {
		return new JdbcAccountRepository(dataSource());
	}

	@Bean
	public FeePolicy feePolicy() {
		return new ZeroFeePolicy();
	}

	@Bean
	public DataSource dataSource() {
		return new EmbeddedDatabaseBuilder()
			.setType(EmbeddedDatabaseType.HSQL)
			.addScript(&quot;classpath:com/bank/config/sql/schema.sql&quot;)
			.addScript(&quot;classpath:com/bank/config/sql/test-data.sql&quot;)
			.build();
	}
}
</code></pre><p><em>Note:</em> The <code>EmbeddedDatabaseBuilder</code> is the component that underlies the <code>&lt;jdbc:embedded-database/&gt;</code> element originally used in the XML. As you can see, it&rsquo;s quite convenient for use within a <code>@Bean</code> method.</p><p>At this point, our <code>@Configuration</code>-based unit test would pass with the green bar:</p><p><code>src/test/com/bank/config/code/IntegrationTests.java</code></p>
<pre><code class="prettyprint java"><br />public class IntegrationTests {

	@Test
	public void transferTenDollars() throws InsufficientFundsException {

		AnnotationConfigApplicationContext ctx = new AnnotationConfigApplicationContext();
		ctx.register(TransferServiceConfig.class);
		ctx.refresh();

		TransferService transferService = ctx.getBean(TransferService.class);
		AccountRepository accountRepository = ctx.getBean(AccountRepository.class);

		assertThat(accountRepository.findById(&quot;A123&quot;).getBalance(), equalTo(100.00));
		assertThat(accountRepository.findById(&quot;C456&quot;).getBalance(), equalTo(0.00));

		transferService.transfer(10.00, &quot;A123&quot;, &quot;C456&quot;);

		assertThat(accountRepository.findById(&quot;A123&quot;).getBalance(), equalTo(90.00));
		assertThat(accountRepository.findById(&quot;C456&quot;).getBalance(), equalTo(10.00));
	}

}
</code></pre><p><code>AnnotationConfigApplicationContext</code> is used above, which allows for direct registration of <code>@Configuration</code> and other <code>@Component</code>-annotated classes. This leaves us with a string-free and type-safe way of configuring the container. There&rsquo;s no XML, which is great, but at this point our application suffers from the same problem we saw in the first post: when the application is deployed into production, a standalone datasource won&rsquo;t make sense. It will need to be looked up from JNDI.</p><p>This is no problem. Let&rsquo;s break the embedded- and JNDI-based datasources out into their own dedicated <code>@Configuration</code> classes:</p><p><code>src/main/com/bank/config/code/StandaloneDataConfig.java</code></p>
<pre><code class="prettyprint java"><br />@Configuration
@Profile(&quot;dev&quot;)
public class StandaloneDataConfig {

	@Bean
	public DataSource dataSource() {
		return new EmbeddedDatabaseBuilder()
			.setType(EmbeddedDatabaseType.HSQL)
			.addScript(&quot;classpath:com/bank/config/sql/schema.sql&quot;)
			.addScript(&quot;classpath:com/bank/config/sql/test-data.sql&quot;)
			.build();
	}

}
</code></pre><p><code>src/main/com/bank/config/code/JndiDataConfig.java</code></p>
<pre><code class="prettyprint java"><br />@Configuration
@Profile(&quot;production&quot;)
public class JndiDataConfig {

	@Bean
	public DataSource dataSource() throws Exception {
		Context ctx = new InitialContext();
		return (DataSource) ctx.lookup(&quot;java:comp/env/jdbc/datasource&quot;);
	}

}
</code></pre><p>At this point we have declared the two different <code>DataSource</code> beans within their own <code>@Profile</code>-annotated <code>@Configuration</code> classes. Just as with XML, these classes and the <code>@Bean</code> methods within them will be skipped or processed based on which Spring profiles are currently active. However, before we can see that in action, we first need to finish our refactoring. We&rsquo;ve split out the two possible <code>DataSource</code> beans but how can we reference them method from within <code>TransferServiceConfig</code> &ndash; specifically it&rsquo;s <code>accountRepository()</code> method? We have a couple of options, and both begin with understanding that <code>@Configuration</code> classes are candidates for <code>@Autowired</code> injection. This is because, in the end, <code>@Configuration</code> objects are managed as &ldquo;just another Spring bean&rdquo; in the container. Let&rsquo;s take a look:</p><p><code>src/main/com/bank/config/code/TransferServiceConfig.java</code></p>
<pre><code class="prettyprint java"><br />@Configuration
public class TransferServiceConfig {

	@Autowired DataSource dataSource;

	@Bean
	public TransferService transferService() {
		return new DefaultTransferService(accountRepository(), feePolicy());
	}

	@Bean
	public AccountRepository accountRepository() {
		return new JdbcAccountRepository(dataSource);
	}

	@Bean
	public FeePolicy feePolicy() {
		return new ZeroFeePolicy();
	}

}
</code></pre><p>With the use of the <code>@Autowired</code> annotation above, we&rsquo;ve asked the Spring container to inject the bean of type <code>DataSource</code> for us, regardless of where it was declared &ndash; in XML, in a <code>@Configuration</code> class, or otherwise. Then in the <code>accountRepository()</code> method, the injected <code>dataSource</code> field is simply referenced. This is one way of acheiving modularity between <code>@Configuration</code> classes, and is conceptually not unlike <code>ref</code>-style references between two <code>&lt;bean&gt;</code> elements declared in different XML files.</p><p>The final step in our refactoring is be to update the unit test to bootstrap not only <code>TransferServiceConfig</code>, but also the JNDI and standalone <code>@Configuration</code> variants of our <code>DataSource</code> bean:</p><p><code>src/test/com/bank/config/code/IntegrationTests.java</code></p>
<pre><code class="prettyprint java"><br />public class IntegrationTests {
	@Test
	public void transferTenDollars() throws InsufficientFundsException {
		AnnotationConfigApplicationContext ctx = new AnnotationConfigApplicationContext();
		ctx.getEnvironment().setActiveProfiles(&quot;dev&quot;);
		ctx.register(TransferServiceConfig.class, StandaloneDataConfig.class, JndiDataConfig.class);
		ctx.refresh();

		// proceed with assertions as above ...
	}
}
</code></pre><p>Now all of our <code>@Configuration</code> classes are available to the container at bootstrap time, and based on the profiles active (&ldquo;dev&rdquo; in this case), <code>@Profile</code>-annotated classes and their beans will be processed or skipped. As a quick note, you could avoid listing out each <code>@Configuration</code> class above and instead tell <code>AnnotationConfigApplicationContext</code> to simply scan the entire <code>.config</code> package, detecting all of our classes in one fell swoop. This is the loose equivalent of loading Spring XML files based on a wildcard (e.g., <code>**/*-config.xml</code>):</p>
<pre><code class="prettyprint java"><br />		AnnotationConfigApplicationContext ctx = new AnnotationConfigApplicationContext();
		ctx.getEnvironment().setActiveProfiles(&quot;dev&quot;);
		ctx.scan(&quot;com.bank.config.code&quot;); // find and register all @Configuration classes within
		ctx.refresh();
</code></pre><p>However you choose to register your <code>@Configuration</code> classes, at this point our task is complete! We&rsquo;ve ported our configuration from Spring <code>&lt;beans/&gt;</code> XML to <code>@Configuration</code> classes and bootstrapped the container directly from those classes using <code>AnnotationConfigApplicationContext</code>.</p>
<h3>Further improving <code>@Configuration</code> class structure</h3><p>Everything works in our application and the JUnit bar is green, but there&rsquo;s still room for improvement. Recall how a <code>DataSource</code> bean was <code>@Autowired</code> into <code>TransferServiceConfig</code>? This works well, but it&rsquo;s not terribly clear <em>where</em> the bean came from. As mentioned above, it could be from XML, or from any other <code>@Configuration</code> class. The technique I&rsquo;ll describe below introduces <em>object-oriented configuration</em> and should further our goals of having a natural Java-based configuration &ndash; one that can take full advantage of the power of your IDE.</p><p>If we think about <code>StandaloneDataConfig</code> and <code>JndiDataConfig</code>, they&rsquo;re really two clases of the same kind, in that they both declare a method with the following signature:</p>
<pre><code class="prettyprint java"><br />		public DataSource dataSource();
</code></pre><p>All that&rsquo;s missing, it seems, is an interface unifying the two. Let&rsquo;s introduce one &ndash; we&rsquo;ll see why shortly below:</p><p><code>src/main/com/bank/config/code/DataConfig.java</code></p>
<pre><code class="prettyprint java"><br />interface DataConfig {
	DataSource dataSource();
}
</code></pre><p>And of course update the two <code>@Configuration</code> classes to implement this new interface:</p>
<pre><code class="prettyprint java"><br />@Configuration
public class StandaloneDataConfig implements DataConfig { ... }

@Configuration
public class JndiDataConfig implements DataConfig { ... }
</code></pre><p>What does this buy us? Just like we <code>@Autowired</code> the <code>DataSource</code> bean directly into <code>TransferServiceConfig</code>, <em>we an also inject <code>@Configuration</code> instances themselves</code></em>. Let&rsquo;s see this in action:</p><p><code>src/main/com/bank/config/code/TransferServiceConfig.java</code></p>
<pre><code class="prettyprint java"><br />@Configuration
public class TransferServiceConfig {

	@Autowired DataConfig dataConfig;

	// ...

	@Bean
	public AccountRepository accountRepository() {
		return new JdbcAccountRepository(dataConfig.dataSource());
	}

	// ...
}
</code></pre><p>This allows us full navigability through the codebase using the IDE. The screenshot below shows the result of pressing CTRL-T on the invocation of <code>dataConfig.dataSource()</code> to get a &ldquo;Quick Hierarchy&rdquo; hover:</p><p><a href="http://blog.springsource.com/wp-content/uploads/2011/02/Screen-shot-2011-02-12-at-9.27.48-PM.png"><img src="http://blog.springsource.com/wp-content/uploads/2011/02/Screen-shot-2011-02-12-at-9.27.48-PM.png" alt="Quick implementation hierarchy for DataConfig.dataSource()" title="Quick Hierarchy" width="651" height="300" class="alignnone size-full wp-image-7839" /></a></p><p>It&rsquo;s now very easy to ask the question &ldquo;where was the <code>DataSource</code> bean defined?&rdquo; and have the answer constrained to a set of types implementing <code>DataConfig</code>. Not bad if we&rsquo;re trying to do things in a way that is as familiar and useful to Java developers as possible.</p>
<h3>More advanced use of <code>@Profile</code></h3><p>Worth a quick mention is that like many Spring annotations, <code>@Profile</code> may be used as a <em>meta-annotation</em>. This means that you may define your own custom annotations, mark them with <code>@Profile</code>, and Spring will still detect the presence of the <code>@Profile</code> annotation as if it had been declared directly.</p>
<pre><code class="prettyprint java"><br />package com.bank.annotation;

@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Profile(&quot;dev&quot;)
pubilc @interface Dev {
}
</code></pre><p>This allows us to mark our <code>@Component</code> classes with the new custom <code>@Dev</code> annotation, rather than being required to use Spring&rsquo;s <code>@Profile</code>:</p>
<pre><code class="prettyprint java"><br />@Dev @Component
public class MyDevService { ... }
</code></pre><p>Or, from the examples above, marking our <code>StandaloneDataConfig</code> with <code>@Dev</code> would work too:</p>
<pre><code class="prettyprint java"><br />@Dev @Configuration
public class StandaloneDataConfig { ... }
</code></pre>
<h3>Summary</h3><p>Spring 3.1&rsquo;s bean definition profiles feature is supported fully across the XML and <code>@Configuration</code> styles. Whichever style you prefer, we hope you&rsquo;ll find profiles useful. Keep the feedback coming, as it&rsquo;ll have direct impact on 3.1 M2 which is just around the corner. In the next post we&rsquo;ll take a deeper look at Spring&rsquo;s new <em><code>Environment</code></em> abstraction and how it helps with regard to managing configuration properties in your applications. Stay tuned!</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 393;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>What&#39;s a FactoryBean?</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="What&#39;s a FactoryBean?" />
<meta name="twitter:description" content="&lt;p&gt;&lt;/p&gt;
&lt;p&gt; In this post, I’ll look at Spring’s &lt;code&gt; org.springframework.beans.factory.FactoryBean&amp;lt;T&amp;gt;&lt;/code&gt; interface. The definition of this interface is: &lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;prettyprint java&quot;&gt;&lt;br&gt;public interface FactoryBean&amp;lt;T&amp;gt; {
  T getObject() throws Exception;
  Class&amp;lt;T&amp;gt; getObjectType();
  boolean isSingleton();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt; A &lt;code&gt;FactoryBean&lt;/code&gt; is a pattern to encapsulate interesting object construction logic in a class. It might be used, for example, to encode the construction of a complex object graph in a reusable way. Often this is used to construct complex objects that have many dependencies. It might also be used when the construction logic itself is highly volatile and depends on the configuration. A &lt;code&gt;FactoryBean&lt;/code&gt; is also useful to help Spring construct objects that it couldn’t easily construct itself. For example, in order to inject a reference to a bean that was obtained from JNDI, the reference must first be obtained. You can use the &lt;code&gt;JndiFactoryBean&lt;/code&gt; to obtain this reference in a consistent way. You may inject the result of a &lt;code&gt;FactoryBean&lt;/code&gt;’s &lt;code&gt;getObject()&lt;/code&gt; method into any other property. &lt;/p&gt;
" />
<meta name="twitter:creator" content="@starbuxman" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/fb22593caf24e4bb4c98d467cdd247e6?s=200" />

<meta property="og:title" content="What&#39;s a FactoryBean?" />
<meta property="og:image" content="https://gravatar.com/avatar/fb22593caf24e4bb4c98d467cdd247e6?s=200" />
<meta property="og:description" content="&lt;p&gt;&lt;/p&gt;
&lt;p&gt; In this post, I’ll look at Spring’s &lt;code&gt; org.springframework.beans.factory.FactoryBean&amp;lt;T&amp;gt;&lt;/code&gt; interface. The definition of this interface is: &lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;prettyprint java&quot;&gt;&lt;br&gt;public interface FactoryBean&amp;lt;T&amp;gt; {
  T getObject() throws Exception;
  Class&amp;lt;T&amp;gt; getObjectType();
  boolean isSingleton();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt; A &lt;code&gt;FactoryBean&lt;/code&gt; is a pattern to encapsulate interesting object construction logic in a class. It might be used, for example, to encode the construction of a complex object graph in a reusable way. Often this is used to construct complex objects that have many dependencies. It might also be used when the construction logic itself is highly volatile and depends on the configuration. A &lt;code&gt;FactoryBean&lt;/code&gt; is also useful to help Spring construct objects that it couldn’t easily construct itself. For example, in order to inject a reference to a bean that was obtained from JNDI, the reference must first be obtained. You can use the &lt;code&gt;JndiFactoryBean&lt;/code&gt; to obtain this reference in a consistent way. You may inject the result of a &lt;code&gt;FactoryBean&lt;/code&gt;’s &lt;code&gt;getObject()&lt;/code&gt; method into any other property. &lt;/p&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2011-08-09 20:23:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">What&#39;s a FactoryBean?</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/fb22593caf24e4bb4c98d467cdd247e6?s=20&amp;d=mm" />
<a class="author" rel="author" href="/team/jlong">Josh Long</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2011-08-09 20:23:00.0">August 09, 2011</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="431" href="/blog/2011/08/09/what-s-a-factorybean#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><p><P> In this post, I&rsquo;ll look at Spring&rsquo;s <code> org.springframework.beans.factory.FactoryBean&lt;T&gt;</code> interface. The definition of this interface is: </p> </p>
<pre><code class="prettyprint java"><br />public interface FactoryBean&lt;T&gt; {
  T getObject() throws Exception;
  Class&lt;T&gt; getObjectType();
  boolean isSingleton();
}
</code></pre><p><P> A <CODE>FactoryBean</CODE> is a pattern to encapsulate interesting object construction logic in a class. It might be used, for example, to encode the construction of a complex object graph in a reusable way. Often this is used to construct complex objects that have many dependencies. It might also be used when the construction logic itself is highly volatile and depends on the configuration. A <CODE>FactoryBean</CODE> is also useful to help Spring construct objects that it couldn&rsquo;t easily construct itself. For example, in order to inject a reference to a bean that was obtained from JNDI, the reference must first be obtained. You can use the <CODE>JndiFactoryBean</CODE> to obtain this reference in a consistent way. You may inject the result of a <CODE>FactoryBean</CODE>&rsquo;s <CODE>getObject()</CODE> method into any other property. </p> </p>
<p> Suppose you have a <code>Person</code> class whose definition is thus:</p>
<pre><code class="prettyprint java"><br />public class Person { 
 private Car car ;
 private void setCar(Car car){ this.car = car;  }	
}
</code></pre><p>and a <CODE>FactoryBean</code> whose definition is thus:</p>
<pre><code class="prettyprint java"><br />public class MyCarFactoryBean implements FactoryBean&lt;Car&gt;{
  private String make; 
  private int year ;

  public void setMake(String m){ this.make =m ; }

  public void setYear(int y){ this.year = y; }

  public Car getObject(){ 
    // wouldn&#39;t be a very useful FactoryBean 
    // if we could simply instantiate the object!
    CarBuilder cb = CarBuilder.car();
	
    if(year!=0) cb.setYear(this.year);
    if(StringUtils.hasText(this.make)) cb.setMake( this.make ); 
    return cb.factory(); 
  }

  public Class&lt;Car&gt; getObjectType() { return Car.class ; } 

  public boolean isSingleton() { return false; }
}
</code></pre>
<p> You could wire up a <CODE>Car</CODE> instance using a hypothetical <CODe>CarFactoryBean</CODE> like this: </p>
<pre><code class="prettyprint xml"><br />&lt;bean class = &quot;a.b.c.MyCarFactoryBean&quot; id = &quot;car&quot;&gt;
	&lt;property name = &quot;make&quot; value =&quot;Honda&quot;/&gt;
	&lt;property name = &quot;year&quot; value =&quot;1984&quot;/&gt;
&lt;/bean&gt;
&lt;bean class = &quot;a.b.c.Person&quot; id = &quot;josh&quot;&gt;
	&lt;property name = &quot;car&quot; ref = &quot;car&quot;/&gt;
&lt;/bean&gt;
</code></pre><p><P> In this example, the result of the <CODE>FactoryBean</CODE>&rsquo;s <CODE>getObject</CODE> method will be passed, not the actual <code>FactoryBean</code> itself. Spring knows that the result can be injected into the target property because it&rsquo;ll consult the <Code>FactoryBean</code>&rsquo;s <code>getObjectType()</code> return value to determine the type of the factoried object, and then it will check whether that type can be injected into the injection site. Spring reserves - but in practice doesn&rsquo;t always exercise - the right to cache the returned bean if the <CODE>FactoryBean</CODE>&rsquo;s <code>isSingleton()</code> method returns true. </p> </p>
<p> If you are using Spring's newer (and far more elegant, in my humble opinion) Java based configuration, then you will find this doesn't work quite as you'd expect. It can still be made to work, but you must dereference the <CODE>FactoryBean</CODE> explicitly in Java configuration and call <code>getObject()</CODE> yourself, like this: </p>
<pre><code class="prettyprint java"><br />// identical configuration in Java to the XML above			
@Configuration 
public class CarConfiguration { 

  @Bean 
  public MyCarFactoryBean carFactoryBean(){ 
	MyCarFactoryBean cfb = new MyCarFactoryBean();
	cfb.setMake(&quot;Honda&quot;);
	cfb.setYear(1984);
	return cfb;
  }

  @Bean
  public Person aPerson(){ 
	Person person = new Person();
	person.setCar( carFactoryBean().getObject());
	return person; 
  }	
}
</code></pre><p><P> Note that, essentially, all beans configured in Spring end up in the same place at runtime. You may define a <CODE>FactoryBean</CODE> in Java configuration (as above) but then use the factory bean in XML, like you would a <CODE>FactoryBean</CODE> defined in XML. </P> <p>Spring <CODE> FactoryBean</code>s have all the other characteristics of any other Spring bean, including the lifecycle hooks and services (like AOP) that all beans in the Spring container enjoy. </p> <p>So, if you&rsquo;d like a chance to perform construction logic after the properties on the <CODE>FactoryBean</code> have been set, but before the <code>getObject()</CODE> method has been called, then you can tell the Spring container give your <CODE>FactoryBean</CODE> a callback. One way to do this is to implement the <CODE>InitializingBean</CODE> interface. This will be called no matter what. A far more POJO-centric alternative is to annotate a method with <CODE>@PostConstruct</CODE>. This method will be called, in this case, after both the code&gt;make</code> and the <code>year</code> properties have been set. You might use this callback to do sanity checks before the object construction&rsquo;s finished, but after the configuration by the container has finished.</p> </p>
<pre><code class="prettyprint java"><br /> @PostConstruct 
 public void setup() throws Throwable { 
   // these methods throw an exception that 
   // will arrest construction if the assertions aren&#39;t met
   Assert.notNull(this.make, &quot;the &#39;make&#39; must not be null&quot;)	;
   Assert.isTrue(this.year &gt; 0, &quot;the &#39;year&#39; must be a valid value&quot;); 
 }
</code></pre><p><P>One important takeaway here is that it is the <Code>FactoryBean</CODE>, <em>not</em> the factoried object itself, that lives in the Spring container and enjoys the lifecycle hooks and container services. The returned instance is transient - Spring knows nothing about what you&rsquo;ve returned from <code>getObject() </code>, and will make no attempt to exercise any lifecycle hooks or anything else on it. </p> </p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 431;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
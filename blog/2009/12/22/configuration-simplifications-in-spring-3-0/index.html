<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>Configuration Simplifications in Spring 3.0</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="Configuration Simplifications in Spring 3.0" />
<meta name="twitter:description" content="&lt;p&gt;Second in a series of posts on “Spring 3 Simplifications” started yesterday by &lt;a href=&quot;http://blog.springsource.com/2009/12/21/mvc-simplifications-in-spring-3-0/&quot;&gt;Keith&lt;/a&gt;, I’d like to provide a very brief and hands-on introduction to Spring’s new &lt;a href=&quot;http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/annotation/Configuration.html&quot;&gt;@Configuration&lt;/a&gt; annotation and related support.&lt;/p&gt;
&lt;p&gt;As those that followed the Spring JavaConfig project will know, a @Configuration-annotated class serves much the same role as a Spring XML file. It provides a code-centric way of declaring Spring bean definitions using nothing more than methods and annotations. You might call it &lt;em&gt;Plain Old Configuration*&lt;/em&gt; :) This means that for simple situations, no XML will be required!&lt;/p&gt;
" />
<meta name="twitter:creator" content="@cbeams" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/1e63dcf15fa29bebc0c68bc4d28b87e6?s=200" />

<meta property="og:title" content="Configuration Simplifications in Spring 3.0" />
<meta property="og:image" content="https://gravatar.com/avatar/1e63dcf15fa29bebc0c68bc4d28b87e6?s=200" />
<meta property="og:description" content="&lt;p&gt;Second in a series of posts on “Spring 3 Simplifications” started yesterday by &lt;a href=&quot;http://blog.springsource.com/2009/12/21/mvc-simplifications-in-spring-3-0/&quot;&gt;Keith&lt;/a&gt;, I’d like to provide a very brief and hands-on introduction to Spring’s new &lt;a href=&quot;http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/annotation/Configuration.html&quot;&gt;@Configuration&lt;/a&gt; annotation and related support.&lt;/p&gt;
&lt;p&gt;As those that followed the Spring JavaConfig project will know, a @Configuration-annotated class serves much the same role as a Spring XML file. It provides a code-centric way of declaring Spring bean definitions using nothing more than methods and annotations. You might call it &lt;em&gt;Plain Old Configuration*&lt;/em&gt; :) This means that for simple situations, no XML will be required!&lt;/p&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2009-12-22 22:37:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Configuration Simplifications in Spring 3.0</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/1e63dcf15fa29bebc0c68bc4d28b87e6?s=20&amp;d=mm" />
<span class="author">Chris Beams</span>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2009-12-22 22:37:00.0">December 22, 2009</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="296" href="/blog/2009/12/22/configuration-simplifications-in-spring-3-0#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><p>Second in a series of posts on &ldquo;Spring 3 Simplifications&rdquo; started yesterday by <a href="http://blog.springsource.com/2009/12/21/mvc-simplifications-in-spring-3-0/">Keith</a>, I&rsquo;d like to provide a very brief and hands-on introduction to Spring&rsquo;s new <a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/annotation/Configuration.html">@Configuration</a> annotation and related support.</p><p>As those that followed the Spring JavaConfig project will know, a @Configuration-annotated class serves much the same role as a Spring XML file. It provides a code-centric way of declaring Spring bean definitions using nothing more than methods and annotations. You might call it <em>Plain Old Configuration*</em> :) This means that for simple situations, no XML will be required!</p><p>Let&rsquo;s get started. To demonstrate @Configuration functionality, I&rsquo;ve created a <a href="https://src.springframework.org/svn/spring-samples/configuration-basic/trunk">very simple project</a> in the new spring-samples SVN repository. You may want to sync up and build it right now. You&rsquo;ll need a Subversion client and recent version of Maven.</p><p><code><br />svn co <a href="https://src.springframework.org/svn/spring-samples/configuration-basic/trunk">https://src.springframework.org/svn/spring-samples/configuration-basic/trunk</a> configuration-basic<br />cd configuration-basic<br />mvn clean test<br />[&hellip;]<br />Tests run: 1, Failures: 0, Errors: 0, Skipped: 0</p><p>[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;<br />[INFO] BUILD SUCCESSFUL<br />[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;<br /></code></p><p>Eclipse .classpath and .project metadata is also included in the checkout, so you can import the project using the <a href="http://www.springsource.com/products/sts">SpringSource Tool Suite</a>, or any recent version of Eclipse with the <a href="http://m2eclipse.sonatype.org/">m2eclipse plugin</a> installed. In either case, use File-&gt;Import-&gt;Existing Projects into Workspace. </p><p>To begin, let&rsquo;s take a look at <a href="https://src.springframework.org/svn/spring-samples/configuration-basic/trunk/src/main/java/org/springframework/samples/config/basic/account/AppConfig.java">AppConfig.java</a>. This @Configuration-annotated class serves the same role as an app-config.xml would in an XML-based Spring application. It&rsquo;s a good place to start when reviewing the project, because it serves as the &lsquo;blueprint&rsquo; for how object instances are wired up and managed at runtime.</p>
<pre><code class="prettyprint java"><br />@Configuration
public class AppConfig {

    public @Bean TransferService transferService() {
        return new TransferServiceImpl(accountRepository());
    }

    public @Bean AccountRepository accountRepository() {
        return new InMemoryAccountRepository();
    }

}
</code></pre><p>Granted, this is trivial example of an application without even so much as a real JDBC DataSource in the mix. That&rsquo;s okay, the goal for this post is just to convey the basic concepts. The @Bean methods above will be recognized and invoked by the Spring container at the right time and the objects returned will be managed in the Spring container just like any other bean. You can see that dependencies between beans can be expressed simply as calls from one bean method to another. TransferServiceImpl needs an AccountRepository constructor argument, so simply call the accountRepository() method.</p><p>Savvy Spring users will look at this scenario, however, and ask the question &ldquo;what about bean scoping&rdquo;? It&rsquo;s a good question. As you probably know, all Spring beans have a scope. By default, a bean&rsquo;s scope is that of &lsquo;singleton&rsquo;, meaning that there will be one and only one instance of that bean per Spring container. Glancing at the code above, it seems that if we call accountRepository() multiple times, we&rsquo;ll actually create multiple instances, but this is not actually the case! When a @Configuration class is processed at runtime, it is dynamically subclassed (using CGLIB), and the subclass implementations of @Bean methods are enhanced to ensure that scoping semantics are respected.</p><p>As you can see, defining @Bean methods is pretty straightforward. Now, let&rsquo;s bootstrap the container and use those objects.</p><p>Take a look at the <a href="https://src.springframework.org/svn/spring-samples/configuration-basic/trunk/src/test/java/org/springframework/samples/config/basic/account/TransferServiceTest.java">TransferServiceTest</a> JUnit system test and its transfer100Dollars() @Test method. The first thing you&rsquo;ll notice is the use of <a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/annotation/AnnotationConfigApplicationContext.html">AnnotationConfigApplicationContext</a>. This new ApplicationContext implementation has been added in Spring 3 to support instantiation of the Spring container using @Configuration classes directly. The context is created with AppConfig.class as a constructor parameter, after which we retrieve the TransferService and AccountRepository beans by type with the <a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/support/AbstractApplicationContext.html#getBean%28java.lang.Class%29">getBean(Class<T>)</a> method. The rest of the method is just standard JUnit assertions exercising the TransferService and AccountRepository APIs, ensuring that everything works as expected.</p>
<pre><code class="prettyprint java"><br />public class TransferServiceTest {

    @Test
    public void transfer100Dollars() {
        // create the spring container using the AppConfig @Configuration class
        ApplicationContext ctx = new AnnotationConfigApplicationContext(AppConfig.class);

        // retrieve the beans we&#39;ll use during testing
        AccountRepository accountRepository = ctx.getBean(AccountRepository.class);
        TransferService transferService = ctx.getBean(TransferService.class);

        // create accounts to test against
        accountRepository.add(new Account(&quot;A123&quot;, 1000.00));
        accountRepository.add(new Account(&quot;C456&quot;, 0.00));

        // check account balances before transfer
        assertThat(accountRepository.findById(&quot;A123&quot;).getBalance(), equalTo(1000.00));
        assertThat(accountRepository.findById(&quot;C456&quot;).getBalance(), equalTo(0.00));

        // perform transfer
        transferService.transfer(100.00, &quot;A123&quot;, &quot;C456&quot;);

        // check account balances after transfer
        assertThat(accountRepository.findById(&quot;A123&quot;).getBalance(), equalTo(900.00));
        assertThat(accountRepository.findById(&quot;C456&quot;).getBalance(), equalTo(100.00));
    }

}
</code></pre><p>That&rsquo;s it! Simple, pure Java, type-safe configuration. We hope you&rsquo;ll find this a convenient and powerful addition to Spring&rsquo;s core dependency injection support.</p><p>Of course, we&rsquo;ve just scratched the surface here today. So much more can be done with @Configuration classes and we&rsquo;ll explore those features in future posts. But don&rsquo;t wait for me - you can check them all out for yourself right now by reading the <a href="http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html#beans-java">@Configuration section of the Spring 3 reference documentation</a>. <strong>I encourage everyone to use this sample project as a starting point from which you can quickly road test the rest of this new support</strong>.</p><p>I look forward to your feedback. Enjoy playing with @Configuration and all the new Spring 3 features and have a happy holiday!</p>
<ul>
<li><em>Thanks to Erich Eichinger for (half-jokingly) coining the phrase &lsquo;Plain Old Configuration&rsquo;. You can take a look at the work he and the Spring.NET team are doing with their similar &lsquo;CodeConfig&rsquo; project <a href="https://eeichinger.blogspot.com/2009/12/merry-xmlless-codeconfig-for-springnet.html">here</a>.</em></li>
</ul></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 296;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
 </li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
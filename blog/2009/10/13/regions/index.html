<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>Regions </title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="Regions " />
<meta name="twitter:description" content="&lt;p&gt;&lt;em&gt;(updated 15Oct2009)&lt;/em&gt;&lt;br&gt;Beginning in milestone M5, dm Server 2.0 employs &lt;strong&gt;&lt;em&gt;region&lt;/em&gt;&lt;/strong&gt;s to isolate the kernel from users’ applications. This means that the kernel implementation is &lt;em&gt;almost&lt;/em&gt; completely invisible to applications and to application management.&lt;/p&gt;
&lt;p&gt;Also in milestone M5, support for &lt;em&gt;cloning&lt;/em&gt; is completely removed. Region isolation and scoped plans between them offer &lt;em&gt;much&lt;/em&gt; simpler and more manageable solutions to the most common problems that cloning was intended to address.&lt;/p&gt;
&lt;p&gt;In the following two sections I outline these changes, and the reasons we made them.&lt;br&gt;&lt;/p&gt;
" />

<meta property="og:title" content="Regions " />
<meta property="og:description" content="&lt;p&gt;&lt;em&gt;(updated 15Oct2009)&lt;/em&gt;&lt;br&gt;Beginning in milestone M5, dm Server 2.0 employs &lt;strong&gt;&lt;em&gt;region&lt;/em&gt;&lt;/strong&gt;s to isolate the kernel from users’ applications. This means that the kernel implementation is &lt;em&gt;almost&lt;/em&gt; completely invisible to applications and to application management.&lt;/p&gt;
&lt;p&gt;Also in milestone M5, support for &lt;em&gt;cloning&lt;/em&gt; is completely removed. Region isolation and scoped plans between them offer &lt;em&gt;much&lt;/em&gt; simpler and more manageable solutions to the most common problems that cloning was intended to address.&lt;/p&gt;
&lt;p&gt;In the following two sections I outline these changes, and the reasons we made them.&lt;br&gt;&lt;/p&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2009-10-13 15:25:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Regions </h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="null?s=20&amp;d=mm" />
<span class="author">Steve Powell</span>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2009-10-13 15:25:00.0">October 13, 2009</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="273" href="/blog/2009/10/13/regions#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><p><em>(updated 15Oct2009)</em><br />Beginning in milestone M5, dm Server 2.0 employs <strong><em>region</em></strong>s to isolate the kernel from users’ applications. This means that the kernel implementation is <em>almost</em> completely invisible to applications and to application management.</p><p>Also in milestone M5, support for <em>cloning</em> is completely removed. Region isolation and scoped plans between them offer <em>much</em> simpler and more manageable solutions to the most common problems that cloning was intended to address.</p><p>In the following two sections I outline these changes, and the reasons we made them.<br /><h2 id="the_regional_news">The regional news</h2><br />A <strong><em>Region</em></strong> is just like an OSGi framework—it is where applications are installed, resolved and run.</p><p>dm Kernel creates a single <strong><em>User Region</em></strong> in which to run applications and all applications (including the ones that dm Server supplies—Splash, Admin, Web and Hosted Repository) are deployed into the <strong><em>User Region</em></strong>.</p><p>Kernel bundles are <strong><em>not</em></strong> installed in the <em>user region</em> (apart from a few needed for region management). The necessary function to support the kernel runs in the OSGi framework, but the user region applications cannot see it, except for the services that are normally offered. The applications are <em>isolated</em> from the kernel implementation.</p><p><img src="http://blog.springsource.com/wp-content/uploads/2009/10/regions.png" alt="The user region" /></p><p>This isolation has many benefits: for example, it is no longer necessary for the kernel and the users’ applications to use the same version of the Spring Framework. (In fact the kernel doesn’t install all of the Spring Framework—it doesn’t need to.) If the kernel is updated it is far less likely that applications will need to be upgraded or adjusted to accommodate this. The kernel implementation is therefore much more stable and resilient and applications are much more likely to survive kernel upgrades between releases.<br /><h3 id="regions_to_be_cheerful">Regions to be cheerful</h3><br /><ul><br /> <li>Using the <em>Shell</em> or the <em>Admin Console</em> you only see the <em>User Region</em>—the kernel implementation bundles are not visible, simplifying the administration view. [Note added 15Oct2009: a few kernel bundles are still visible in the User Region, because the kernel has installed them there for region management.]</li><br /> <li>The design is quite capable of being extended to accommodate multiple user regions in future releases; there is a small and fixed overhead to managing a region—the implementation is scalable.</li><br /> <li>Basic initialisation of the user region is configurable and entirely independent of the kernel.</li><br /> <li>The implementation of regions is completely general—it does not depend upon Spring or Spring DM in any way. If required, a user region can be configured with no Spring support at all, if that’s what you need.</li><br /></ul><br /><h2 id="send_in_the_clones">Send in the clones</h2><br />Cloning was described in April by Rob in the <a title="dm Server Roadmap" href="http://blog.springsource.com/2009/04/01/springsource-dm-server-roadmap/">dm Server Roadmap</a>. Cloning is a way of separating the dependencies of two applications that would otherwise <strong><em>either</em></strong> share artefacts which <em>should not</em> be shared, <strong><em>or</em></strong> try to share artefacts which <em>cannot</em> be shared.</p><p>For example, sharing bundles with <em>static state</em> may not be desirable, and being able to have a copy (clone) of such a bundle means that different applications can use the different clones (the application scoping mechanism allows us to have multiple copies installed in the framework under distinct names). In another case, when a lower-level bundle is pinned by a dependency through a common intermediary (which is often part of the Spring Framework), cloning the intermediary allows the clone to depend upon a different lover-level bundle, freeing the clone to satisfy a transitive constraint the original intermediary could not.</p><p>In the milestone releases of dm Server 2.0 (up to M4) cloning support (both manual and automatic) has been available. We have received a lot of feedback and experience from this implementation and as an experiment it has proved fruitful. However, time and experience have shown us that this is not yet ready for production, so cloning is <strong><em>removed</em></strong> from M5, and will not be part of the final 2.0 release. Region isolation, together with scoped plans, can be used to manage the most common problems that cloning was designed to address. These solutions are much easier to understand and <em>much</em> easier to support in production.<br /><h3 id="one_careful_cloner">One careful cloner</h3><br />The most important reason for removing cloning is that automatic cloning is far too brittle and unpredictable:<br /><ul><br /> <li>It is brilliant when it works, but in general it can take a very long time (to fail or to succeed).</li><br /> <li>It is <em>extremely</em> hard to understand what cloning has happened and why, and it cannot be guaranteed that the same cloning solutions will be obtained every time for deployment of the same artefact.</li><br /></ul><br />These are not properties that most system administrators want for a production system (though they can sometimes be convenient in development). In production we need a predictable configuration which can be relied upon to work the same way every time (or else fail quickly).</p><p>Manual cloning is relatively stable, but even here there are problems:<br /><ul><br /> <li>In the pinning situation (outlined above) rather a lot of intermediaries may need to be cloned.</li><br /> <li>It is non-trivial to determine which clones are needed beforehand. (It is precisely this difficulty that makes auto-cloning hard to do well and efficiently.)</li><br /></ul><br />Both cloning solutions also depend upon scoping and these solutions do not work for unscoped applications.</p><p>Finally, the cloning implementation had to include Spring dependencies as a special case in order to work efficiently. The Spring DM extender also introduced special cases: these do not generalise at all well for other extenders and other libraries. It’s just too Spring-specific.</p><p>Overall, although some of the achievements of cloning and auto-cloning were impressive, the function is simply not stable enough to support in the field and is therefore removed in the interests of overall quality and stability.</p><p>The most important problems can be solved by region isolation and explicit scoping.<br /><h2 id="high_notes_and_low_notes">High notes and low notes</h2><br />Although it is likely that some will mourn the passing of cloning support (and it was fun to write, though not to debug), region isolation and existing scoped applications (and plans) offer a much simpler and more robust solution to common dependency problems.</p><p>The pinning problems were nearly all produced through the Spring Framework, so the isolation of the user region offers a solution to most of these issues.</p><p>Other common cases can be solved through appropriate use of scoped applications, and this is actually a much more controllable and supportable way of managing the artefacts installed in the server. <strong><em>Scoped plans</em></strong> make it easy to create the desired scopes, and the resolution wiring remains stable during production as the framework context changes.</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 273;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>REST in Spring 3: @MVC</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="REST in Spring 3: @MVC" />
<meta name="twitter:description" content="&lt;p&gt;In the last couple of years, REST has emerged as a compelling alternative to SOAP/WSDL/WS-*-based distributed architectures. So when we started to plan our work on the next major release of Spring - version 3.0, it was quite clear to us that we had to focus on making the development of ‘RESTful’ Web services and applications easier. Now, what is and isn’t ‘RESTful’ could be the topic of a whole new post all together; in this post I’ll take a more practical approach, and focus on the features that we added to the @Controller model of Spring MVC.&lt;br&gt;&lt;/p&gt;
" />
<meta name="twitter:creator" content="@poutsma" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/783fefe566e832976f50aacb1b8fd949?s=200" />

<meta property="og:title" content="REST in Spring 3: @MVC" />
<meta property="og:image" content="https://gravatar.com/avatar/783fefe566e832976f50aacb1b8fd949?s=200" />
<meta property="og:description" content="&lt;p&gt;In the last couple of years, REST has emerged as a compelling alternative to SOAP/WSDL/WS-*-based distributed architectures. So when we started to plan our work on the next major release of Spring - version 3.0, it was quite clear to us that we had to focus on making the development of ‘RESTful’ Web services and applications easier. Now, what is and isn’t ‘RESTful’ could be the topic of a whole new post all together; in this post I’ll take a more practical approach, and focus on the features that we added to the @Controller model of Spring MVC.&lt;br&gt;&lt;/p&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2009-03-08 22:20:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">REST in Spring 3: @MVC</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/783fefe566e832976f50aacb1b8fd949?s=20&amp;d=mm" />
<a class="author" rel="author" href="/team/apoutsma">Arjen Poutsma</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2009-03-08 22:20:00.0">March 08, 2009</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="202" href="/blog/2009/03/08/rest-in-spring-3-mvc#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><p>In the last couple of years, REST has emerged as a compelling alternative to SOAP/WSDL/WS-*-based distributed architectures. So when we started to plan our work on the next major release of Spring - version 3.0, it was quite clear to us that we had to focus on making the development of &lsquo;RESTful&rsquo; Web services and applications easier. Now, what is and isn&rsquo;t &lsquo;RESTful&rsquo; could be the topic of a whole new post all together; in this post I&rsquo;ll take a more practical approach, and focus on the features that we added to the @Controller model of Spring MVC.<br /><h2>A Bit of Background</h2><br /><em>Ok, I lied: there is some background first. If you really want to learn about the new features, feel free to skip to the <a href="#features">next section</a>.</em></p><p>For me, work on REST started about two years ago, shortly after reading the highly recommended book <a href="https://oreilly.com/catalog/9780596529260/index.html">RESTful Web Services</a> from O&rsquo;Reilly, by Leonard Richardson and Sam Ruby. Initially, I was thinking about adding REST support to <a href="http://www.springsource.org/spring-ws">Spring Web Services</a>, but after working a couple of weeks on a prototype, it became clear to me that this wasn&rsquo;t a very good fit. In particular, I found out that I had to copy most of the logic from the Spring-MVC <tt>DispatcherServlet</tt> over to Spring-WS. Clearly, this was not the way to go forward.</p><p>Around the same time we introduced the <a href="http://blog.springsource.com/2007/11/14/annotated-web-mvc-controllers-in-spring-25/">annotation-based model of Spring MVC</a>. This model was clearly an improvement to the former, inheritance-based model. Another interesting development at that time was the development of the <a href="https://jcp.org/en/jsr/detail?id=311">JAX-RS</a> specification. My next attempt was to try and merge these two models: to try and combine the @MVC annotations with the JAX-RS annotations, and to be able to run JAX-RS applications within the <tt>DispatcherServlet</tt>. While I did get a working prototype out of this effort, the result was not satisfactory. There were a number of technical issues which I won&rsquo;t bore you with, but most importantly the approach felt &lsquo;clunky&rsquo; and unnatural for a developer who was already used to Spring MVC 2.5.</p><p>Finally, we decided to add the RESTful functionality to features to Spring MVC itself. Obviously, that would mean that there would be some overlap with JAX-RS, but at least the programming model would be satisfactory for Spring MVC developers, both existing and new ones. Additionally, there are already three JAX-RS implementations offering Spring support (<a href="https://jersey.dev.java.net/">Jersey</a>, <a href="http://www.jboss.org/resteasy/">RESTEasy</a>, and <a href="http://www.restlet.org/">Restlet</a>). Adding a fourth to this list did not seem a good use of our valuable time.<br /><h2><a name="features">RESTful features in Spring MVC 3.0</a></h2><br />Now, enough of the background, let&rsquo;s look at the features!<br /><h3>URI Templates</h3><br />A URI template is a URI-like string, containing one or more variable names. When these variables are substituted for values, the template becomes a URI. For more information, see the <a href="http://bitworking.org/projects/URI-Templates/">proposed RFC</a>.</p><p>In Spring 3.0 M1, we introduced the use of URI templates through the <tt>@PathVariable</tt> annotation. For instance:</p>
<pre><code class="prettyprint java"><br />@RequestMapping(&quot;/hotels/{hotelId}&quot;)
public String getHotel(@PathVariable String hotelId, Model model) {
    List&lt;Hotel&gt; hotels = hotelService.getHotels();
    model.addAttribute(&quot;hotels&quot;, hotels);
    return &quot;hotels&quot;;
}
</code></pre><p>When a request comes in for <tt>/hotels/1</tt>, that 1 will be bound to the <tt>hotelId</tt> parameter. You can optionally specify the variable name the parameter is bound to, but when you compile your code with debugging enabled that is not necessary: we infer the path variable name from the parameter name.</p><p>You can also have more than one path variable, like so:</p>
<pre><code class="prettyprint java"><br />@RequestMapping(value=&quot;/hotels/{hotel}/bookings/{booking}&quot;, method=RequestMethod.GET)
public String getBooking(@PathVariable(&quot;hotel&quot;) long hotelId, @PathVariable(&quot;booking&quot;) long bookingId, Model model) {
    Hotel hotel = hotelService.getHotel(hotelId);
    Booking booking = hotel.getBooking(bookingId);
    model.addAttribute(&quot;booking&quot;, booking);
    return &quot;booking&quot;;
}
</code></pre><p>This would match requests like <tt>/hotels/1/bookings/2</tt>, for instance.</p><p>You can also combine the use of Ant-style paths and path variables, like so:</p>
<pre><code class="prettyprint java"><br />@RequestMapping(value=&quot;/hotels/*/bookings/{booking}&quot;, method=RequestMethod.GET)
public String getBooking(@PathVariable(&quot;booking&quot;) long bookingId, Model model) {
    ...
}
</code></pre><p>and you can use data binding, too:</p>
<pre><code class="prettyprint java"><br />@InitBinder
public void initBinder(WebDataBinder binder) {
    SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);
    binder.registerCustomEditor(Date.class, new CustomDateEditor(dateFormat, false));
}

@RequestMapping(&quot;/hotels/{hotel}/dates/{date}&quot;)
public void date(@PathVariable(&quot;hotel&quot;) String hotel, @PathVariable Date date) {
    ...
}
</code></pre><p>The above would match <tt>/hotels/1/dates/2008-12-18</tt>, for instance.<br /><h3>Content Negotiation</h3><br />In version 2.5, Spring-MVC lets the @Controller decide which view to render for a given request, through its <tt>View</tt>, view name, and <tt>ViewResolver</tt> abstractions. In a RESTful scenario, it is common to let the client decide the acceptable representations, via the <tt>Accept</tt> HTTP header. The server responds with the delivered representation via the <tt>Content-Type</tt> header. This process is known as <a href="https://en.wikipedia.org/wiki/Content_negotiation">content negotiation</a>.</p><p>One issue with the <tt>Accept</tt> header is that is impossible to change it in a web browser, in HTML. For instance, in Firefox, it&rsquo;s fixed to<br /><code><br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br /></code><br />So what if you want to link to a PDF version of a particular resource? Looking at the file extension is a good workaround. For example, <tt><a href="http://example.com/hotels.pdf">http://example.com/hotels.pdf</a></tt> retrieves the PDF view of the hotel list, as does <tt><a href="http://example.com/hotels">http://example.com/hotels</a></tt> with an Accept header of <tt>application/pdf</tt>.</p><p>This is what the <tt>ContentNegotiatingViewResolver</tt> does: it wraps one or more other <tt>ViewResolver</tt>s, looks at the <tt>Accept</tt> header or file extension, and resolves a view corresponding to these. In an upcoming blog post, Alef Arendsen will show you how to use the <tt>ContentNegotiatingViewResolver</tt>.<br /><h3>Views</h3><br />We also added some new Views to Spring MVC, particularly:<br /><ul><br /> <li>the <a href="http://static.springsource.org/spring/docs/3.0.0.M1/javadoc-api/org/springframework/web/servlet/view/feed/AbstractAtomFeedView.html"><tt>AbstractAtomFeedView</tt></a> and <a href="http://static.springsource.org/spring/docs/3.0.0.M1/javadoc-api/org/springframework/web/servlet/view/feed/AbstractRssFeedView.html"><tt>AbstractRssFeedView</tt></a>, which can be used to return an Atom and RSS feed,</li><br /> <li>the <a href="http://static.springframework.org/spring/docs/3.0.0.M2/javadoc-api/org/springframework/web/servlet/view/xml/MarshallingView.html"><tt>MarshallingView</tt></a>, which can be used to return an XML representation. This view is based on the Object/XML Mapping module, which has been copied from the Spring Web Services project. This module wraps XML marshalling technologies such as JAXB, Castor, JiBX, and more, and makes it easier to configure these within a Spring application context,</li><br /> <li>the <tt>JacksonJsonView</tt>, for JSON representations of objects in your model. This view is actually part of the Spring JavaScript project, which we&rsquo;ll talk about more in a future blog post.</li><br /></ul><br />Obviously, these work great in combination with the <tt>ContentNegotiatingViewResolver</tt>!<br /><h3>HTTP Method Conversion</h3><br />Another key principle of REST is the use of the Uniform Interface. Basically, this means that all resources (URLs) can be manipulated using the same four HTTP method: GET, PUT, POST, and DELETE. For each of methods, the HTTP specification defines exact semantics. For instance, a GET should always be a safe operation, meaning that is has no side effects, and a PUT or DELETE should be idempotent, meaning that you can repeat these operations over and over again, but the end result should be the same.</p><p>While HTTP defines these four methods, HTML only supports two: GET and POST. Fortunately, there are two possible workarounds: you can either use JavaScript to do your PUT or DELETE, or simply do a POST with the &lsquo;real&rsquo; method as an additional parameter (modeled as a hidden input field in an HTML form). This latter trick is what the <tt>HiddenHttpMethodFilter</tt> does. This filter was introduced in Spring 3.0 M1, and is a plain Servlet Filter. As such, it can be used in combination with any web framework (not just Spring MVC). Simply add this filter to your <tt>web.xml</tt>, and a POST with a hidden <tt>_method</tt> parameter will be converted into the corresponding HTTP method request.</p><p>As an extra bonus, we&rsquo;ve also added support for method conversion in the Spring MVC form tags. For example, the following snippet taken from the updated Petclinic sample:</p>
<pre><code class="prettyprint html"><br />&lt;form:form method=&quot;delete&quot;&gt;
    &lt;p class=&quot;submit&quot;&gt;&lt;input type=&quot;submit&quot; value=&quot;Delete Pet&quot;/&gt;&lt;/p&gt;
&lt;/form:form&gt;
</code></pre><p>will actually perform an HTTP POST, with the &lsquo;real&rsquo; DELETE method hidden behind a request parameter, to be picked up by the <tt>HiddenHttpMethodFilter</tt>. The corresponding @Controller method is therefore:</p>
<pre><code class="prettyprint java"><br />@RequestMapping(method = RequestMethod.DELETE)
public String deletePet(@PathVariable int ownerId, @PathVariable int petId) {
    this.clinic.deletePet(petId);
    return &quot;redirect:/owners/&quot; + ownerId;
}
</code></pre>
<h3>ETag support</h3><p>An <a href="https://en.wikipedia.org/wiki/HTTP_ETag">ETag</a> (entity tag) is an HTTP response header returned by an HTTP/1.1 compliant web server used to determine change in content at a given URL. It can be considered to be the more sophisticated successor to the <tt>Last-Modified</tt> header. When a server returns a representation with an ETag header, client can use this header in subsequent GETs, in a <tt>If-None-Match</tt> header. If the content has not changed, the server will return <tt>304: Not Modified</tt>.</p><p>In Spring 3.0 M1, we introduced the <tt>ShallowEtagHeaderFilter</tt>. This is a plain Servlet Filter, and thus can be used in combination any web framework. As the name indicates, the filter creates so-called <em>shallow</em> ETags (as opposed to a deep ETags, more about that later). The way it works is quite simple: the filter simply caches the content of the rendered JSP (or other content), generates a MD5 hash over that, and returns that as a <tt>ETag</tt> header in the response. The next time a client sends a request for the same resource, it use that hash as the <tt>If-None-Match</tt> value. The filter notices this, renders the view again, and compares the two hashes. If they are equal, a 304 is returned. It is important to note that this filter will not save processing power, as the view is still rendered. The only thing it saves is <strong>bandwith</strong>, as the rendered response is not sent back over the wire.</p><p><em>Deep</em> ETags are a bit more complicated. In this case, the ETag is based on the underlying domain objects, RDMBS tables, etc. Using this approach, no content is generated unless the underlying data has changed. Unfortunately, implementing this approach in a generic way is much more difficult than shallow ETags. We might add support for deep ETags in a later version of Spring, by relying on JPA&rsquo;s @Version annotation, or an AspectJ aspect for instance.<br /><h2>And more!</h2><br />In a following post, I will conclude my RESTful journey, and talk about the <tt>RestTemplate</tt>, which was also introduced in Spring 3.0 M2. This class gives you client-side access to RESTful resources in a fashion similar to the <tt>JdbcTemplate</tt>, <tt>JmsTemplate</tt>, etc.</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 202;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
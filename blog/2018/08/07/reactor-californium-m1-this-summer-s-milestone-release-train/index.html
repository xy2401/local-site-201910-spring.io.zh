<html  data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>反应堆Californium-M1，今年夏天的里程碑发布列车</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="Reactor Californium-M1, this summer's Milestone release train">
<meta name="twitter:description" >
<meta name="twitter:creator" content="@simonbasle">
<meta name="twitter:image:src" content="https://gravatar.com/avatar/056097e00486bcdf172708607f194b1e?s=200">

<meta property="og:title" content="Reactor Californium-M1, this summer's Milestone release train">
<meta property="og:image" content="https://gravatar.com/avatar/056097e00486bcdf172708607f194b1e?s=200">
<meta class="anchor" name="californium-m1-bom" property="og:description" content="<p>On behalf of the Reactor team, I have the pleasure of announcing the newest Reactor milestone, <code>Californium-M1</code> 🚢 🚂</p>
<p>The team has been busy working on <code>Californium</code>, the third major installment of Reactor 3. We are now ready for your feedback on a few select issues, and we have a lot of enhancements and bug fixes ready for your consumption as well.</p>
<h1><a href=" #californium-m1-bo="=">Californium-M1 BOM
<p>For its third release train, we continue on the theme of alphabetically increasing names on the periodic table of elements. Californium is an element first synthesized in California.</p>
">
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2018-08-07 09:08:00.0">



<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">专案</a>
</li>
<li class="navbar-link">
<a href="/guides">导游</a>
</li>
<li class="navbar-link active">
<a href="/blog">博客</a>
</li>
<li class="navbar-link">
<a href="/services">培训与认证</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索文档，指南和帖子..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">家<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">专案<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">导游<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">博客<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">培训与认证<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>工程</div>
</div>
<div class="blog-category content--title">
<div>发布</div>
</div>
<div class="blog-category content--title">
<div>新闻与活动</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">反应堆Californium-M1，今年夏天的里程碑发布列车</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">工程</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/056097e00486bcdf172708607f194b1e?s=20&d=mm"> <a class="author" rel="author" href="/team/simonbasle">西蒙·巴斯莱（SimonBaslé）</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2018-08-07 09:08:00.0">2018年8月7日</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2018/08/07/reactor-californium-m1-this-summer-s-milestone-release-train#disqus_thread" data-disqus-identifier="3297">
</a></div>
</div>
</header>
<div class="blog--post"><p>我很荣幸代表Reactor小组宣布Reactor的最新里程碑， <code>Californium-M1</code> 🚂</p>
<p>团队一直在忙于<code>Californium</code> ，这是Reactor 3的第三大部分。现在，我们已准备好就一些特定问题向您提供反馈，并且我们还为您提供了许多增强功能和错误修复程序。</p><h1><a href="#californium-m1-bom" class="anchor" name="californium-m1-bom"></a> for-M1 BOM</h1>
<p>对于第三次发布，我们继续以元素周期表中按字母顺序递增的名称为主题。for是最早在加利福尼亚合成的元素。</p>
<p>里程碑的物料清单包含：</p>
<ul>
<li><code>reactor-core</code> <code>3.2.0.M3</code></li>
<li><code>reactor-extra</code><code>3.2.0.M1</code> （有一些API对齐更改）</li>
<li><code>reactor-netty</code> <code>0.8.0.M1</code></li>
</ul>
<p>今年年初（M1），有一个早期的预览<code>reactor-core</code>它只专注于“错误模式继续”功能，Core还在6月发布了非火车里程碑发布（M2）。除了新的M3中的内容外，此博客文章还介绍了后者的变化。</p><h1><a href="#reactor-netty-0-8-0-m1" class="anchor" name="reactor-netty-0-8-0-m1"></a>反应堆净值0.8.0。M1</h1>
<p>这里的重量级人物是<a href="https://github.com/reactor/reactor-netty/releases/tag/v0.8.0.M1"><code>reactor-netty</code></a> 。期望获得更完整的博客文章，其中详细介绍了API更改和新功能背后的原理，其中包括：</p><h3><a href="#api-revamp" class="anchor" name="api-revamp"></a> API改造</h3>
<p>该团队对API进行了重大改进，从而在构建客户端和服务器时提供了更多指导，从而避免了在0.7.x行中太容易造成的无法忍受的配置错误。</p>
<p>新API还更清楚地概述了生命周期。</p><h3><a href="#http2-support" class="anchor" name="http2-support"></a> HTTP2支持</h3>
<p>是的，HTTP2 <strong>支持</strong> 👍目前，它主要是透明地升级到HTTP2，但是我们正在努力在不久的将来添加HTTP2个人流作为一等公民。</p><h1><a href="#reactor-core-3-2-0" class="anchor" name="reactor-core-3-2-0"></a>反应堆核心3.2.0</h1>
<p>与以前的Bismuth迭代相比，M2和M3总共带来了70多个更改。</p>
<p>反应堆核心中的API更改少于反应堆网络中的API更改，并且更新注意事项主要是有关里程碑本身之间的差异。有关更多详细信息，请参见<a href="https://github.com/reactor/reactor-core/releases/tag/v3.2.0.M2">M2</a>和<a href="https://github.com/reactor/reactor-core/releases/tag/v3.2.0.M3">M3</a>的“更新注意事项”部分。</p>
<p>对于以下功能，我们最需要您的反馈：</p><h3><a href="#metrics" class="anchor" name="metrics"></a>指标</h3>
<p>千分尺和<code>.metrics()</code>支持（ <a href="https://github.com/reactor/reactor-core/issues/1183">＃1183</a> ， <a href="https://github.com/reactor/reactor-core/issues/1123">＃1123</a> ）已添加。新的<code>.metrics()</code>运算符仅在以下情况下才执行某些操作<code>Micrometer</code>在类路径上。</p>
<p>它记录指标<code>onNext</code>时序，订阅到完成时序，信号计数等–所有这些都是从直接上游运营商产生的信号的角度出发的。</p>
<p>它是在M2中引入的，但是在M3中得到了改进，并且某些标签名称也发生了（更改）更改（ <a href="https://github.com/reactor/reactor-core/pull/1245">＃1245</a> ）。</p>
<p>请注意，一个重要的目标是避免在公共Reactor API中公开Micrometer内容。我们不想对Micrometer具有强制性的依赖关系，并且我们力争仅在我们在类路径上检测到它时才将其用法包含在内部类中。</p>
<blockquote>
<p><strong>接下来</strong> ：<br>在通用Analytics（分析）之前，还应该有针对<code>Schedulers</code> （或者说<code>ExecutorServices</code>那回一些<code>Schedulers</code> ）。我们也在寻找一种选择特定方法的方法<code>MeterRegistry</code>再次在全球范围内针对Reactor，而无需公开引用该API的公共API <code>MeterRegistry</code>接口。</p>
</blockquote><h3><a href="#advanced-retry" class="anchor" name="advanced-retry"></a>高级重试</h3>
<p>我们为<code>retryWhen</code>指数回退和抖动（ <code>retryBackoff()</code> 。参见<a href="https://github.com/reactor/reactor-core/issues/1122">＃1122</a> ）。</p>
<p>此版本的重试反映了我们认为重试方面的行业最佳实践。这是太简单之间的良好中间立场<code>retry(n)</code> ，复杂<code>retryWhen(Function)</code>以及更多可配置的<code>RetryFunction</code>从<code>reactor-addons</code> 。</p><h3><a href="#resource-based-reactive-closures" class="anchor" name="resource-based-reactive-closures"></a>基于资源的反应式关闭</h3>
<p>为了帮助您建立反应性交易块，我们添加了<a href="https://github.com/reactor/reactor-core/issues/1220"><code>usingWhen</code></a> 。喜欢<code>using</code> ，它包装资源，生成一个<code>Flux</code>并确保在Flux终止时正确清理了资源。</p>
<p>主要区别在于：</p>
<ul>
<li>该资源是通过以下方式异步提供的： <code>Publisher</code> 。</li>
<li>清理也是异步的（ <code>Function<Resource, Publisher></code> ），并且仅延迟终端信号的传播，而不延迟onNext信号。</li>
<li>操作员可以进行单独的异步“清除”，以完成，错误和取消终止。</li>
</ul>
<p>它在M2中引入，但在M3中稍作更改以修复<code>Context</code>传播并支持取消<code>Publisher<Resource></code> 。通过取消主<code>Flux<T></code>此运算符<strong>在</strong>返回<strong>之前</strong> <code>Resource</code>甚至发出，您的取消指令就会传播到<code>Publisher<Resource></code> 。</p><h3><a href="#code-ondiscard-code-hook" class="anchor" name="code-ondiscard-code-hook"></a><code>onDiscard</code>钩</h3>
<p>这个全局挂钩，形式为<code>Consumer<Object></code> ，这是高级用户处理需要特殊清除的堆外对象的最后一个缺少的部分。</p>
<p>通常，Netty的<code>ByteBuf</code>或春季5 <code>DataBuffer</code>可以归为此类：它们是集中存储的，需要堆<code>release()</code>不使用它们时请致电，以免发生内存泄漏。</p>
<p>这些元素可能会落入反应性序列的缝隙之间，并且在以下三种情况下永远不会到达用户代码：</p>
<ol>
<li>操作员的来源格式不正确，不符合RS规范（例如，它发出一个<code>ByteBuf</code>已经发出信号<em>后，</em> <code>onComplete</code> ）。</li>
<li>操作员过滤某些元素作为其语义的一部分（例如<code>filter</code> ）。</li>
<li>操作员为了进行反压优化而进行预取，并被取消，并丢弃其预取队列。</li>
</ol>
<p>案例（1）已被<code>onNextDropped</code>勾子，但情况（3）绝对不是。<br>情况（2）（过滤器语义）在中间，有可能在过滤器<em>内部</em>进行清理<code>Predicate</code> ， 例如。但这很麻烦，容易被遗忘。</p>
<p>所以我们添加了<code>onDiscard</code>到我们的曲目<code>Hooks</code>覆盖（2）和（3）。请注意，与“继续出错”功能不同，目前，尚无公共API在特定的<code>Flux</code>实例。有一个不受支持的解决方法<code>Context</code> ，并且正式的API可能会出现在Google Analytics（分析）或更高版本的维护版本中。</p>
<p>的<code>onDiscard</code>挂钩具有以下<strong>特点和要求</strong> ：</p>
<ul>
<li>它是累加的，表示调用<code>Hooks.onDiscard(Consumer)</code>两次将使用<code>Consumer#andThen</code> 。</li>
<li>它没有键控，这意味着虽然多个呼叫是加性的，但只能完全重置（不能在每次<code>Consumer</code>基础）。</li>
<li>的<code>Consumer</code>必须执行<code>instanceof</code>在投放之前进行检查，因为它将与不同类型的对象一起使用。</li>
<li>的<code>Consumer</code>不得抛出异常，并且应包含<code>try catch</code>根据需要阻止。</li>
<li>的<code>Consumer</code>必须是幂等的，因为它可能在同一实例上多次调用（例如，在缓冲区重叠的情况下）。</li>
</ul>
<p>附带一提， <code>errorStrategyContinue()</code> <strong>已在M3中重命名为<code>onErrorContinue()</code></strong> 。</p><h1><a href="#reactor-extra-3-2-0-m1" class="anchor" name="reactor-extra-3-2-0-m1"></a> Reactor Extra 3.2.0。M1</h1>
<p>最后， <code>reactor-extra</code>在重试/重复使用方面，API进行了更小的更改。它与<code>core</code>运算符，使用相同的默认值和<code>Long</code>而不是<code>Integer</code>索引。</p><h1><a href="#next-steps" class="anchor" name="next-steps"></a>下一步</h1>
<p>下一步<code>reactor-core</code>是对<code>Processor</code>对象被暴露。目前<code>FluxProcessor<IN, OUT></code>有点肿，因为它扩展并暴露了整个<code>Flux</code> API。</p>
<p>此外， <code>FluxProcessor#sink()</code>和相关<code>FluxSink</code>太容易被滥用，尤其是当一个人试图同时订阅一个<code>Processor</code>到<code>Publisher</code>源并通过<code>sink()</code> ，目前尚未真正支持。<br>事实<code>sink()</code>应该被调用一次并返回<code>FluxSink<T></code>实例应该重用也不是很清楚。</p>
<p>所以我们正在寻找一个立面<code>Processor<T, T></code>直接实现<code>FluxSink</code> （代替<code>Flux</code> ），当同时用作订户和接收器并具有<code>asFlux()</code>查看方法以<em>选择性地</em>建立一个<code>Flux</code>最重要的是运算符。</p>
<p><code>MonoProcessor</code>这些步骤可能会变成一个（简单的）接口，并将具体实现重命名为<code>MonoNextProcessor</code> 。我们还希望提供一种独立的<code>MonoSink</code>用户无需使用即可直接操作<code>Mono.create()</code> 。</p><h1><a href="#conclusion" class="anchor" name="conclusion"></a>结论</h1>
<p>很棒的人不用等待GA发布！继续努力，迈向这个闪亮的里程碑，并且一如既往地欢迎反馈。 :)</p>
<p>快乐的反应式编码！</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 3297;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>请启用JavaScript以查看<a href="http://disqus.com/?ref_noscript">由Disqus提供</a>的<a href="http://disqus.com/?ref_noscript">评论。</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">由<span class="logo-disqus">Disqus</span>提供动力的评论</a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>背部</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">所有帖子</a> <a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">工程</a> <a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">发布</a> <a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">新闻与活动</a> <a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>将The Spring Team的更新发送到您的收件箱</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">球队</a></li>
<li><a href="/tools">工具类</a></li>
<li><a href="https://store.pivotal.io/">商店</a></li>
<li><a href="/blog">通讯</a></li>
</ul>
</div>
</div>© <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a> ，Inc.保留所有权利。
<a href="https://pivotal.io/terms-of-use">使用条款</a> • <a href="https://pivotal.io/privacy-policy">隐私</a> • <a href="/trademarks">商标准则</a>
<div id="teconsent" style="display:inline-block"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
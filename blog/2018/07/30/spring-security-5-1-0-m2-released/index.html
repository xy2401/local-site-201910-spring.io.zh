<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>Spring Security 5.1.0.M2 Released</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="Spring Security 5.1.0.M2 Released" />
<meta name="twitter:description" content="&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;On behalf of the community I am pleased to announce the release of Spring Security 5.1.0.M2. This release comes with &lt;a href=&quot;https://github.com/spring-projects/spring-security/milestone/106&quot;&gt;100+ tickets&lt;/a&gt; closed.&lt;/p&gt; 
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;As always we look forward to hearing your &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues&quot;&gt;feedback&lt;/a&gt;! You can find the highlights below:&lt;/p&gt; 
&lt;/div&gt;
&lt;h1 id=&quot;oauth2&quot; class=&quot;sect0&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#oauth2&quot;&gt;&lt;/a&gt;OAuth2&lt;/h1&gt;
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;oauth2-resource-server&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#oauth2-resource-server&quot;&gt;&lt;/a&gt;OAuth2 Resource Server&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Basic support for OAuth2 Resource Servers has been added. See &lt;a href=&quot;https://github.com/spring-projects/spring-security/tree/5.1.0.M2/samples/boot/oauth2resourceserver&quot;&gt;oauth2resourceserver&lt;/a&gt;&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;authorization-code-flow&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#authorization-code-flow&quot;&gt;&lt;/a&gt;Authorization Code Flow&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;User’s can now obtain an access token using the OAuth 2.0 Authorization Code grant. See the &lt;a href=&quot;https://github.com/spring-projects/spring-security/tree/5.1.0.M2/samples/boot/authcodegrant&quot;&gt;authcodegrant&lt;/a&gt; sample.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;webclient-and-oauth2-support&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#webclient-and-oauth2-support&quot;&gt;&lt;/a&gt;WebClient and OAuth2 Support&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;There is now built in support for OAuth2 and WebClient support. The support allows:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;Adding the access token to the request&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;Automatic refreshing of the access token when it expires&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;Resolving the access token to use&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;For example, in a Servlet environment you can configure a Bean like this:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;prettyprint highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;@Bean
WebClient webClient(OAuth2AuthorizedClientRepository repository) {
    ServletOAuth2AuthorizedClientExchangeFilterFunction filter =
        new ServletOAuth2AuthorizedClientExchangeFilterFunction(repository);
    return WebClient.builder()
        .filter(new OAuth2AuthorizedClientExchangeFilterFunction())
        .apply(filter.oauth2Configuration())
        .build();
 }&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Now you can add the OAuth token in a number of different ways. If you want you can resolve the &lt;code&gt;OAuth2AuthorizedClient&lt;/code&gt; using the Spring MVC support. If the authorization server returned a refresh token and the access token is about to expire, Spring Security will transparently update the access token and submit the updated access token instead.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;prettyprint highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;@GetMapping(&quot;/users&quot;)
Mono&amp;lt;String&amp;gt; users(@RegisteredOAuth2AuthorizedClient(&quot;client-id&quot;)
        OAuth2AuthorizedClient authorizedClient) {
    return this.webClient.get()
        .uri(&quot;https://api.example.com/user&quot;)
        .attributes(oauth2AuthorizedClient(authorizedClient))
        .retrieve()
        .bodyToMono(String.class);
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;You can also resolve the access token through the &lt;code&gt;WebClient&lt;/code&gt;. Fore example:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;prettyprint highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;Mono&amp;lt;String&amp;gt; users() {
    return this.webClient.get()
        .uri(&quot;https://api.example.com/user&quot;)
        .attributes(clientRegistrationId(&quot;client-id&quot;))
        .retrieve()
        .bodyToMono(String.class);
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;If you authenticated using OAuth2 Log In or OIDC, then a default access token can be applied with no user interaction.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;prettyprint highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;Mono&amp;lt;String&amp;gt; users() {
    // if Authenticated with OIDC
    // OAuth2 Log In use the access token associated to log in
    return this.webClient.get()
        .uri(&quot;https://api.example.com/user&quot;)
        .retrieve()
        .bodyToMono(String.class);
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
" />
<meta name="twitter:creator" content="@rob_winch" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/30ed046efb35c67d4c055dab109b8933?s=200" />

<meta property="og:title" content="Spring Security 5.1.0.M2 Released" />
<meta property="og:image" content="https://gravatar.com/avatar/30ed046efb35c67d4c055dab109b8933?s=200" />
<meta property="og:description" content="&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;On behalf of the community I am pleased to announce the release of Spring Security 5.1.0.M2. This release comes with &lt;a href=&quot;https://github.com/spring-projects/spring-security/milestone/106&quot;&gt;100+ tickets&lt;/a&gt; closed.&lt;/p&gt; 
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;As always we look forward to hearing your &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues&quot;&gt;feedback&lt;/a&gt;! You can find the highlights below:&lt;/p&gt; 
&lt;/div&gt;
&lt;h1 id=&quot;oauth2&quot; class=&quot;sect0&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#oauth2&quot;&gt;&lt;/a&gt;OAuth2&lt;/h1&gt;
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;oauth2-resource-server&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#oauth2-resource-server&quot;&gt;&lt;/a&gt;OAuth2 Resource Server&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Basic support for OAuth2 Resource Servers has been added. See &lt;a href=&quot;https://github.com/spring-projects/spring-security/tree/5.1.0.M2/samples/boot/oauth2resourceserver&quot;&gt;oauth2resourceserver&lt;/a&gt;&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;authorization-code-flow&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#authorization-code-flow&quot;&gt;&lt;/a&gt;Authorization Code Flow&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;User’s can now obtain an access token using the OAuth 2.0 Authorization Code grant. See the &lt;a href=&quot;https://github.com/spring-projects/spring-security/tree/5.1.0.M2/samples/boot/authcodegrant&quot;&gt;authcodegrant&lt;/a&gt; sample.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;webclient-and-oauth2-support&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#webclient-and-oauth2-support&quot;&gt;&lt;/a&gt;WebClient and OAuth2 Support&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;There is now built in support for OAuth2 and WebClient support. The support allows:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;Adding the access token to the request&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;Automatic refreshing of the access token when it expires&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;Resolving the access token to use&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;For example, in a Servlet environment you can configure a Bean like this:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;prettyprint highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;@Bean
WebClient webClient(OAuth2AuthorizedClientRepository repository) {
    ServletOAuth2AuthorizedClientExchangeFilterFunction filter =
        new ServletOAuth2AuthorizedClientExchangeFilterFunction(repository);
    return WebClient.builder()
        .filter(new OAuth2AuthorizedClientExchangeFilterFunction())
        .apply(filter.oauth2Configuration())
        .build();
 }&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Now you can add the OAuth token in a number of different ways. If you want you can resolve the &lt;code&gt;OAuth2AuthorizedClient&lt;/code&gt; using the Spring MVC support. If the authorization server returned a refresh token and the access token is about to expire, Spring Security will transparently update the access token and submit the updated access token instead.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;prettyprint highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;@GetMapping(&quot;/users&quot;)
Mono&amp;lt;String&amp;gt; users(@RegisteredOAuth2AuthorizedClient(&quot;client-id&quot;)
        OAuth2AuthorizedClient authorizedClient) {
    return this.webClient.get()
        .uri(&quot;https://api.example.com/user&quot;)
        .attributes(oauth2AuthorizedClient(authorizedClient))
        .retrieve()
        .bodyToMono(String.class);
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;You can also resolve the access token through the &lt;code&gt;WebClient&lt;/code&gt;. Fore example:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;prettyprint highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;Mono&amp;lt;String&amp;gt; users() {
    return this.webClient.get()
        .uri(&quot;https://api.example.com/user&quot;)
        .attributes(clientRegistrationId(&quot;client-id&quot;))
        .retrieve()
        .bodyToMono(String.class);
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;If you authenticated using OAuth2 Log In or OIDC, then a default access token can be applied with no user interaction.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;prettyprint highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;Mono&amp;lt;String&amp;gt; users() {
    // if Authenticated with OIDC
    // OAuth2 Log In use the access token associated to log in
    return this.webClient.get()
        .uri(&quot;https://api.example.com/user&quot;)
        .retrieve()
        .bodyToMono(String.class);
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2018-07-30 12:44:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category content--title">
<div>Engineering</div>
</div>
<div class="blog-category active content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Spring Security 5.1.0.M2 Released</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon releases"></div>
<a class="category">Releases</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/30ed046efb35c67d4c055dab109b8933?s=20&amp;d=mm" />
<a class="author" rel="author" href="/team/rwinch">Rob Winch</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2018-07-30 12:44:00.0">July 30, 2018</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="3342" href="/blog/2018/07/30/spring-security-5-1-0-m2-released#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><div class="paragraph">
<p>On behalf of the community I am pleased to announce the release of Spring Security 5.1.0.M2. This release comes with <a href="https://github.com/spring-projects/spring-security/milestone/106">100+ tickets</a> closed.</p>
</div>
<div class="paragraph">
<p>As always we look forward to hearing your <a href="https://github.com/spring-projects/spring-security/issues">feedback</a>! You can find the highlights below:</p>
</div>
<h1 id="oauth2" class="sect0"><a class="anchor" href="#oauth2"></a>OAuth2</h1>
<div class="sect1">
<h2 id="oauth2-resource-server"><a class="anchor" href="#oauth2-resource-server"></a>OAuth2 Resource Server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Basic support for OAuth2 Resource Servers has been added.
See <a href="https://github.com/spring-projects/spring-security/tree/5.1.0.M2/samples/boot/oauth2resourceserver">oauth2resourceserver</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="authorization-code-flow"><a class="anchor" href="#authorization-code-flow"></a>Authorization Code Flow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>User&#8217;s can now obtain an access token using the OAuth 2.0 Authorization Code grant.
See the <a href="https://github.com/spring-projects/spring-security/tree/5.1.0.M2/samples/boot/authcodegrant">authcodegrant</a> sample.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="webclient-and-oauth2-support"><a class="anchor" href="#webclient-and-oauth2-support"></a>WebClient and OAuth2 Support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is now built in support for OAuth2 and WebClient support.
The support allows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding the access token to the request</p>
</li>
<li>
<p>Automatic refreshing of the access token when it expires</p>
</li>
<li>
<p>Resolving the access token to use</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, in a Servlet environment you can configure a Bean like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Bean
WebClient webClient(OAuth2AuthorizedClientRepository repository) {
    ServletOAuth2AuthorizedClientExchangeFilterFunction filter =
        new ServletOAuth2AuthorizedClientExchangeFilterFunction(repository);
    return WebClient.builder()
        .filter(new OAuth2AuthorizedClientExchangeFilterFunction())
        .apply(filter.oauth2Configuration())
        .build();
 }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can add the OAuth token in a number of different ways.
If you want you can resolve the <code>OAuth2AuthorizedClient</code> using the Spring MVC support.
If the authorization server returned a refresh token and the access token is about to expire, Spring Security will transparently update the access token and submit the updated access token instead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@GetMapping("/users")
Mono&lt;String&gt; users(@RegisteredOAuth2AuthorizedClient("client-id")
        OAuth2AuthorizedClient authorizedClient) {
    return this.webClient.get()
        .uri("https://api.example.com/user")
        .attributes(oauth2AuthorizedClient(authorizedClient))
        .retrieve()
        .bodyToMono(String.class);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also resolve the access token through the <code>WebClient</code>.
Fore example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Mono&lt;String&gt; users() {
    return this.webClient.get()
        .uri("https://api.example.com/user")
        .attributes(clientRegistrationId("client-id"))
        .retrieve()
        .bodyToMono(String.class);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you authenticated using OAuth2 Log In or OIDC, then a default access token can be applied with no user interaction.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Mono&lt;String&gt; users() {
    // if Authenticated with OIDC
    // OAuth2 Log In use the access token associated to log in
    return this.webClient.get()
        .uri("https://api.example.com/user")
        .retrieve()
        .bodyToMono(String.class);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="webflux-oauth2-log-in-supports-oidc"><a class="anchor" href="#webflux-oauth2-log-in-supports-oidc"></a>WebFlux OAuth2 Log In Supports OIDC</h2>
<div class="sectionbody">
<div class="paragraph">
<p>WebFlux applications can now authenticate with both OAuth2 and OIDC.
See <a href="https://github.com/spring-projects/spring-security/tree/master/samples/boot/oauth2login-webflux">oauth2login-webflux</a> for a sample.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ability-to-create-clientregistration-from-oidc-discovery"><a class="anchor" href="#ability-to-create-clientregistration-from-oidc-discovery"></a>Ability to Create ClientRegistration from OIDC Discovery</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Previously users wanting to integrate with an OIDC provider needed to configure all of the endpoints. For example, in Spring Boot it looked like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-yml" data-lang="yml">spring:
  security:
    oauth2:
      client:
        registration:
          okta:
            client-id: okta-client-id
            client-secret: okta-client-secret
        provider:
          okta:
            authorization-uri: https://foo.oktapreview.com/oauth2/v1/authorize
            token-uri: https://foo.oktapreview.com/oauth2/v1/token
            user-info-uri: https://foo.oktapreview.com/oauth2/v1/userinfo
            user-name-attribute: sub
            jwk-set-uri: https://foo.oktapreview.com/oauth2/v1/keys</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now users can just configure the issuer uri. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-yml" data-lang="yml">spring:
  security:
    oauth2:
      client:
        registration:
          okta:
            client-id: okta-client-id
            client-secret: okta-client-secret
        provider:
          okta:
            issuer-uri: https://foo.oktapreview.com/oauth2/default/</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="support-custom-authorization-requests"><a class="anchor" href="#support-custom-authorization-requests"></a>Support Custom Authorization Requests</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Support for custom authorization requests has been added with the addition of <code>OAuth2AuthorizationRequestResolver</code>.
For example, if a user wants to add/remove scopes from the request they can easily do so now.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="single-clientregistration-now-redirects-on-log-in"><a class="anchor" href="#single-clientregistration-now-redirects-on-log-in"></a>Single ClientRegistration Now Redirects on Log In</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When OAuth2 / OIDC log in is configured with a single provider, rather than displaying only one provider the default has been changed to redirect to the provider immediately.</p>
</div>
</div>
</div>
<h1 id="configuration-improvements" class="sect0"><a class="anchor" href="#configuration-improvements"></a>Configuration Improvements</h1>
<div class="sect1">
<h2 id="modernize-the-default-log-in-page"><a class="anchor" href="#modernize-the-default-log-in-page"></a>Modernize the Default Log In Page</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default log in page has been modernized to html5 to look more visually appealing.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="default-log-out-page"><a class="anchor" href="#default-log-out-page"></a>Default Log Out Page</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since the addition of CSRF log out protection, the default application has no way to log out.
Now if the default log in page is being used (i.e. no log in page has been configured), then there is also a default log out page that presents a log out form.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="simplify-requestcache-configuration"><a class="anchor" href="#simplify-requestcache-configuration"></a>Simplify RequestCache Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>User&#8217;s can now configure the default RequestCache that is used by exposing it as a <code>@Bean</code>.
The <code>HttpSessionRequestCache</code> has been updated to no longer require the value to be a <code>DefaultRequestCache</code>.</p>
</div>
</div>
</div>
<h1 id="hardening-your-application" class="sect0"><a class="anchor" href="#hardening-your-application"></a>Hardening Your Application</h1>
<div class="sect1">
<h2 id="cross-site-tracing-http-verb-tampering-protection"><a class="anchor" href="#cross-site-tracing-http-verb-tampering-protection"></a>Cross Site Tracing &amp; HTTP Verb Tampering Protection</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Security 5.1 adds <a href="https://www.owasp.org/index.php/Cross_Site_Tracing">cross site tracing</a> and <a href="https://www.owasp.org/index.php/Testing_for_HTTP_Verb_Tampering_(OTG-INPVAL-003)">HTTP Verb Tampering</a> protection to Spring Security.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="password-encoding-upgrades"><a class="anchor" href="#password-encoding-upgrades"></a>Password Encoding Upgrades</h2>
<div class="sectionbody">
<div class="paragraph">
<p>User&#8217;s can implement <a href="https://docs.spring.io/spring-security/site/docs/5.1.0.M2/api/org/springframework/security/core/userdetails/UserDetailsPasswordService.html">UserDetailsPasswordService</a> and expose it as a <code>@Bean</code> and on authentication success Spring Security&#8217;s <code>DaoAuthenticationProvider</code> will:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Check to see if the password storage mechanism needs updated using the new <a href="https://docs.spring.io/spring-security/site/docs/5.1.0.M2/api/org/springframework/security/crypto/password/PasswordEncoder.html#upgradeEncoding-java.lang.String-">PasswordEncoder.upgradeEncoding</a> method. For example, if it is encoded in sha256, then by default Spring Security would advise it is upgraded to BCrypt.</p>
</li>
<li>
<p>If the password encoding needs to be upgraded, it will encode the password using the current <code>PasswordEncoder</code></p>
</li>
<li>
<p>The <code>UserDetails</code> and new password will be passed to the <code>UserDetailsPasswordService</code> so it can be saved with the upgraded password encoding.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dependency-updates"><a class="anchor" href="#dependency-updates"></a>Dependency Updates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We have updated our dependencies to be on the latest and greatest to ensure our transitive dependencies are up to date.</p>
</div>
<div class="paragraph">
<p><a href="https://projects.spring.io/spring-security/">Project Site</a> |
<a href="https://docs.spring.io/spring-security/site/docs/5.1.0.M2/reference/htmlsingle/">Reference</a>
| <a href="https://stackoverflow.com/questions/tagged/spring-security">Help</a></p>
</div>
</div>
</div></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 3342;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
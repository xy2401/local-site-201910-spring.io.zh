<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>Introducing Spring Data JDBC</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="Introducing Spring Data JDBC" />
<meta name="twitter:description" content="&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;With the upcoming Lovelace GA release, we’re going to ship a new Spring Data Module: &lt;a href=&quot;https://projects.spring.io/spring-data-jdbc/&quot;&gt;Spring Data JDBC&lt;/a&gt;.&lt;/p&gt; 
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;The idea behind Spring Data JDBC is to provide access to relational databases without submitting to the complexities of JPA. JPA offers such features as lazy loading, caching, and dirty tracking. While these are great if you need them, they can actually make thinking about JPA and its behavior harder than it has to be.&lt;/p&gt; 
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;Lazy loading might trigger expensive statements when you don’t expect it or it might fail with an exception. Caching can get in your way when you actually want to compare two versions of an entity and being dirty makes it hard to find a single point where all persistence operations pass through.&lt;/p&gt; 
&lt;/div&gt;
" />
<meta name="twitter:creator" content="@jensschauder" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/ba8820c248099c27b09232572871ca40?s=200" />

<meta property="og:title" content="Introducing Spring Data JDBC" />
<meta property="og:image" content="https://gravatar.com/avatar/ba8820c248099c27b09232572871ca40?s=200" />
<meta property="og:description" content="&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;With the upcoming Lovelace GA release, we’re going to ship a new Spring Data Module: &lt;a href=&quot;https://projects.spring.io/spring-data-jdbc/&quot;&gt;Spring Data JDBC&lt;/a&gt;.&lt;/p&gt; 
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;The idea behind Spring Data JDBC is to provide access to relational databases without submitting to the complexities of JPA. JPA offers such features as lazy loading, caching, and dirty tracking. While these are great if you need them, they can actually make thinking about JPA and its behavior harder than it has to be.&lt;/p&gt; 
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;Lazy loading might trigger expensive statements when you don’t expect it or it might fail with an exception. Caching can get in your way when you actually want to compare two versions of an entity and being dirty makes it hard to find a single point where all persistence operations pass through.&lt;/p&gt; 
&lt;/div&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2018-09-17 07:34:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Introducing Spring Data JDBC</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/ba8820c248099c27b09232572871ca40?s=20&amp;d=mm" />
<a class="author" rel="author" href="/team/schauder">Jens Schauder</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2018-09-17 07:34:00.0">September 17, 2018</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="3396" href="/blog/2018/09/17/introducing-spring-data-jdbc#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><div class="paragraph">
<p>With the upcoming Lovelace GA release, we&#8217;re going to ship a new Spring Data Module: <a href="https://projects.spring.io/spring-data-jdbc/">Spring Data JDBC</a>.</p>
</div>
<div class="paragraph">
<p>The idea behind Spring Data JDBC is to provide access to relational databases without submitting to the complexities of JPA. JPA offers such features as lazy loading, caching, and dirty tracking. While these are great if you need them, they can actually make thinking about JPA and its behavior harder than it has to be.</p>
</div>
<div class="paragraph">
<p>Lazy loading might trigger expensive statements when you don&#8217;t expect it or it might fail with an exception.
Caching can get in your way when you actually want to compare two versions of an entity and being dirty makes it hard to find a single point where all persistence operations pass through.</p>
</div>
<div class="paragraph">
<p>Spring Data JDBC aims at a much simpler model.
There won&#8217;t be caching, dirty tracking, or lazy loading.
Instead, SQL statements are issued when and only when you invoke a repository method.
The object returned as result of that method is fully loaded before the method returns.
There is no "session" and no proxies for entities.
All this should make Spring Data JDBC easier to reason about.</p>
</div>
<div class="paragraph">
<p>Of course, this simpler approach results in constraints which will be covered in a future post.
Also, it is the first version, so there are many features that we want and plan to implement, but that we had to postpone in order to get something into your hands early.</p>
</div>
<div class="sect1">
<h2 id="let-s-take-a-look-at-a-simple-example"><a class="anchor" href="#let-s-take-a-look-at-a-simple-example"></a>Let&#8217;s take a look at a simple example.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, we need an entity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">class Customer {
    @Id
    Long id;
    String firstName;
    LocalDate dob;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that you don&#8217;t need getters or setters.
It is perfectly okay to use them if you prefer to do so.
Really, the only requirement is that the entity has a property annotated with <code>Id</code> (that is, <code>@org.springframework.data.annotation.Id</code>, not the <code>javax.persistence</code> one).</p>
</div>
<div class="paragraph">
<p>Next, we need to declare a repository.
The easiest way to do that is to extend <code>CrudRepository</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">interface CustomerRepository extends CrudRepository&lt;Customer, Long&gt; {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, we need to configure the <code>ApplicationContext</code> to enable the creation of repositories:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Configuration
@EnableJdbcRepositories <b class="conum">(1)</b>
public class CustomerConfig extends JdbcConfiguration { <b class="conum">(2)</b>

    @Bean
    NamedParameterJdbcOperations operations() { <b class="conum">(3)</b>
        return new NamedParameterJdbcTemplate(dataSource());
    }

    @Bean
    PlatformTransactionManager transactionManager() { <b class="conum">(4)</b>
        return new DataSourceTransactionManager(dataSource());
	}

    @Bean
    DataSource dataSource(){ <b class="conum">(5)</b>
        return new EmbeddedDatabaseBuilder()
                .generateUniqueName(true)
                .setType(EmbeddedDatabaseType.HSQL)
                .addScript("create-customer-schema.sql")
                .build();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s go through the configuration step by step.</p>
</div>
<div class="colist arabic">
<ol>
<li>
<p><code>EnableJdbcRepositories</code> enables the creation of repositories.
Since it requires the presence of some beans, we need the rest of the configuration.</p>
</li>
<li>
<p>Extending <code>JdbcConfiguration</code> adds some default beans to the <code>ApplicationContext</code>.
You can overwrite its methods to customize some of the behavior of Spring Data JDBC.
For now, we go with the default implementations.</p>
</li>
<li>
<p>The really important part is <code>NamedParameterJdbcOperations</code>, which is used internally to submit SQL statements to the database.</p>
</li>
<li>
<p>The transaction manager is, strictly speaking, not necessary.
But you&#8217;d be working without support for transactions that span more than a single statement, and nobody wants that, right?</p>
</li>
<li>
<p>Spring Data JDBC doesn&#8217;t directly use the <code>DataSource</code>, but, since the <code>TransactionManager</code> and the <code>NamedParameterJdbcOperations</code> need it, registering it as a bean is an easy way to ensure both use the same instance.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>That is all you need to get started on working with it.
Now let&#8217;s play with it in a test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@RunWith(SpringRunner.class)
@Transactional
@ContextConfiguration(classes = CustomerConfig.class)
public class CustomerRepositoryTest {

    @Autowired CustomerRepository customerRepo;

    @Test
    public void createSimpleCustomer() {

        Customer customer = new Customer();
        customer.dob = LocalDate.of(1904, 5, 14);
        customer.firstName = "Albert";

        Customer saved = customerRepo.save(customer);

        assertThat(saved.id).isNotNull();

        saved.firstName = "Hans Albert";

        customerRepo.save(saved);

        Optional&lt;Customer&gt; reloaded = customerRepo.findById(saved.id);

        assertThat(reloaded).isNotEmpty();

        assertThat(reloaded.get().firstName).isEqualTo("Hans Albert");
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="code-query-code-annotation"><a class="anchor" href="#code-query-code-annotation"></a><code>@Query</code> annotation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You probably won&#8217;t get far with just the basic CRUD methods from the <code>CrudRepository</code>.
We decided to postpone query derivation, the popular feature where Spring Data derives the query to use from a method name, to a later version.
Until that arrives you can use a simple <code>@Query</code> annotation to specify a query on a repository method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Query("select id, first_name, dob from customer where upper(first_name) like '%' || upper(:name) || '%' ")
List&lt;Customer&gt; findByName(@Param("name") String name);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <code>@Param</code> annotation is not required if you compile with the <code>-parameters</code> flag.</p>
</div>
<div class="paragraph">
<p>If you want to execute an update or delete statement, you can add a <code>@Modifying</code> annotation to the method.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s create another test in order to try out the new method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Test
public void findByName() {

    Customer customer = new Customer();
    customer.dob = LocalDate.of(1904, 5, 14);
    customer.firstName = "Albert";

    Customer saved = customerRepo.save(customer);

    assertThat(saved.id).isNotNull();

    customer.id= null; <b class="conum">(1)</b>
    customer.firstName = "Bertram";

    customerRepo.save(customer);

    customer.id= null;
    customer.firstName = "Beth";

    customerRepo.save(customer);

    assertThat(customerRepo.findByName("bert")).hasSize(2); <b class="conum">(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Since the connection between a Java object and its corresponding row is just its <code>Id</code> plus its type, setting the <code>Id</code> to <code>null</code> and saving it again creates another row in the database.</p>
</li>
<li>
<p>We are doing a case-insensitive (like) search, and, therefore, we find "Albert" and "Bertram" but not "Beth".</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="closing-notes"><a class="anchor" href="#closing-notes"></a>Closing Notes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is more to learn about Spring Data JDBC. Continue reading <a href="https://spring.io/blog/2018/09/24/spring-data-jdbc-references-and-aggregates">Spring Data JDBC References and Aggregates</a></p>
</div>
<div class="paragraph">
<p>Or you can take a <a href="https://github.com/spring-projects/spring-data-examples/tree/master/jdbc">look at the examples</a>,
the <a href="https://docs.spring.io/spring-data/jdbc/docs/current/reference/html/">documentation</a>,
and, of course, <a href="https://github.com/spring-projects/spring-data-jdbc">the source code</a>.
If you have questions, <a href="https://stackoverflow.com/questions/tagged/spring-data-jdbc">ask away on StackOverflow</a>.
And if you find a bug or want to request a feature <a href="https://jira.spring.io/projects/DATAJDBC">please create an issue</a>.</p>
</div>
</div>
</div></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 3396;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
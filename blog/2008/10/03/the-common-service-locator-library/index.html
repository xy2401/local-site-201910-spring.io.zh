<html  data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>通用服务定位器库</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="The Common Service Locator library">
<meta name="twitter:description" >
<meta name="twitter:image:src" content="https://gravatar.com/avatar/5cffed9a3aad16d33d07f6e7ef2ebbb7?s=200">

<meta property="og:title" content="The Common Service Locator library">
<meta property="og:image" content="https://gravatar.com/avatar/5cffed9a3aad16d33d07f6e7ef2ebbb7?s=200">
<meta property="og:description" >
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2008-10-03 19:19:00.0">



<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">专案</a>
</li>
<li class="navbar-link">
<a href="/guides">导游</a>
</li>
<li class="navbar-link active">
<a href="/blog">博客</a>
</li>
<li class="navbar-link">
<a href="/services">培训与认证</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索文档，指南和帖子..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">家<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">专案<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">导游<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">博客<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">培训与认证<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>工程</div>
</div>
<div class="blog-category content--title">
<div>发布</div>
</div>
<div class="blog-category content--title">
<div>新闻与活动</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">通用服务定位器库</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">工程</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/5cffed9a3aad16d33d07f6e7ef2ebbb7?s=20&d=mm"> <a class="author" rel="author" href="/team/mpollack">马克·波拉克</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2008-10-03 19:19:00.0">2008年10月3日</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2008/10/03/the-common-service-locator-library#disqus_thread" data-disqus-identifier="179">
</a></div>
</div>
</header>
<div class="blog--post"><p><a href="https://www.codeplex.com/CommonServiceLocator">CommonServiceLocator</a>项目本周在CodePlex上发布，其总体思路是提供一个IoC容器不可知API，以使用Service Location解决依赖关系。SpringSource的Erich Eichinger贡献了Spring.NET的实现，谢谢Erich！</p><p>这是API，因此您可以了解基本概念<br><code lang="csharp">public interface IServiceLocator : System.IServiceProvider {</code></p><p><code lang="csharp">object GetInstance(Type serviceType);<br> object GetInstance(Type serviceType, string key);<br> IEnumerable<object> GetAllInstances(Type serviceType);<br> TService GetInstance
 <tservice>
  ();
  <br> TService GetInstance
  <tservice>
   (string key);
   <br> IEnumerable
   <tservice>
     GetAllInstances
    <tservice>
     ();
     <br>}
     <br>
     <br>
     <p></p>
     <p>One of the fears I had in participating in this project was that it would promote the approach of Service Location/Dependency Pull over Dependency Injection. I’m glad to see blogs entries like <a href="http://ayende.com/Blog/archive/2008/10/02/the-common-service-locator-library.aspx">Ayende’s</a> and (more forcefully) <a href="http://www.clariusconsulting.net/blogs/kzu/archive/2008/10/03/WhatisallthefuzzaboutthenewcommonIServiceLocator.aspx">Daniel Cuzzulino’s</a> that put this library in the proper perspective. </p>
     <p>The intention of this library is primarily for low-level integration between application frameworks. It has a role in business code only as a last resort when you need to ask a container to provide you with a new object instance at runtime that takes advantage of additional container services such as configuration via dependency injection or applying AOP advice. <a href="http://www.springframework.net/doc-latest/reference/html/web.html#web-di">WebForms</a>, <a href="http://www.springframework.net/doc-latest/reference/html/wcf.html#wcf-di">WCF Services</a>, and ‘traditional’ server-side objects created at application startup (DAOs, etc) can all be configured non-invasively using dependency injection. </p>
     <p>If you find yourself frequently using the service locator approach in your application you should consider refactoring the code to use dependency injection. Not only will you remove an extraneous dependency, always a good thing, but you will get the additional benefit of making your class easier to unit test in isolation of the container as its dependencies will be exposed via standard properties and constructors.</p>
     <p>One alternative approach, used in Spring Java but not yet implemented in Spring.NET is to provide a <a href="http://static.springframework.org/spring/docs/1.2.x/api/org/springframework/beans/factory/config/ServiceLocatorFactoryBean.html">ServiceLocatorFactoryObject</a>, described by my colleague Alef Arendsen <a href="http://blog.arendsen.net/index.php/2006/10/05/on-the-servicelocatorfactorybean-dlas-and-the-sustainability-of-code-and-design/">here</a>. This allows you to write your own simple service locator interface, for example.</p>
     <p><code lang="csharp">public interface ProcessCreator {<br> Process CreateProcess(string processId);<br>}<br></code></p>
     <p>The container would provide the implementation dynamically at runtime. You can then use dependency injection to configure your class with a reference to ProcessCreator. The only service locator ‘API’ provided with <a href="http://static.springframework.org/spring/docs/1.2.x/api/org/springframework/beans/factory/config/ServiceLocatorFactoryBean.html">ServiceLocatorFactoryObject </a>are of methods with the signatures IMyService GetService() or IMyService GetService(string id) but others could be envisioned.</p>  
     <section id="disqus_thread"></section> 
     <script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 179;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script> 
     <noscript>
      Please enable JavaScript to view the 
      <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
     </noscript> 
     <a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a> 
     <div class="mobile-only"> 
      <p><a href="/blog"> <i class="icon-chevron-left"></i> Back </a></p> 
     </div>  
     <aside class="span4 mobile-right-pane" id="sidebar"> 
      <div> 
       <ul class="right-pane-widget--container secondary-nav with-icon"> 
        <li class="blog-category"> 
         <div class="icon blog-icon all-posts"></div> <a href="/blog">All Posts</a> <a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a> </li> 
        <li class="blog-category active"> 
         <div class="icon blog-icon engineering"></div> <a href="/blog/category/engineering">Engineering</a> <a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a> </li> 
        <li class="blog-category"> 
         <div class="icon blog-icon releases"></div> <a href="/blog/category/releases">Releases</a> <a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a> </li> 
        <li class="blog-category"> 
         <div class="icon blog-icon news-and-events"></div> <a href="/blog/category/news">News and Events</a> <a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a> </li> 
       </ul> 
       <ul class="social-btn--container"> 
        <a class="social-btn twitter" href="https://twitter.com/springcentral"></a> 
        <a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a> 
        <a class="social-btn youtube" href="/videos"></a> 
       </ul> 
       <div id="blog-sidebar-newsletter"> 
        <p>Get updates from The Spring Team delivered to your inbox</p> 
        <script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script> 
        <form id="mktoForm_4723"></form> 
        <script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script> 
       </div> 
      </div> 
     </aside>    
     <footer class="footer"> 
      <div class="container-fluid"> 
       <div class="row-fluid"> 
        <div class="span12"> 
         <div class="navbar"> 
          <div class="container"> 
           <ul class="nav"> 
            <li><a href="/team">Team</a></li> 
            <li><a href="/tools">Tools</a></li> 
            <li><a href="https://store.pivotal.io/">Store</a></li> 
            <li><a href="/blog">Newsletter</a></li> 
           </ul> 
          </div> 
         </div> © 
         <span>2019</span> 
         <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved. 
         <a href="https://pivotal.io/terms-of-use">Terms of Use</a> • 
         <a href="https://pivotal.io/privacy-policy">Privacy</a> • 
         <a href="/trademarks">Trademark Guidelines</a> 
         <div id="teconsent" style="display:inline-block;"></div> 
        </div> 
       </div> 
      </div> 
     </footer> 
     <div id="scrim"></div>  
    </tservice>
   </tservice>
  </tservice>
 </tservice></object></code></p></div></div></article></div></div></div></div></body></html>
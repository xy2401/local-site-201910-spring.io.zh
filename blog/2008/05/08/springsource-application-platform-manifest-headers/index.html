<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>SpringSource Application Platform Manifest Headers</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="SpringSource Application Platform Manifest Headers" />
<meta name="twitter:description" content="&lt;p&gt;The SpringSource Application Platform is constructed from OSGi bundles and supports applications which are also constructed from OSGi bundles. The Platform supports the standard features of OSGi, but it also supports some additional manifest headers. Several people have asked &lt;q&gt;Why did SpringSource add proprietary headers?&lt;/q&gt; and &lt;q&gt;What are the semantics of the new headers?&lt;/q&gt;, so this post explains the background motivation and the semantics of &lt;span style=&quot;font-family:courier&quot;&gt;Import-Library&lt;/span&gt; and &lt;span style=&quot;font-family:courier&quot;&gt;Import-Bundle&lt;/span&gt;.&lt;/p&gt;
&lt;h2&gt;Standard OSGi Bundle Support&lt;/h2&gt;
" />
<meta name="twitter:creator" content="@@glynnormington" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/132b1a9d7e4acd28950bb6e72256b078?s=200" />

<meta property="og:title" content="SpringSource Application Platform Manifest Headers" />
<meta property="og:image" content="https://gravatar.com/avatar/132b1a9d7e4acd28950bb6e72256b078?s=200" />
<meta property="og:description" content="&lt;p&gt;The SpringSource Application Platform is constructed from OSGi bundles and supports applications which are also constructed from OSGi bundles. The Platform supports the standard features of OSGi, but it also supports some additional manifest headers. Several people have asked &lt;q&gt;Why did SpringSource add proprietary headers?&lt;/q&gt; and &lt;q&gt;What are the semantics of the new headers?&lt;/q&gt;, so this post explains the background motivation and the semantics of &lt;span style=&quot;font-family:courier&quot;&gt;Import-Library&lt;/span&gt; and &lt;span style=&quot;font-family:courier&quot;&gt;Import-Bundle&lt;/span&gt;.&lt;/p&gt;
&lt;h2&gt;Standard OSGi Bundle Support&lt;/h2&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2008-05-08 09:53:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">SpringSource Application Platform Manifest Headers</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/132b1a9d7e4acd28950bb6e72256b078?s=20&amp;d=mm" />
<a class="author" rel="author" href="/team/gnormington">Glyn Normington</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2008-05-08 09:53:00.0">May 08, 2008</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="158" href="/blog/2008/05/08/springsource-application-platform-manifest-headers#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><p>The SpringSource Application Platform is constructed from OSGi bundles and supports applications which are also constructed from OSGi bundles. The Platform supports the standard features of OSGi, but it also supports some additional manifest headers. Several people have asked <q>Why did SpringSource add proprietary headers?</q> and <q>What are the semantics of the new headers?</q>, so this post explains the background motivation and the semantics of <span style="font-family:courier">Import-Library</span> and <span style="font-family:courier">Import-Bundle</span>.</p>
<h2>Standard OSGi Bundle Support</h2><p>The Platform is built on the <a href="http://www.osgi.org/Specifications/HomePage">OSGi R4.1</a> standard, or <a href="https://jcp.org/en/jsr/detail?id=291">JSR 291</a> if you prefer, and uses <a href="https://www.eclipse.org/equinox/">Equinox</a> as its OSGi implementation. The result is that you can develop standard OSGi bundles using the Platform&rsquo;s tooling and deploy those bundles on the Platform, as a number of users have been doing since the Platform&rsquo;s launch.</p><p>So OSGi savvy developers can use the Platform as a standard OSGi container and benefit from Platform features such as:<br /><ul><br /> <li>the ability to deploy bundles using the Admin Console or by dropping bundles in the Platform&rsquo;s <span style="font-family:courier">pickup</span> directory,</li><br /> <li>diagnostics such as resolution failure diagnosis, application specific trace, and automatic deadlock detection,</li><br /> <li>strong integration with Spring and Spring Dynamic Modules, for developers who want to use these frameworks, and</li><br /> <li>automatic provisioning of dependencies from a repository.</li><br /></ul><br />However, the Platform also aims to make it easy for enterprise application developers with little or no prior exposure to OSGi to benefit from OSGi, which places some extra requirements on the Platform.</p>
<h2>Additional Requirements of Enterprise Applications</h2><p>As Sam&rsquo;s recent <a href="http://blog.springsource.com/main/2008/05/06/springsource-application-platform-deployment-options/">blog</a> on the Platform&rsquo;s deployment options explains, you can deploy existing monolithic WAR files on the Platform with no need to understand OSGi - the Platform takes care of everything for you. But to benefit from shared libraries, shared services and, ultimately, PAR file scoping, it is necessary to break monolithic WAR files into OSGi bundles. How hard can that be?<br /><p><br />Well, some steps in the process are relatively easy, especially if good software engineering practices have been followed and the code has been organised into service, domain, and infrastructure components. These components can be converted into bundles and the dependencies between them expressed using standard OSGi Import-Package and Export-Package headers in <span style="font-family:courier">META-INF/MANIFEST.MF</span>.<br /><p><br />A more difficult step is expressing dependencies on enterprise frameworks such as Spring and Hibernate. It is entirely possible to express these dependencies using standard OSGi Import-Package and Require-Bundle headers, and this is exactly what you should do if your aim is to create OSGi bundles which will run in other OSGi containers, but this approach has some hidden costs.<br /><p><br />Firstly, the developer has to decide precisely which packages comprise a given framework. It isn&rsquo;t sufficient merely to import the packages the application code uses, as several enterprise frameworks weave further dependencies into the bytecode of the application when the application is loaded. The developer has to discover, probably by trial and error, which additional implementation packages to import to ensure correct behaviour of the woven application.<br /><p><br />Then there is the chore of migrating from one version of a framework to the next where the precise set of packages comprising the framework has changed. The additional packages required for weaving are typically not defined by a public contract and so are subject to change.<br /><p><br />Additionally, the resultant package imports don&rsquo;t properly capture the design intent, which makes maintaining or extending the application more difficult in the future.<br /><p><br />We really don&rsquo;t want to impose these burdens on our users, so we created some additional SpringSource Application Platform specific manifest headers, <span style="font-family:courier">Import-Library</span> and <span style="font-family:courier">Import-Bundle</span>, as convenient ways of expressing dependencies on enterprise frameworks. As you&rsquo;ll see below, these headers are really just <q>syntactic sugar</q> which are expressed in terms of standard OSGi package imports.</p>
<h2><span style="font-family:courier">Import-Library</span></h2><p>The basic syntax is similar to that of other manifest headers:<br /><pre style="font-size:11pt"><br /> Import-Library: &lt;librarySymbolicName&gt;;version=&lt;versionRange&gt;<br /></pre><br />where <span style="font-family:courier">&lt;librarySymbolicName&gt;</span> is the <q>symbolic name</q> of the library and <span style="font-family:courier">&lt;versionRange&gt;</span> is a range of acceptable versions of the library using OSGi version range notation. A library definition specifies the library&rsquo;s symbolic name and version and these together uniquely identify the library to the Platform.<br /><p><br />If you are unfamiliar with OSGi version range notation, by far the most commonly used forms are minimum version ranges such as <span style="font-family:courier"><q>2</q></span>, meaning <q>version 2 or later</q>, and <q>half-open</q> ranges such as <span style="font-family:courier"><q>[2.2.1,2.2.2)</q></span>, meaning any version between 2.2.1 inclusive and 2.2.2 exclusive. If <span style="font-family:courier">version=&lt;versionRange&gt;</span> is omitted, together with the semicolon delimiter of course, then the default range includes all versions.<br /><p><br />For each library import, the Platform selects the library with the given symbolic name and the highest version in the given version range available in the Platform&rsquo;s repository. The Platform then replaces the library import with a set of package imports which match all the packages exported by the bundles of the library. The Platform detects the situation where a bundle imports two or more libraries which export a common package, issues an appropriate log message, and fails to install the importing bundle.<br /><p><br />So, for example, the following header imports some version of the <a href="http://www.springsource.com/repository/app/library/version/detail?name=org.springframework.spring&version=2.5.4.A">Spring Framework library</a> between 2.5.4 inclusive and 2.5.5 exclusive:<br /><pre style="font-size:11pt"><br /> Import-Library: org.springframework.spring;version=&ldquo;[2.5.4,2.5.5)&rdquo;<br /></pre><br /><h3>Optional Library Import</h3><br />You can indicate that a library import is optional using the following syntax. Note the special separator <q><span style="font-family:courier">:=</span></q> which indicates a <q>directive</q> that modifies the semantics of the manifest header, as opposed to the separator <q><span style="font-family:courier">=</span></q> which indicates a <q>matching attribute</q>, like <span style="font-family:courier">version</span>.<br /><pre style="font-size:11pt"><br /> Import-Library: &lt;librarySymbolicName&gt;;version=&lt;versionRange&gt;;<b>resolution:=optional</b><br /></pre><br /><p>If <span style="font-family:courier">resolution</span> is not specified, or is specified as <span style="font-family:courier">mandatory</span>, the bundle containing the import library header will fail to install if there is no library with the given symbolic name and a version in the given range. But if <span style="font-family:courier">resolution:=optional</span> is specified, the library import will be ignored if no suitable library is available.<br /><p><br />So, for example, the following header imports some version of the Spring Framework library from 2.5 onwards, but is ignored if no suitable library is available:<br /><pre style="font-size:11pt"><br /> Import-Library: org.springframework.spring;version=&ldquo;2.5&rdquo;;resolution:=optional<br /></pre><br /><h3>Importing More than One Library</h3><br />If you need to import more than one library, then specify a comma-separated list of library imports in a single <span style="font-family:courier">Import-Library</span> manifest header as in the following example:<br /><pre style="font-size:11pt"><br /> Import-Library: org.foo.p;version=&ldquo;[1,2)&rdquo;<b>,</b>org.bar.q;version=&ldquo;[2,3)&rdquo;<br /></pre></p>
<h2><span style="font-family:courier">Import-Bundle</span></h2><p><span style="font-family:courier">Import-Bundle</span> is a further convenience for cases where a library would consist of only a single bundle and a library definition is inconvenient to create. The syntax is very similar to that of <span style="font-family:courier">Import-Library</span> except that it refers to a bundle&rsquo;s symbolic name and version instead of those of a library.<br /><p><br />As you would expect, for each imported bundle, the Platform selects the bundle with the given symbolic name and the highest version in the given version range available in the Platform&rsquo;s repository. The Platform then replaces the bundle import with a set of package imports matching the packages exported by the bundle.<br /><p><br />So, for example, the following header imports the <a href="http://www.springsource.com/repository/app/bundle/version/detail?name=com.springsource.org.hibernate&version=3.2.6.ga">Hibernate Object-Relational Mapper</a> bundle:<br /><pre style="font-size:11pt"><br /> Import-Bundle: com.springsource.org.hibernate;version=&ldquo;[3.2.6,3.2.7)&rdquo;<br /></pre></p>
<h3>Why not Overload <span style="font-family:courier">Require-Bundle</span>?</h3><p>If you are familiar with OSGi, you may be asking yourself why we didn&rsquo;t overload <span style="font-family:courier">Require-Bundle</span> instead of introducing <span style="font-family:courier">Import-Bundle</span>.<br /><p><br />Well, we wanted <span style="font-family:courier">Require-Bundle</span> to retain its standard semantics, including the ability to marry together pieces of a split package. But we wanted <span style="font-family:courier">Import-Library</span> and <span style="font-family:courier">Import-Bundle</span> to have the same underlying semantics as <span style="font-family:courier">Import-Package</span> which avoid the complexities of split packages.<br /><p><br />We also anticipate that, as the Platform evolves over time, we&rsquo;ll need to add further directives to <span style="font-family:courier">Import-Library</span> and <span style="font-family:courier">Import-Bundle</span> which would not be appropriate to add to <span style="font-family:courier">Require-Bundle</span>.</p>
<h2>What Next?</h2><p>The Platform <a href="http://www.springsource.com/beta/s2ap">beta program</a> is in progress and we&rsquo;ll be listening to all feedback on Platform features, including the new manifest headers.</p><p>For users who want to take advantage of the Platform&rsquo;s headers, but who need to produce bundles which will run on other OSGi containers, we plan to produce a tool which will replace the <span style="font-family:courier">Import-Library</span> and <span style="font-family:courier">Import-Bundle</span> syntactic sugar with equivalent standard package imports.</p><p>We&rsquo;ll also be discussing the new manifest headers with our colleagues in the OSGi Alliance to determine if there are general requirements which would be appropriate for OSGi to address in the future.</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 158;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
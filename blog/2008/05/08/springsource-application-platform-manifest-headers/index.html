<html  data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>SpringSource应用程序平台清单头</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="SpringSource Application Platform Manifest Headers">
<meta name="twitter:description" >
<meta name="twitter:creator" content="@@glynnormington">
<meta name="twitter:image:src" content="https://gravatar.com/avatar/132b1a9d7e4acd28950bb6e72256b078?s=200">

<meta property="og:title" content="SpringSource Application Platform Manifest Headers">
<meta property="og:image" content="https://gravatar.com/avatar/132b1a9d7e4acd28950bb6e72256b078?s=200">
<meta property="og:description" >
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2008-05-08 09:53:00.0">



<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">专案</a>
</li>
<li class="navbar-link">
<a href="/guides">导游</a>
</li>
<li class="navbar-link active">
<a href="/blog">博客</a>
</li>
<li class="navbar-link">
<a href="/services">培训与认证</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索文档，指南和帖子..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">家<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">专案<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">导游<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">博客<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">培训与认证<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>工程</div>
</div>
<div class="blog-category content--title">
<div>发布</div>
</div>
<div class="blog-category content--title">
<div>新闻与活动</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">SpringSource应用程序平台清单头</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">工程</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/132b1a9d7e4acd28950bb6e72256b078?s=20&d=mm"> <a class="author" rel="author" href="/team/gnormington">格林·诺明顿</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2008-05-08 09:53:00.0">2008年5月8日</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2008/05/08/springsource-application-platform-manifest-headers#disqus_thread" data-disqus-identifier="158">
</a></div>
</div>
</header>
<div class="blog--post"><p>SpringSource应用程序平台由OSGi捆绑包构建，并支持同样由OSGi捆绑包构建的应用程序。该平台支持OSGi的标准功能，但也支持一些其他清单标头。一些人问<q>为什么SpringSource添加专有标头？</q> 和<q>新标题的语义是什么？</q>因此，这篇文章解释了<span style="font-family:courier">Import-Library</span>和<span style="font-family:courier">Import-Bundle</span>的背景动机和语义。</p>
<h2>标准OSGi捆绑包支持</h2><p>该平台基于<a href="http://www.osgi.org/Specifications/HomePage">OSGi R4.1</a>标准或<a href="https://jcp.org/en/jsr/detail?id=291">JSR 291（</a>如果您愿意）构建，并使用<a href="https://www.eclipse.org/equinox/">Equinox</a>作为其OSGi实现。结果是，您可以使用平台的工具开发标准OSGi捆绑软件，并将这些捆绑软件部署在平台上，因为自平台启动以来，许多用户一直在这样做。</p><p>因此，精通OSGi的开发人员可以将Platform用作标准OSGi容器，并受益于Platform功能，例如：<br></p><ul><br> <li>使用管理控制台或通过将捆绑包拖放到平台的<span style="font-family:courier">提取</span>目录中来部署捆绑包的能力，</li><br> <li>诊断，例如解决方案故障诊断，特定于应用程序的跟踪以及自动死锁检测，</li><br> <li>与Spring和Spring Dynamic Modules的高度集成，供希望使用这些框架的开发人员使用，以及</li><br> <li>从资源库自动配置依赖关系。</li><br></ul><br>但是，该平台还旨在使几乎没有或几乎没有接触过OSGi的企业应用程序开发人员可以从OSGi中受益，这对平台提出了一些额外要求。<p></p>
<h2>企业应用程序的附加要求</h2><p>正如Sam在有关平台部署选项的最新<a href="http://blog.springsource.com/main/2008/05/06/springsource-application-platform-deployment-options/">博客</a>中所解释的那样，您可以在平台上部署现有的整体WAR文件，而无需了解OSGi-平台可以为您处理一切。但是要从共享库，共享服务以及最终的PAR文件作用域中受益，有必要将单片WAR文件分解为OSGi捆绑包。那有多难？<br></p><p><br>好吧，该过程中的某些步骤相对容易一些，尤其是如果遵循了良好的软件工程实践并且代码已组织到服务，域和基础结构组件中时。可以将这些组件转换为包，并使用<span style="font-family:courier">META-INF / MANIFEST.MF中的</span>标准OSGi Import-Package和Export-Package标头表达它们之间的依赖性。<br></p><p><br>一个更困难的步骤是表达对诸如Spring和Hibernate之类的企业框架的依赖性。完全可以使用标准的OSGi Import-Package和Require-Bundle标头来表达这些依赖关系，如果您的目标是创建将在其他OSGi容器中运行的OSGi捆绑包，那么这正是您应该做的，但是这种方法有些隐藏费用。<br></p><p><br>首先，开发人员必须精确地确定哪些包构成了给定的框架。仅导入应用程序代码使用的包是不够的，因为在加载应用程序时，几个企业框架将更多的依赖项编织到应用程序的字节码中。开发人员必须通过反复试验来发现要导入的其他实现程序包，以确保机织应用程序的正确行为。<br></p><p><br>然后是从框架的一个版本迁移到下一版本的繁琐工作，其中构成该框架的一组精确的软件包已更改。编织所需的其他包装通常不是由公共合同定义的，因此可能会发生变化。<br></p><p><br>此外，生成的包导入不能正确地反映设计意图，这使得将来维护或扩展应用程序更加困难。<br></p><p><br>我们真的不想给我们的用户带来这些负担，因此我们创建了一些额外的特定于SpringSource Application Platform的清单标头<span style="font-family:courier">Import-Library</span>和<span style="font-family:courier">Import-Bundle</span> ，作为表达对企业框架的依赖性的便捷方法。如下所示，这些标头实际上只是<q>语法糖</q> ，以标准OSGi包导入的形式表示。</p>
<h2><span style="font-family:courier">进口图书馆</span></h2><p>基本语法类似于其他清单标头的语法：<br></p><pre style="font-size:11pt"><br /> Import-Library: &lt;librarySymbolicName&gt;;version=&lt;versionRange&gt;<br /></pre><br>哪里<span style="font-family:courier"><librarysymbolicname></librarysymbolicname></span>是库的<q>象征性名称</q> ，并且<span style="font-family:courier"><versionrange></versionrange></span>是使用OSGi版本范围表示法的库的可接受版本范围。库定义指定了库的符号名称和版本，并且它们一起向平台唯一标识该库。<br><p><br>如果您不熟悉OSGi版本范围符号，那么到目前为止，最常用的形式是最小版本范围（例如<span style="font-family:courier"><q>2</q></span> ，表示<q>版本2或更高版本</q> ）和<q>半开</q>范围（例如<span style="font-family:courier"><q>[2.2.1,2.2.2））</q></span> ，这意味着在2.2.1（包括）和2.2.2（排除）之间的版本。如果<span style="font-family:courier">版本= <versionrange></versionrange></span>省略，当然还有分号分隔符，则默认范围包括所有版本。<br></p><p><br>对于每个库导入，平台都会选择具有给定符号名称和给定版本范围中平台存储库中可用的最高版本的库。然后，平台用一组程序包导入替换库程序导入，这些程序包导入与库捆绑软件导出的所有程序包匹配。平台检测到捆绑软件导入两个或更多个库（它们导出一个公共软件包），发出适当的日志消息并无法安装导入捆绑软件的情况。<br></p><p><br>因此，例如，以下标头导入了包含2.5.4和2.5.5的<a href="http://www.springsource.com/repository/app/library/version/detail?name=org.springframework.spring&version=2.5.4.A">Spring Framework库的</a>某些版本：<br></p><pre style="font-size:11pt"><br /> Import-Library: org.springframework.spring;version=&ldquo;[2.5.4,2.5.5)&rdquo;<br /></pre><br><h3>可选库导入</h3><br>您可以使用以下语法指示库导入是可选的。请注意特殊的分隔符<q><span style="font-family:courier">：=</span></q> ，它指示修改清单标题的语义的<q>指令</q> ，而分隔符<q><span style="font-family:courier">=</span></q>则指示<q>匹配属性</q> ，例如<span style="font-family:courier">version</span> 。<br><pre style="font-size:11pt"><br /> Import-Library: &lt;librarySymbolicName&gt;;version=&lt;versionRange&gt;;<b>resolution:=optional</b><br /></pre><br><p>如果未指定<span style="font-family:courier">resolution</span>或将其指定为<span style="font-family:courier">required</span> ，则如果没有具有给定符号名和给定范围内版本的库，则包含导入库标头的捆绑软件将无法安装。但是，如果指定<span style="font-family:courier">resolution：= optional</span> ，则在没有合适的库可用时，库导入将被忽略。<br></p><p><br>因此，例如，以下标头从2.5版本开始导入了某些版本的Spring Framework库，但是如果没有合适的库可用，则将其忽略：<br></p><pre style="font-size:11pt"><br /> Import-Library: org.springframework.spring;version=&ldquo;2.5&rdquo;;resolution:=optional<br /></pre><br><h3>导入多个库</h3><br>如果需要导入多个库，请在单个<span style="font-family:courier">Import-Library</span>清单标头中指定以逗号分隔的库导入列表，如以下示例所示：<br><pre style="font-size:11pt"><br /> Import-Library: org.foo.p;version=&ldquo;[1,2)&rdquo;<b>,</b>org.bar.q;version=&ldquo;[2,3)&rdquo;<br /></pre><p></p>
<h2><span style="font-family:courier">导入捆绑</span></h2><p>对于库仅由单个束组成且创建库定义不方便的情况， <span style="font-family:courier">Import-Bundle</span>更为方便。该语法与<span style="font-family:courier">Import-Library</span>的语法非常相似，区别在于它引用捆绑软件的符号名称和版本而不是库的符号名称和版本。<br></p><p><br>如您所料，对于每个导入的捆绑软件，平台都会选择具有给定符号名称和给定版本范围中平台存储库中可用的最高版本的捆绑软件。然后，平台将软件包导入替换为与软件包导出的软件包匹配的一组软件包导入。<br></p><p><br>因此，例如，以下标头导入了<a href="http://www.springsource.com/repository/app/bundle/version/detail?name=com.springsource.org.hibernate&version=3.2.6.ga">Hibernate Object-Relational Mapper</a>捆绑包：<br></p><pre style="font-size:11pt"><br /> Import-Bundle: com.springsource.org.hibernate;version=&ldquo;[3.2.6,3.2.7)&rdquo;<br /></pre><p></p>
<h3>为什么不超载<span style="font-family:courier">Require-Bundle</span> ？</h3><p>如果您熟悉OSGi，您可能会问自己为什么我们不重载<span style="font-family:courier">Require-Bundle</span>而不是引入<span style="font-family:courier">Import-Bundle</span> 。<br></p><p><br>好吧，我们希望<span style="font-family:courier">Require-Bundle</span>保留其标准语义，包括将拆分包的各个部分结合在一起的能力。但是我们希望<span style="font-family:courier">Import-Library</span>和<span style="font-family:courier">Import-Bundle</span>具有与<span style="font-family:courier">Import-Package</span>相同的底层语义，从而避免了拆分包的复杂性。<br></p><p><br>我们还预计，随着平台的发展，我们需要向<span style="font-family:courier">Import-Library</span>和<span style="font-family:courier">Import-Bundle</span>添加更多指令，而这些指令不适合添加到<span style="font-family:courier">Require-Bundle中</span> 。</p>
<h2>接下来是什么？</h2><p>Platform <a href="http://www.springsource.com/beta/s2ap">beta程序</a>正在进行中，我们将倾听有关Platform功能的所有反馈，包括新的清单标题。</p><p>对于希望利用平台头文件但需要生成将在其他OSGi容器上运行的包的用户，我们计划生产一种工具，该工具将使用等效的标准包<span style="font-family:courier">导入</span>替换<span style="font-family:courier">Import-Library</span>和<span style="font-family:courier">Import-Bundle</span>语法糖。 。</p><p>我们还将与OSGi联盟的同事讨论新的清单标头，以确定是否存在适合OSGi将来解决的一般要求。</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 158;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>请启用JavaScript以查看<a href="http://disqus.com/?ref_noscript">由Disqus提供</a>的<a href="http://disqus.com/?ref_noscript">评论。</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">由<span class="logo-disqus">Disqus</span>提供动力的评论</a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>背部</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">所有帖子</a> <a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">工程</a> <a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">发布</a> <a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">新闻与活动</a> <a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>将The Spring Team的更新发送到您的收件箱</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">工具类</a></li>
<li><a href="https://store.pivotal.io/">商店</a></li>
<li><a href="/blog">通讯</a></li>
</ul>
</div>
</div>© <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a> ，Inc.保留所有权利。
<a href="https://pivotal.io/terms-of-use">使用条款</a> • <a href="https://pivotal.io/privacy-policy">隐私</a> • <a href="/trademarks">商标准则</a>
<div id="teconsent" style="display:inline-block"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>Implementing Enterprise Integration Patterns part 0</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="Implementing Enterprise Integration Patterns part 0" />
<meta name="twitter:description" content="&lt;p&gt;After my talk on Spring Integration I’ve been getting quite some questions on clarification and samples. To meet the demand I will start a small series on implementing different integration patterns using Spring Integration. This first article will focus on the basics. It will show you how to get up and running and walk through one of the samples.&lt;/p&gt;
&lt;p&gt;If you never heard about Spring Integration before it might be a good idea to familiarize yourself with it reading the &lt;a href=&quot;http://blog.springsource.com/main/2007/12/14/spring-integration-a-new-addition-to-the-spring-portfolio/&quot;&gt;introductory blog Mark Fisher wrote about it&lt;/a&gt; or by browsing the project website. In general &lt;/p&gt;
" />

<meta property="og:title" content="Implementing Enterprise Integration Patterns part 0" />
<meta property="og:description" content="&lt;p&gt;After my talk on Spring Integration I’ve been getting quite some questions on clarification and samples. To meet the demand I will start a small series on implementing different integration patterns using Spring Integration. This first article will focus on the basics. It will show you how to get up and running and walk through one of the samples.&lt;/p&gt;
&lt;p&gt;If you never heard about Spring Integration before it might be a good idea to familiarize yourself with it reading the &lt;a href=&quot;http://blog.springsource.com/main/2007/12/14/spring-integration-a-new-addition-to-the-spring-portfolio/&quot;&gt;introductory blog Mark Fisher wrote about it&lt;/a&gt; or by browsing the project website. In general &lt;/p&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2008-05-19 19:24:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Implementing Enterprise Integration Patterns part 0</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="null?s=20&amp;d=mm" />
<span class="author">Iwein Fuld</span>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2008-05-19 19:24:00.0">May 19, 2008</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="162" href="/blog/2008/05/19/implementing-enterprise-integration-patterns-part-0#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><p>After my talk on Spring Integration I&rsquo;ve been getting quite some questions on clarification and samples. To meet the demand I will start a small series on implementing different integration patterns using Spring Integration. This first article will focus on the basics. It will show you how to get up and running and walk through one of the samples.</p><p>If you never heard about Spring Integration before it might be a good idea to familiarize yourself with it reading the <a href="http://blog.springsource.com/main/2007/12/14/spring-integration-a-new-addition-to-the-spring-portfolio/">introductory blog Mark Fisher wrote about it</a> or by browsing the project website. In general </p><p>Let me start with a disclaimer: the patterns you&rsquo;re about to see here are merely meant as an illustration to the features that Spring Integration has to offer; syntax may vary through different versions and extra precautions might be needed on your system.</p><p>The first step to getting involved in Spring Integration is to download the project and look at the sample. So let&rsquo;s start with that:</p>
<ol><li />Check out the sources from svn: <tt>svn co https://src.springframework.org/svn/spring-integration/trunk</tt>
If you're uncomfortable working with a constantly changing code base you could also go for one of the milestones under https://src.springframework.org/svn/spring-integration/tags/, but at the time of this blog M4 isn't out yet and I still want to show you the latest features of course. Don't forget to check if M4 isn't out already when you read this. Last time I checked it was about to hatch.
<li />Run a build on the entire project: <br /> <tt>$ cd build-spring-integration <br />$ ant</tt>
<li />Import the projects in Eclipse and configure an IVY_CACHE variable to point to your ivy cache. This will probably be a directory next to build-spring-integration.
<li />Open up HelloWorldDemo and run as Java application. If you've done this <a href="http://blog.springsource.com/main/2007/12/21/spring-integration-samples/">before</a> you'll see the changes in syntax.</ol><p>If this works OK you&rsquo;re up and running. Next you can explore the different samples. I will describe only the cafe sample because that is the most interesting configuration.</p><p>In the cafe package of the sample project you will find all the code related to the implementation of the <a href="http://www.enterpriseintegrationpatterns.com/ramblings/18_starbucks.html">famous Starbucks story</a>. To introduce you to the architecture I will follow an order from start (Cafe) to finish (Barista):</p><p>First the order is created by CafeDemo. It contains two drinks, one hot, one cold. Then the order is wrapped in a message and put on the &lsquo;orders&rsquo; channel. The endpoint listening to the &lsquo;orders&rsquo; channel is a splitter (OrderSplitter) in the split method the order is split up into multiple Drinks which are in turn wrapped into separate messages by the framework.</p><p>After being split and put on the &lsquo;drinks&rsquo; channel the drinks are being processed by the DrinksRouter. This router has the responsibility of putting hot drinks on the &lsquo;hotDrinks&rsquo; channel and cold drinks on the &lsquo;coldDrinks&rsquo; channel. Both these channels are handled by different endpoints that use the prepareHotDrink and preprareColdDrink method on the Barista respectively.</p><p>Let&rsquo;s follow the flow of messages through the relevant bits of code:<br />In the cafeDemo.xml bean definition file you can see a Cafe being configured as a bean.<br /><code lang="Java">&lt;beans:bean id=&ldquo;cafe&rdquo;<br /> class=&ldquo;org.springframework.integration.samples.cafe.Cafe&rdquo;&gt;<br /> &lt;beans:property name=&ldquo;orderChannel&rdquo; ref=&ldquo;orders&rdquo; /&gt;<br />&lt;/beans:bean&gt;</code><br />This bean is used by the CafeDemo main method to put order messages on the order queue.<br /><code lang="Java"> Cafe cafe = (Cafe) context.getBean(&ldquo;cafe&rdquo;);<br /> DrinkOrder order = new DrinkOrder();<br /> Drink hotDoubleLatte = new Drink(DrinkType.LATTE, 2, false);<br /> Drink icedTripleMocha = new Drink(DrinkType.MOCHA, 3, true);<br /> order.addDrink(hotDoubleLatte);<br /> order.addDrink(icedTripleMocha);<br /> for (int i = 0; i &lt; 100; i++) {<br /> cafe.placeOrder(order);<br /> }</p><p></code>A <tt>&lt;context:component-scan &hellip;../&gt;</tt> is being used in <tt>cafeDemo.xml</tt> to bootstrap the OrderSplitter and DrinkRouter.</p><p>The OrderSplitter is sprinkled with some annotations:<br /><ul><li />the @MessageEndpoint annotation tells Spring Integration to wrap a bean of this type in an endpoint when you turn on annotation-config. Additionally it is a subtype of @Component so that you don&rsquo;t need to write an xml bean definition for Spring to pick it up.<br /><li />the @Splitter annotation tells spring to use the splitOrder method to split a message containing an Order as payload into multiple messages containing the drinks of that Order.</ul><br /><code lang="Java">@MessageEndpoint(input=&ldquo;orders&rdquo;, output=&ldquo;drinks&rdquo;)<br />public class OrderSplitter {</p>
<pre><code class="prettyprint">@Splitter
public List&lt;Drink&gt; split(Message&lt;DrinkOrder&gt; orderMessage) {
    return orderMessage.getPayload().getDrinks();
}
</code></pre><p>}</code></p><p>The DrinkRouter is similarly decorated with annotations that tell Spring Integration to use it as a router. The string returned from the @Router annotated method is interpreted by Spring Integration as the output channel.<br /><code lang="Java">@MessageEndpoint(input=&ldquo;drinks&rdquo;)<br />public class DrinkRouter {</p>
<pre><code class="prettyprint">@Router
public String resolveDrinkChannel(Drink drink) {
    return (drink.isIced()) ? &quot;coldDrinks&quot; : &quot;hotDrinks&quot;;
}
</code></pre><p>}</code></p><p>After the routing the messages are available on the hotDrinks or coldDrinks channel depending on their temperature.</p><p>The endpoints configured to call the appropriate method on the Barista are configured in xml:<br /><code lang="Java"><handler-endpoint handler="coldBarista" input-channel="coldDrinks" method="prepareColdDrink"><br /></handler-endpoint></p><p><handler-endpoint handler="hotBarista" input-channel="hotDrinks" method="prepareHotDrink"><br /></handler-endpoint></code></p><p>You can see that both the input channel and the method to feed the message to are defined so Spring Integration knows what to do.</p><p>Notice that you don&rsquo;t need to unwrap the message yourself: accepting the payload type as input parameter is fine as well. If you change the methods in the Barista to accept Message<Drink> and extract the payload yourself, it will still work as expected.<br /><code lang="Java"> public void prepareColdDrink(Message<Drink> drinkMessage) {<br /> Drink drink = drinkMessage.getPayload();<br /> //no changes to the rest of the code<br /> }</code></p><p>Play around with the sample and post on the forum if you have any troubles. You&rsquo;ll find that they are quite helpful already (mainly because Mark responds to almost every post). Next episode will feature an other implementation of an EIP.</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 162;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
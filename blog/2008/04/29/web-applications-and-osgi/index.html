<html  data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>Web应用程序和OSGi</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="Web Applications and OSGi">
<meta name="twitter:description" content="<p>Since the first milestones of Spring Dynamic Modules, requests for running web applications in OSGi started to come in. It has been probably one of the most requested features and no wonder, once 1.0 final was released, web support has been the main focus of the 1.1 branch. I am pleased to report that, with the just <a href=" http:="" ="" www.springframework.org="" node="" 64="="></head><body >released M2, as already <a href="http://blog.springsource.com/main/2008/04/28/portability-at-the-framework-level/">hinted</a> by <a href="http://blog.springsource.com/main/author/juergenh/">Juergen</a>, Spring-DM supports not just vanilla wars (available since 1.1.0 M1) but also Spring-MVC applications running inside OSGi. In this entry, I would like to briefly discuss the typical OSGi web scenario and Spring-DM’s approach. But first,
">

<meta property="og:title" content="Web Applications and OSGi">
<meta property="og:description" content="<p>Since the first milestones of Spring Dynamic Modules, requests for running web applications in OSGi started to come in. It has been probably one of the most requested features and no wonder, once 1.0 final was released, web support has been the main focus of the 1.1 branch. I am pleased to report that, with the just <a href=" http:="" ="" www.springframework.org="" node="" 64="=">released M2, as already <a href="http://blog.springsource.com/main/2008/04/28/portability-at-the-framework-level/">hinted</a> by <a href="http://blog.springsource.com/main/author/juergenh/">Juergen</a>, Spring-DM supports not just vanilla wars (available since 1.1.0 M1) but also Spring-MVC applications running inside OSGi. In this entry, I would like to briefly discuss the typical OSGi web scenario and Spring-DM’s approach. But first,
">
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2008-04-29 17:45:00.0">



<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">专案</a>
</li>
<li class="navbar-link">
<a href="/guides">导游</a>
</li>
<li class="navbar-link active">
<a href="/blog">博客</a>
</li>
<li class="navbar-link">
<a href="/services">培训与认证</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索文档，指南和帖子..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">家<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">专案<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">导游<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">博客<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">培训与认证<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>工程</div>
</div>
<div class="blog-category content--title">
<div>发布</div>
</div>
<div class="blog-category content--title">
<div>新闻与活动</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Web应用程序和OSGi</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">工程</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="null?s=20&d=mm"> <span class="author">Costin Leau</span>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2008-04-29 17:45:00.0">2008年4月29日</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2008/04/29/web-applications-and-osgi#disqus_thread" data-disqus-identifier="152">
</a></div>
</div>
</header>
<div class="blog--post"><p>从Spring动态模块的第一个里程碑开始，就开始出现在OSGi中运行Web应用程序的请求。它可能一直是最受用户要求的功能之一，也就不足为奇了，一旦1.0最终版发布，Web支持便成为1.1分支的主要关注点。我很高兴地报告说，正如<a href="http://blog.springsource.com/main/author/juergenh/">Juergen所</a> <a href="http://blog.springsource.com/main/2008/04/28/portability-at-the-framework-level/">暗示</a>的那样，对于刚刚<a href="http://www.springframework.org/node/646">发布的</a> M2，Spring-DM不仅支持香草战争（自1.1.0 M1起可用），还支持在OSGi中运行的Spring-MVC应用程序。在这篇文章中，我想简要讨论一下典型的OSGi Web场景和Spring-DM的方法。但首先，</p>
<h2>为什么要在OSGi中部署WAR？</h2><p>一个简单的问题：OSGi <em>本身</em>提供版本控制，软件包接线和热重装。想象一下利用应用程序中的这些功能：您可以停止在<tt>WEB-INF / lib</tt>下嵌入库，并开始在Web应用程序之间共享它们，避免taglib重复（同时保持多个版本运行），并在运行时仅更新其中的某些部分。你的申请。由于Web应用程序趋于分层，因此在其生命周期中会发生大量更改，因此这特别有用。</p>
<h2>为什么OSGi中的Web应用程序有问题？</h2><p>Servlet规范围绕<em>Web容器</em>的概念展开：Web组件的运行时环境，该环境提供标准服务，例如生命周期管理（对象创建和处置，线程分配），并发，HTTP请求处理等。另一方面，OSGi平台还可以通过其服务注册表，软件包接线和版本控制（仅举几例）充当托管环境。为了解决这个问题，OSGi委员会设计了纲要规范的一部分<a href="http://www2.osgi.org/javadoc/r4/org/osgi/service/http/HttpService.html">Http Service</a> 。</p><p><em>附带说明一下，在处理两个托管环境时，一个人面临一个有趣的问题：要使用哪种部署模型？那是哪个引导平台和哪个嵌入式平台？在我们的案例中，可以将OSGi平台部署为WAR，也可以在OSGi平台内部部署Web容器（采用某种服务形式）。不过，在以后的文章中将有更多关于此的信息。</em></p><p>此可选服务提供了一个简单的API，用于注册映射到传入HTTP请求的<tt>Servlet</tt>和静态资源。为了使<tt>Servlet能够</tt>在OSGi中处理请求，必须以<strong>编程方式</strong>创建<tt>Servlet</tt>实例并通过上述API注册它。此外，Http服务仅支持<tt>Servlet</tt> 2.1规范，由于没有可用的过滤器和侦听器（当今几乎所有Web框架都可以使用），因此该服务非常不便。<br>今天（我知道）的大多数（如果不是全部）可用的解决方案（用于在OSGi中运行Web应用程序）都依赖于Http Service的功能。有些人使用以下一种技术解决了上述问题（据我所知）：<br></p><ul><br><li>通过强加新的或将现有的声明方法（例如<tt>web.xml</tt> ）转换为对Http Service的调用来消除对代码的需求</li><br><li>通过在2.1 API的基础上构建来提供<tt>Servlet</tt> 2.1+功能（例如，可以通过装饰<tt>Servlet</tt>实例来实现过滤器）或通过扩展标准API</li><br></ul><br>这两种方法都可以成功并且大有帮助，但是在Spring-DM中，我们通过以下方式选择了一种不同的独特方法：<p></p>
<h2>直接与Web容器集成</h2><p>在Spring-DM中，OSGi和容器空间是桥接的：像往常一样部署到Web容器的WAR使用OSGi空间进行类路径和资源查找。这种方法的主要优点是，对于OSGi平台和Web容器而言，没有什么大的变化-它只是“照常营业”。</p><p>使用Spring-DM，您将获得：<br></p><ul><br><li>完全支持Servlet 2.4 / 2.5，JSP 2.0 / 2.1规范</li><br><li>容器功能的可用性（阻塞与非阻塞IO，线程池中分配的线程等）</li><br><li>完全访问<tt>web.xml</tt>语法，无论是有关过滤器，侦听器，映射声明，安全性，甚至是jndi引用。这在容器与JTA事务管理器或JMS队列集成的情况下特别有用。需要注意的是春天-DM确实没有解析（我们想通容器这更好做了<em>很多</em>那么我们就可以）</li><br><li>容器特定的配置文件（例如Tomcat的<tt>META-INF / context.xml</tt> ）</li><br></ul><p></p><p>由于Spring-DM将捆绑包<strong>本地</strong>部署到所选的Web容器中，因此上述所有以及更多的事情都是可能的（当前已开箱即用地支持Apache Tomcat 5.5.x / 6.0.x和Jetty 6.1.x +）。这意味着实例化和管理Web应用程序的是Web容器，因此OSGi捆绑包几乎可以使用容器支持的所有内容。</p><p>尽管1.1尚未最终确定，但我鼓励您尝试<a href="https://sourceforge.net/project/showfiles.php?group_id=73357&package_id=227224">M2</a> 。该<a href="http://static.springframework.org/osgi/docs/current/api/">API</a> s为非常稳定，新功能<a href="http://static.springframework.org/osgi/docs/current/reference/html/what-is-new.html#dm-1.1.x">记录</a> （更多的惊喜，随着我们接近GA发布） -如果您需要帮助，请与Spring DM <a href="http://forum.springframework.org/forumdisplay.php?f=43">论坛</a> （是的，我们终于有一个）和邮件<a href="https://groups.google.com/group/spring-osgi">列表</a> 。另外，如果您恰巧在JavaOne旁，请在SpringSource <a href="http://www.springframework.org/node/634">展位前</a>停下来，您会从源头那里获得答案。</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 152;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>请启用JavaScript以查看<a href="http://disqus.com/?ref_noscript">由Disqus提供</a>的<a href="http://disqus.com/?ref_noscript">评论。</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">由<span class="logo-disqus">Disqus</span>提供动力的评论</a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>背部</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">所有帖子</a> <a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">工程</a> <a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">发布</a> <a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">新闻与活动</a> <a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>将The Spring Team的更新发送到您的收件箱</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">球队</a></li>
<li><a href="/tools">工具类</a></li>
<li><a href="https://store.pivotal.io/">商店</a></li>
<li><a href="/blog">通讯</a></li>
</ul>
</div>
</div>© <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a> ，Inc.保留所有权利。
<a href="https://pivotal.io/terms-of-use">使用条款</a> • <a href="https://pivotal.io/privacy-policy">隐私</a> • <a href="/trademarks">商标准则</a>
<div id="teconsent" style="display:inline-block"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
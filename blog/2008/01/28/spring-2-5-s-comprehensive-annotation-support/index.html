<html dir="ltr" data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>Spring 2.5的全面注释支持</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>System.config({baseURL: "/b92013b"});</script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>System.import('app/main.js')</script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="Spring 2.5's Comprehensive Annotation Support">
<meta name="twitter:description" content="<p>One of the central themes behind Spring 2.5 is comprehensive annotation-based configuration. We’ve been talking and blogging a lot about <strong>@Autowired</strong>, about Spring MVC’s <strong>@RequestMapping</strong> and also about the new support for annotated tests written with JUnit4 or TestNG. <strong>@Autowired</strong> is certainly the central one of Spring 2.5’s annotations, being available for use in service components, web components, unit tests - even domain objects when using Spring’s <strong>@Configurable</strong> with AspectJ weaving. Spring MVC’s <strong>@RequestMapping</strong> is equally flexible, supporting many variants of handler method signatures.</p>
">
<meta name="twitter:creator" content="@springjuergen">
<meta name="twitter:image:src" content="https://gravatar.com/avatar/ba9686d8c567aabedc1b7f8b6a7fb3d6?s=200">

<meta property="og:title" content="Spring 2.5's Comprehensive Annotation Support">
<meta property="og:image" content="https://gravatar.com/avatar/ba9686d8c567aabedc1b7f8b6a7fb3d6?s=200">
<meta property="og:description" content="<p>One of the central themes behind Spring 2.5 is comprehensive annotation-based configuration. We’ve been talking and blogging a lot about <strong>@Autowired</strong>, about Spring MVC’s <strong>@RequestMapping</strong> and also about the new support for annotated tests written with JUnit4 or TestNG. <strong>@Autowired</strong> is certainly the central one of Spring 2.5’s annotations, being available for use in service components, web components, unit tests - even domain objects when using Spring’s <strong>@Configurable</strong> with AspectJ weaving. Spring MVC’s <strong>@RequestMapping</strong> is equally flexible, supporting many variants of handler method signatures.</p>
">
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2008-01-28 12:01:00.0">
</head>
<body dir="ltr">

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">// Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }</script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">专案</a>
</li>
<li class="navbar-link">
<a href="/guides">导游</a>
</li>
<li class="navbar-link active">
<a href="/blog">博客</a>
</li>
<li class="navbar-link">
<a href="/services">培训与认证</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索文档，指南和帖子..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">家<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">专案<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">导游<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">博客<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">培训与认证<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>工程</div>
</div>
<div class="blog-category content--title">
<div>发布</div>
</div>
<div class="blog-category content--title">
<div>新闻与活动</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Spring 2.5的全面注释支持</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">工程</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/ba9686d8c567aabedc1b7f8b6a7fb3d6?s=20&d=mm"> <a class="author" rel="author" href="/team/jhoeller">于尔根·霍勒（Juergen Hoeller）</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2008-01-28 12:01:00.0">2008年1月28日</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2008/01/28/spring-2-5-s-comprehensive-annotation-support#disqus_thread" data-disqus-identifier="134">
</a></div>
</div>
</header>
<div class="blog--post"><p>Spring 2.5背后的中心主题之一是全面的基于注释的配置。我们一直在谈论和撰写有关@ <strong>Autowired</strong> ，Spring MVC的<strong>@RequestMapping</strong>以及关于对用JUnit4或TestNG编写的带注释测试的新支持的博客。 <strong>@Autowired</strong>当然是Spring 2.5注释的中心之一，可用于服务组件，Web组件，单元测试-甚至在将Spring的<strong>@Configurable</strong>与AspectJ结合使用时，甚至可以用于域对象。Spring MVC的<strong>@RequestMapping</strong>同样灵活，支持处理程序方法签名的许多变体。</p><p>今天，我想将重点放在另一个方面，即Spring支持的范围广泛的依赖项注入annotation。以下列表包括可在Spring 2.5 bean中使用的关键注释：</p>
<ul>
<li><strong>org.springframework.beans.factory.annotation。必需</strong> ：标识必须调用的bean属性设置器（与可选设置器相对）。从Spring 2.0开始受支持。</li>
<li><strong>org.springframework.beans.factory.annotation。Autowired</strong> ：Spring 2.5的中央注入注释，适用于构造函数，配置方法和字段。通过类型执行组件的注入，并支持“限定符”注释，这些注释可在出现多个匹配项时缩小潜在候选对象的范围。</li>
<li><strong>javax.annotation。PostConstruct</strong> ：Spring所谓的“ init方法”的JSR-250通用注释。</li>
<li><strong>javax.annotation。PreDestroy</strong> ：Spring所谓的“销毁方法”的JSR-250通用注释。</li>
<li><strong>javax.annotation。资源</strong> ：JSR-250的通用注释，用于按名称注入外部组件。JSR-250术语中的“资源”实际上是指中间件组件，例如DataSource。</li>
<li><strong>javax.xml.ws。WebServiceRef</strong> ：@ Resource-like，用于JAX-WS服务查找，注入JAX-WS端口代理。</li>
<li><strong>javax.ejb。EJB</strong> ：类似于@Resource，用于EJB会话Bean查找，注入EJB组件引用。</li>
<li><strong>javax.persistence。PersistenceUnit</strong> ：通过持久性单元名称注入JPA EntityManagerFactory。从Spring 2.0开始受支持。</li>
<li><strong>javax.persistence。PersistenceContext</strong> ：通过持久性单元名称注入JPA EntityManager。从Spring 2.0开始受支持。</li>
</ul><p><br>这组注释包含Java EE 5的所有通用注释，这意味着您可以在Servlet 2.5 Servlet，JSF 1.2托管Bean和Spring托管Bean中使用相同的通用注释。换句话说，如果您有一些带有注释用法的标准JSF 1.2托管Bean，则可以按原样使用它们并将其定义从faces-config移至Spring应用程序上下文，而无需在Bean类中进行任何更改！这是一个重要的设计目标：只需选择<strong>SpringBeanFacesELResolver</strong>作为您的自定义JSF ELResolver，Spring 2.5即可直接替代标准JSF 1.2托管bean工具。</p><p>在配置方面，启用上述完整注释集所需要做的就是在Spring应用程序上下文中使用以下简单配置元素：</p><p><code><br><context:annotation-config/><br></code></p><p>请注意，此设置仅与依赖项注入有关，不需要任何参数化。（对于自定义，请考虑定义Spring的各个AnnotationBeanPostProcessor，例如<strong>CommonAnnotationBeanPostProcessor</strong> ）。然而，注释-config元素<em>不会</em>激活任何一种进行代理或特别出口的。为此，Spring提供了更具体的配置元素：</p><p><code><br><tx:annotation-driven/><br></code></p><p>此设置激活事务注释的处理，在Spring 2.5中开箱即用地支持以下两个变体：</p>
<ul>
<li><strong>org.springframework.transaction.annotation。事务性的</strong> ：Spring自己的事务注释，在Spring 1.2中引入。允许在每个事务级别上指定传播行为（REQUIRED，REQUIRES_NEW等），只读标志，自定义隔离级别（REPEATABLE_READ，SERIALIZABLE等）和自定义回滚规则。</li>
<li><strong>javax.ejb。TransactionAttribute</strong> EJB 3.0的事务注释。除了传播行为（REQUIRED，REQUIRES_NEW等）外，没有其他自定义选项。</li>
</ul><p><br>旁注：与Spring的所有支持选项一样，只有在类路径中实际存在EJB 3.0 API的情况下，EJB 3.0 TransactionAttributeannotation才可用。Spring会自动适应该API的存在，类似于JSR-250 API或JPA API（如上所述）。</p><p>的<strong><tx:annotation-driven></tx:annotation-driven></strong>元素允许特定于事务的配置，例如与Spring PlatformTransactionManager进行对话（通过“ transaction-manager”属性）以及在以下<em>模式下</em>进行操作的<em>模式</em> ：</p><p><code><br><tx:annotation-driven transaction-manager=“myTm” mode=“aspectj”/><br></code></p><p>事务注释处理的显式AspectJ模式是Spring 2.5中的新增功能，允许使用Spring的<strong>AnnotationTransactionAspect</strong>代替传统的AOP代理。这需要AspectJ的编译时编织或加载时编织，修改碰巧使用<strong>@Transactional</strong>注释的类的字节码。这种编织方式可以在任何一种方法上支持注释：公开，受保护或私有-是外部调用还是从对象内部进行调用-事务将始终按照注释指定的顺序进行。这与传统的AOP代理形成鲜明对比，在传统的AOP代理中，注释驱动的事务仅限于通过代理进行的公共方法调用。</p><p>如果您的环境能够进行加载时编织，那么以下配置足以启用AspectJ风格的事务注释处理。请注意，这需要具有内置编织支持的运行时环境（例如WebLogic 10，OC4J 10.1.3.1，使用Spring的TomcatInstrumentableClassLoader配置的Tomcat）或在JVM启动时指定Spring的VM代理（“ -javaagent：spring-agent.jar” ”）。</p><p><code><br><context:load-time-weaver/></code></p><p><code><tx:annotation-driven mode=“aspectj”/></code></p><p><code><bean id=“transactionManager” class=“…”/><br></code></p><p>最后，Spring 2.5还提供了一个方便的配置元素来激活JMX导出。默认的MBeanServer将在所有常见平台上自动检测到，包括标准Java 5平台MBeanServer以及WebLogic 9/10和WebSphere 6公开的特殊MBeanServer。</p><p><code><br><context:mbean-export/><br></code></p><p>然后，Spring管理的Bean可以实现标准的MBean / MXBean约定，根据JMX规范将其限定为MBean类，或者使用以下注释来声明其管理签名（从Spring 1.2开始就知道）：</p>
<ul>
<li><strong>org.springframework.jmx.export.annotation。ManagedResource</strong> ：在类型级别上用于指示JMX暴露的组件。</li>
<li><strong>org.springframework.jmx.export.annotation。ManagedAttribute</strong> ：在bean属性设置器/获取器级别使用，以指示MBean属性。</li>
<li><strong>org.springframework.jmx.export.annotation。ManagedOperation</strong> ：在公共方法级别用于指示出口者MBean操作。</li>
</ul><p><br>这表明了Spring注释配置模型的真正力量：不同的配置问题无缝地合并为一个统一的整体，具有一致的配置样式和统一的组件生命周期-它仍然是一个标准的Spring bean，由Spring ApplicationContext管理！</p><p>通过Spring的核心配置注释进行的简短介绍非常重要。如果您想了解有关Spring 2.5的新功能以及它们如何联系在一起的更多信息，请允许我参加本周三的<a href="http://www.springsource.com/web/guest/webinars">Spring 2.5网络研讨会</a> ，我将介绍Spring 2.5的所有关键功能领域，从Java 6支持到注释基于配置！</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">var disqus_shortname = 'spring-io';
      var disqus_identifier = 134;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));</script>
<noscript>请启用JavaScript以查看<a href="http://disqus.com/?ref_noscript">由Disqus提供</a>的<a href="http://disqus.com/?ref_noscript">评论。</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">由<span class="logo-disqus">Disqus</span>提供动力的评论</a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>背部</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">所有帖子</a> <a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">工程</a> <a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">发布</a> <a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">新闻与活动</a> <a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>将The Spring Team的更新发送到您的收件箱</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });</script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">球队</a></li>
<li><a href="/tools">工具类</a></li>
<li><a href="https://store.pivotal.io/">商店</a></li>
<li><a href="/blog">通讯</a></li>
</ul>
</div>
</div>© <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a> ，Inc.保留所有权利。
<a href="https://pivotal.io/terms-of-use">使用条款</a> • <a href="https://pivotal.io/privacy-policy">隐私</a> • <a href="/trademarks">商标准则</a>
<div id="teconsent" style="display:inline-block"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
<html  data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>Spring .NET 1.1和容器配置</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="Spring .NET 1.1 and container configuration">
<meta name="twitter:description" content="<p>It has been quite a year for Spring.NET. We have gone through two milestone and two release candidates before the GA release in December. The first chunks of code for the 1.1 release were made way back in late 2004 by Aleks Seovic who started work on the ASP.NET framework. In short, it has been a long time in the making. Being the end of year, a natural time for reflection both past and present, I’d like to say thanks to the other members of the project and the Spring.NET community for all their contributions and support. I’m looking forward to a great 2008!</p>
">
<meta name="twitter:image:src" content="https://gravatar.com/avatar/5cffed9a3aad16d33d07f6e7ef2ebbb7?s=200">

<meta property="og:title" content="Spring .NET 1.1 and container configuration">
<meta property="og:image" content="https://gravatar.com/avatar/5cffed9a3aad16d33d07f6e7ef2ebbb7?s=200">
<meta property="og:description" content="<p>It has been quite a year for Spring.NET. We have gone through two milestone and two release candidates before the GA release in December. The first chunks of code for the 1.1 release were made way back in late 2004 by Aleks Seovic who started work on the ASP.NET framework. In short, it has been a long time in the making. Being the end of year, a natural time for reflection both past and present, I’d like to say thanks to the other members of the project and the Spring.NET community for all their contributions and support. I’m looking forward to a great 2008!</p>
">
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2008-01-04 22:01:00.0">
</head>
<body >

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">专案</a>
</li>
<li class="navbar-link">
<a href="/guides">导游</a>
</li>
<li class="navbar-link active">
<a href="/blog">博客</a>
</li>
<li class="navbar-link">
<a href="/services">培训与认证</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索文档，指南和帖子..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">家<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">专案<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">导游<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">博客<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">培训与认证<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>工程</div>
</div>
<div class="blog-category content--title">
<div>发布</div>
</div>
<div class="blog-category content--title">
<div>新闻与活动</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Spring .NET 1.1和容器配置</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">工程</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/5cffed9a3aad16d33d07f6e7ef2ebbb7?s=20&d=mm"> <a class="author" rel="author" href="/team/mpollack">马克·波拉克</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2008-01-04 22:01:00.0">2008年1月4日</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2008/01/04/spring-net-1-1-and-container-configuration#disqus_thread" data-disqus-identifier="125">
</a></div>
</div>
</header>
<div class="blog--post"><p>对于Spring.NET来说已经过去了一年。在12月的GA发布之前，我们经历了两个里程碑和两个候选发布。1.1版的第一批代码早在2004年底由Aleks Seovic制作，他开始研究ASP.NET框架。简而言之，这已经进行了很长时间。在今年年底，这是反思过去和现在的自然时机，我要感谢项目的其他成员和Spring.NET社区的所有贡献和支持。我期待着美好的2008年！</p><p>Spring.NET 1.1的功能集非常广泛。IoC容器依赖注入，AOP，ASP.NET框架，声明式事务管理和<a href="http://www.springframework.net/overview.html">更多</a> 。但是，改善代码的结构和可测试性所能带来的最大好处就是将Dependency Injection和AOP添加到了众所周知的开发人员工具箱中。依赖注入是两者中最基础的技术，我想在配置Spring.NET容器所需的选项中添加一些附加信息。</p><p>显然，配置容器的最常见方法是通过XML。 XML虽然提供了很大的灵活性，但是却很冗长，每个人都有很多时间来畅谈他们讨厌XML配置文件的程度（无论是Spring还是其他）。编写风俗可以极大地减少冗长程度，删除许多样板XML并提供针对特定领域的属性。例如，Spring.NET为此提供了事务管理和AOP配置。但是，在非XML配置方面的一个好消息是，Spring.NET将在其下一个发行版中添加基于属性的DI并自动检测程序集中带注释的类。如您所料，所提供的功能将与Spring Java中的功能非常相似（请参阅<a href="http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#beans-annotation-config">此处</a>和<a href="http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#beans-classpath-scanning">此处</a> ），但会谨慎地加以修改以消除多余的Java构件（例如JSR-250属性）并引入新功能（例如将方法参数名称用于线对名称语义），仅在.NET上才有意义。</p><p>要记住的一件事是核心容器不依赖于基于XML的对象定义。对于这些定义，容器具有自己的内部对象模型。这样，对象定义可以来自多种格式。到目前为止，特别引人注目的是使用DSL工具包配置异常处理建议。其他有趣的配置方法是使用脚本语言DSL（有关Spring Java + Groovy集成，请参阅此<a href="http://blog.interface21.com/main/2007/11/29/spring-dynamic-language-support-and-a-groovy-dsl/">帖子</a> ）。最终，目标是让您为当前任务选择多种配置方法。</p><p>在当前版本中，有一些与程序控制和容器配置有关的功能似乎并不为人们所熟知。这里是这些功能的简要概述。我将在参考文档中尽快添加更完整的描述。</p>
<h4>配置现有对象</h4><p>IoC容器的主要接口<tt>IApplicationContext</tt>包含方法<br><code lang="C#">ConfigureObject(object objectToConfigure, string objectDefnitionName)</code></p><p>基于与名称关联的对象定义，容器将对传入的实例执行依赖项注入。当您需要在运行时响应用户请求创建对象时，此功能特别有用。在这种情况下，通常会将一些情况唯一的数据传递给构造函数，然后让容器配置所有用户请求共有的其余对象依赖项。</p>
<h4>将现有对象注册为单例</h4><p>此功能在<tt>IApplicationContext</tt>的子接口<tt>IConfigurableApplicationContext上定义</tt> 。调用代码如下所示</p><p><code lang="C#">((IConfigurableApplicationContext) applicationContext).ObjectFactory.RegisterSingleton(“ObjectB”, myObjectBInstance);</code></p><p>注册的对象将不会被修改；它只是按提供的名称原样存储。但是，其他对象可能将此注册对象称为依赖项。</p>
<h4>通过名称和类型检索对象</h4><p>通过名称检索对象很简单</p><p><code lang="c#">object o = applicationContext.GetObject(“AccountManager”)</code></p><p>然后转换为适当的类型。您也可以按类型要求对象</p><p><code lang="c#">IDictionary dict = context.GetObjectsOfType(typeof (IAccountManager));</code></p><p>这些API调用需要通过添加使其具有通用性以及提供一种便捷方法来获取指定类型的单个对象而不是集合来进行一些TLC。</p>
<h4>容器的程序配置</h4><p>类<tt>GenericApplicationContext</tt>是一个IoC容器，它不采用任何特定的对象定义格式。您可以像这样从嵌入式资源中使用基于XML的对象定义来加载它</p><p><code lang="c#">GenericApplicationContext ctx = new GenericApplicationContext();</code></p><p><code lang="c#">IObjectDefinitionReader objectDefinitionReader = new XmlObjectDefinitionReader(ctx);<br> objectDefinitionReader.LoadObjectDefinitions("<a href="assembly://MovieFinder/AppContextContribution.xml" )">assembly://MovieFinder/AppContextContribution.xml")</a>;<br></code></p><p>然后，您可以将使用<tt>ObjectDefinitionBuilder</tt>构建的其他对象定义添加到上下文中。<tt>ObjectDefinitionBuilder</tt>提供了一个简单的流利的界面来简化对象定义的创建。这样， <tt>ObjectDefinitionBuilder</tt>允许您将方法调用链接在一起，以创建一个对象定义，该对象定义大致对应于您在Spring XML中熟悉的元素。</p><p><code lang="c#">IObjectDefinitionFactory objectDefinitionFactory = new DefaultObjectDefinitionFactory();</code></p><p><code lang="c#">ObjectDefinitionBuilder builder =<br> ObjectDefinitionBuilder.RootObjectDefinition(objectDefinitionFactory, typeof(ColonDelimitedMovieFinder));</code></p><p><code lang="c#">builder.AddConstructorArg(“movies.txt”)<br> .SetLazyInit(true);</code></p><p><code lang="c#">ctx.RegisterObjectDefinition(“AnotherMovieFinder”, builder.ObjectDefinition);<br>// process object definitions…<br>ctx.Refresh()<br></code></p><p>此代码是从更新的“ MovieFinder”示例中提取的，您可以从每晚的版本中下载该示例。附带说明一下， <tt>IObjectDefinitionFactory</tt>还有另一个替代实现<tt>WebObjectDefinitionFactory</tt> ，可与ASP.NET页和用户控件一起使用，尽管在这种情况下您不太可能使用它。</p><p>这是使用<tt>TestObject</tt>类的另一个人工示例，该示例显示了更多的<tt>ObjectDefinitionBuilder</tt> API。</p><p><code lang="c#">ObjectDefinitionBuilder builder = ObjectDefinitionBuilder.RootObjectDefinition(objectDefinitionFactory, typeof (TestObject));</code></p><p><code lang="c#">builder.AddPropertyValue(“Age”, 22)<br> .AddPropertyValue(“Name”, “Joe”)<br> .AddPropertyReference(“Spouse”, “Spouse”)<br> .SetSingleton(false);</code></p><p><code lang="c#">ctx.RegisterObjectDefinition(“TestObject”, builder.ObjectDefinition);</code></p><p><code lang="c#">builder = ObjectDefinitionBuilder.RootObjectDefinition(objectDefinitionFactory, typeof(TestObject));</code></p><p><code lang="c#">IList friends = new ArrayList();<br>friends.Add(new TestObject(“Dan”, 34));<br>friends.Add(new TestObject(“Mary”, 33));</code></p><p><code lang="c#">builder.AddPropertyValue(“Friends”, friends)<br> .AddConstructorArg(“Susan”)<br> .AddConstructorArg(23)<br> .SetSingleton(false);</code></p><p><code lang="c#">ctx.RegisterObjectDefinition(“Spouse”, builder.ObjectDefinition);<br></code></p><p>如果您已经具有基于XML的应用程序上下文，则可以将其传递给<tt>GenericApplicationContext</tt>的构造函数，这意味着它将在简单的根/子层次结构中作用于后者的父应用程序上下文。您还可以使用名称来向<tt>ContextRegistry</tt>注册上下文，以提供服务定位符样式查找。</p><p><tt>照原样</tt> ， <tt>ObjectDefinitionBuilder</tt> API相当“严格”，这意味着虽然可以注册对象以按“类型”进行布线，但它比所需的更为冗长。改善此API的“流畅性”是未来版本中另一个需要改进的地方。</p><p>好吧，这就是现在所有的人。祝新年快乐！</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 125;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>请启用JavaScript以查看<a href="http://disqus.com/?ref_noscript">由Disqus提供</a>的<a href="http://disqus.com/?ref_noscript">评论。</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">由<span class="logo-disqus">Disqus</span>提供动力的评论</a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>背部</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">所有帖子</a> <a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">工程</a> <a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">发布</a> <a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">新闻与活动</a> <a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>将The Spring Team的更新发送到您的收件箱</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">球队</a></li>
<li><a href="/tools">工具类</a></li>
<li><a href="https://store.pivotal.io/">商店</a></li>
<li><a href="/blog">通讯</a></li>
</ul>
</div>
</div>© <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a> ，Inc.保留所有权利。
<a href="https://pivotal.io/terms-of-use">使用条款</a> • <a href="https://pivotal.io/privacy-policy">隐私</a> • <a href="/trademarks">商标准则</a>
<div id="teconsent" style="display:inline-block"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
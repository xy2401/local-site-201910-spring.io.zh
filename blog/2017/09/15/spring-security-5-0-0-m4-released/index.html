<html  data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>Spring Security 5.0.0 M4 Released</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="Spring Security 5.0.0 M4 Released">
<meta name="twitter:description" content="<div class=" paragrap="="> 
 </head><body ><p>On behalf of the community, I’m pleased to announce the release of Spring Security 5.0.0 M4. This release includes bug fixes, new features, and is based off of Spring Framework 5.0.0 RC4. You can find complete details in the <a href="https://github.com/spring-projects/spring-security/milestone/101?closed=1">changelog</a>. The highlights of the release include:</p> 

<div class="ulist"> 
 <ul> 
  <li> <p><a href="#oauth2-oidc">OAuth2 / OIDC</a></p> 
   <div class="ulist"> 
    <ul> 
     <li> <p><a href="#oauth2-login-java-config">OAuth2 Login Java Config</a></p> </li> 
     <li> <p><a href="#security-token-repository">Security Token Repository</a></p> </li> 
     <li> <p><a href="#id-token-and-claims">ID Token and Claims</a></p> </li> 
     <li> <p><a href="#authorization-request-improvements">Authorization Request Improvements</a></p> </li> 
     <li> <p><a href="#oauth2-client-properties">OAuth2 Client Properties</a></p> </li> 
    </ul> 
   </div> </li> 
  <li> <p><a href="#reactive-security">Reactive Security</a></p> 
   <div class="ulist"> 
    <ul> 
     <li> <p><a href="#reactive-method-security">Reactive Method Security</a></p> </li> 
     <li> <p><a href="#webflux-form-log-in">WebFlux Form Log In</a></p> </li> 
     <li> <p><a href="#webflux-content-negotiation">WebFlux Content Negotiation</a></p> </li> 
     <li> <p><a href="#webflux-session-optimizations">WebFlux Session Optimizations</a></p> </li> 
    </ul> 
   </div> </li> 
 </ul> 
</div>
">
<meta name="twitter:creator" content="@rob_winch">
<meta name="twitter:image:src" content="https://gravatar.com/avatar/30ed046efb35c67d4c055dab109b8933?s=200">

<meta property="og:title" content="Spring Security 5.0.0 M4 Released">
<meta property="og:image" content="https://gravatar.com/avatar/30ed046efb35c67d4c055dab109b8933?s=200">
<meta property="og:description" content="<div class=" paragrap="="> 
 <p>On behalf of the community, I’m pleased to announce the release of Spring Security 5.0.0 M4. This release includes bug fixes, new features, and is based off of Spring Framework 5.0.0 RC4. You can find complete details in the <a href="https://github.com/spring-projects/spring-security/milestone/101?closed=1">changelog</a>. The highlights of the release include:</p> 

<div class="ulist"> 
 <ul> 
  <li> <p><a href="#oauth2-oidc">OAuth2 / OIDC</a></p> 
   <div class="ulist"> 
    <ul> 
     <li> <p><a href="#oauth2-login-java-config">OAuth2 Login Java Config</a></p> </li> 
     <li> <p><a href="#security-token-repository">Security Token Repository</a></p> </li> 
     <li> <p><a href="#id-token-and-claims">ID Token and Claims</a></p> </li> 
     <li> <p><a href="#authorization-request-improvements">Authorization Request Improvements</a></p> </li> 
     <li> <p><a href="#oauth2-client-properties">OAuth2 Client Properties</a></p> </li> 
    </ul> 
   </div> </li> 
  <li> <p><a href="#reactive-security">Reactive Security</a></p> 
   <div class="ulist"> 
    <ul> 
     <li> <p><a href="#reactive-method-security">Reactive Method Security</a></p> </li> 
     <li> <p><a href="#webflux-form-log-in">WebFlux Form Log In</a></p> </li> 
     <li> <p><a href="#webflux-content-negotiation">WebFlux Content Negotiation</a></p> </li> 
     <li> <p><a href="#webflux-session-optimizations">WebFlux Session Optimizations</a></p> </li> 
    </ul> 
   </div> </li> 
 </ul> 
</div>
">
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2017-09-15 12:42:00.0">



<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category content--title">
<div>Engineering</div>
</div>
<div class="blog-category active content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Spring Security 5.0.0 M4 Released</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon releases"></div>
<a class="category">Releases</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/30ed046efb35c67d4c055dab109b8933?s=20&d=mm">
<a class="author" rel="author" href="/team/rwinch">Rob Winch</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2017-09-15 12:42:00.0">September 15, 2017</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2017/09/15/spring-security-5-0-0-m4-released#disqus_thread" data-disqus-identifier="3024">
</a></div>
</div>
</header>
<div class="blog--post"><div class="paragraph">
<p>On behalf of the community, I’m pleased to announce the release of Spring Security 5.0.0 M4. This release includes bug fixes, new features, and is based off of Spring Framework 5.0.0 RC4. You can find complete details in the <a href="https://github.com/spring-projects/spring-security/milestone/101?closed=1">changelog</a>. The highlights of the release include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#oauth2-oidc">OAuth2 / OIDC</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="#oauth2-login-java-config">OAuth2 Login Java Config</a></p>
</li>
<li>
<p><a href="#security-token-repository">Security Token Repository</a></p>
</li>
<li>
<p><a href="#id-token-and-claims">ID Token and Claims</a></p>
</li>
<li>
<p><a href="#authorization-request-improvements">Authorization Request Improvements</a></p>
</li>
<li>
<p><a href="#oauth2-client-properties">OAuth2 Client Properties</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#reactive-security">Reactive Security</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="#reactive-method-security">Reactive Method Security</a></p>
</li>
<li>
<p><a href="#webflux-form-log-in">WebFlux Form Log In</a></p>
</li>
<li>
<p><a href="#webflux-content-negotiation">WebFlux Content Negotiation</a></p>
</li>
<li>
<p><a href="#webflux-session-optimizations">WebFlux Session Optimizations</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<h1 id="oauth2-oidc" class="sect0"><a class="anchor" href="#oauth2-oidc"></a>OAuth2 / OIDC</h1>
<div class="sect1">
<h2 id="oauth2-login-java-config"><a class="anchor" href="#oauth2-login-java-config"></a>OAuth2 Login Java Config</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are a number of improvements to the <code>HttpSecurity.oauth2Login()</code> DSL.</p>
</div>
<div class="paragraph">
<p>You can now configure the <em>Token Endpoint</em> with a custom implementation of an <code>AuthorizationGrantTokenExchanger</code> or <code>SecurityTokenRepository<AccessToken></code>, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">protected void configure(HttpSecurity http) throws Exception {
  http
    .authorizeRequests()
      .anyRequest().authenticated()
      .and()
    .oauth2Login()
      .tokenEndpoint()
        .authorizationCodeTokenExchanger(this.authorizationCodeTokenExchanger())
	.accessTokenRepository(this.accessTokenRepository());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We’ve also added the capability of customizing the request paths for the <em>Authorization Endpoint</em> and <em>Redirection Endpoint</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">protected void configure(HttpSecurity http) throws Exception {
  http
    .authorizeRequests()
      .anyRequest().authenticated()
      .and()
    .oauth2Login()
      .authorizationEndpoint()
        .requestMatcher(new AntPathRequestMatcher("/custom-path/{clientAlias}"))
        .and()
      .redirectionEndpoint()
        .requestMatcher(new AntPathRequestMatcher("/custom-path/callback/{clientAlias}"));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As with all <code>AbstractAuthenticationProcessingFilter</code> 's in Spring Security, you can also set a custom <code>AuthenticationSuccessHandler</code> and <code>AuthenticationFailureHandler</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">protected void configure(HttpSecurity http) throws Exception {
  http
    .authorizeRequests()
      .anyRequest().authenticated()
      .and()
     .oauth2Login()
       .successHandler(this.customAuthenticationSuccessHandler())
       .failureHandler(this.customAuthenticationFailureHandler());
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security-token-repository"><a class="anchor" href="#security-token-repository"></a>Security Token Repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We’ve introduced the <code>SecurityTokenRepository<T extends SecurityToken></code> abstraction, which is responsible for the persistence of <code>SecurityToken</code> 's.</p>
</div>
<div class="paragraph">
<p>The initial implementation <code>InMemoryAccessTokenRepository</code> provides the persistence of <code>AccessToken</code> 's.
In an upcoming release we’ll also provide an implementation that supports the persistence of <em>Refresh Token’s</em>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="id-token-and-claims"><a class="anchor" href="#id-token-and-claims"></a>ID Token and Claims</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A couple of minor improvements were introduced to the <code>IdToken</code> along with some final implementation details for <code>JwtClaimAccessor</code>,
<code>StandardClaimAccessor</code> and <code>IdTokenClaimAccessor</code>, which provide convenient access to <code>claims</code> in their associated constructs, for example, <code>Jwt</code>, <code>IdToken</code>, <code>UserInfo</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="authorization-request-improvements"><a class="anchor" href="#authorization-request-improvements"></a>Authorization Request Improvements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We’ve added the capability for an <code>AuthorizationRequestRepository</code> to persist the <em>Authorization Request</em> to a <code>Cookie</code>.
The current default implementation persists in the <code>HttpSession</code>, however, a custom implementation may be provided to persist to a <code>Cookie</code> instead.</p>
</div>
<div class="paragraph">
<p>Support was also added for <code>URI</code> variables configured in the <code>redirect-uri</code> for the <code>AuthorizationCodeRequestRedirectFilter</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="oauth2-client-properties"><a class="anchor" href="#oauth2-client-properties"></a>OAuth2 Client Properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There were a couple of minor updates to the properties for configuring an OAuth 2.0 Client. The configuration below outlines the current structure.
You will notice that there is support for configuring multiple clients, for example, google, github, okta, etc.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-yml" data-lang="yml">security:
  oauth2:
    client:
      google:
        client-id: your-app-client-id
        client-secret: your-app-client-secret
        client-authentication-method: basic
        authorization-grant-type: authorization_code
        redirect-uri: "{scheme}://{serverName}:{serverPort}{contextPath}/oauth2/authorize/code/{clientAlias}"
        scope: openid, profile, email, address, phone
        authorization-uri: "https://accounts.google.com/o/oauth2/v2/auth"
        token-uri: "https://www.googleapis.com/oauth2/v4/token"
        user-info-uri: "https://www.googleapis.com/oauth2/v3/userinfo"
        user-name-attribute-name: "sub"
        jwk-set-uri: "https://www.googleapis.com/oauth2/v3/certs"
        client-name: Google
        client-alias: google
      github:
        ...
      okta:
        ...</code></pre>
</div>
</div>
<hr>
<div class="paragraph">
<p>A complete example for using the new Spring Security OAuth 2.0 / OpenID Connect 1.0
login feature can be found in the Spring Security samples at
<a href="https://github.com/spring-projects/spring-security/tree/5.0.0.M4/samples/boot/oauth2login">oauth2login</a>.
The guide will walk you through the steps for setting up the sample application
for OAuth 2.0 login using an external OAuth 2.0 or OpenID Connect 1.0 Provider.</p>
</div>
</div>
</div>
<h1 id="reactive-security" class="sect0"><a class="anchor" href="#reactive-security"></a>Reactive Security</h1>
<div class="sect1">
<h2 id="reactive-method-security"><a class="anchor" href="#reactive-method-security"></a>Reactive Method Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Security’s Reactive support now includes method security by leveraging Reactor’s Context. The highlights are below, but you can find a complete example of it in action in <a href="https://github.com/spring-projects/spring-security/tree/5.0.0.M4/samples/javaconfig/hellowebflux-method">samples/javaconfig/hellowebflux-method</a></p>
</div>
<div class="paragraph">
<p>The first step is to use <code>@EnableReactiveMethodSecurity</code> to enable support for <code>@PreAuthorize</code> and <code>@PostAuthorize</code> annotations. This step ensures that the objects are properly proxied.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@EnableWebFluxSecurity
@EnableReactiveMethodSecurity
public class SecurityConfig {</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next step is to create a service that is annotated with <code>@PreAuthorize</code> or <code>@PostAuthorize</code>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@PreAuthorize("hasRole('ADMIN')")
public Mono&lt;String&gt; findMessage() {</code></pre>
</div>
</div>
<div class="paragraph">
<p>Spring Security’s WebFlux support will then ensure that the Reactor Context will be populated with the current user which is used to determine if access is granted or denied.</p>
</div>
<div class="paragraph">
<p>Spring Security’s standard <code>@WithMockUser</code> and <a href="https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#test-method">related annotations</a> has been updated to work with Reactive Method Security. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@RunWith(SpringRunner.class)
// ...
public class HelloWorldMessageServiceTests {
  @Autowired
  HelloWorldMessageService messages;

  @Test
  public void messagesWhenNotAuthenticatedThenDenied() {
    StepVerifier.create(this.messages.findMessage())
      .expectError(AccessDeniedException.class)
      .verify();
  }

  @Test
  @WithMockUser
  public void messagesWhenUserThenDenied() {
    StepVerifier.create(this.messages.findMessage())
      .expectError(AccessDeniedException.class)
      .verify();
  }

  @Test
  @WithMockUser(roles = "ADMIN")
  public void messagesWhenAdminThenOk() {
    StepVerifier.create(this.messages.findMessage())
      .expectNext("Hello World!")
      .verifyComplete();
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The test support also works nicely with <code>TestWebClient</code>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@RunWith(SpringRunner.class)
// ...
public class HelloWebfluxMethodApplicationTests {
  @Autowired
  ApplicationContext context;

  WebTestClient rest;

  @Before
  public void setup() {
    this.rest = WebTestClient
      .bindToApplicationContext(this.context)
      // Setup Spring Security Test Support
      .apply(springSecurity())
      .configureClient()
      .filter(basicAuthentication())
      .build();
  }

  @Test
  public void messageWhenNotAuthenticated() throws Exception {
    this.rest
      .get()
      .uri("/message")
      .exchange()
      .expectStatus().isUnauthorized();
  }

  // --- authenticate with HTTP Basic ---

  @Test
  public void messageWhenUserThenForbidden() throws Exception {
    this.rest
      .get()
      .uri("/message")
      .attributes(robsCredentials())
      .exchange()
      .expectStatus().isEqualTo(HttpStatus.FORBIDDEN)
      .expectBody().isEmpty();
  }

  @Test
  public void messageWhenAdminThenOk() throws Exception {
    this.rest
      .get()
      .uri("/message")
      .attributes(adminCredentials())
      .exchange()
      .expectStatus().isOk()
      .expectBody(String.class).isEqualTo("Hello World!");
  }

  // --- Use @WithMockUser ---

  @Test
  @WithMockUser
  public void messageWhenWithMockUserThenForbidden() throws Exception {
    this.rest
      .get()
      .uri("/message")
      .exchange()
      .expectStatus().isEqualTo(HttpStatus.FORBIDDEN)
      .expectBody().isEmpty();
  }

  @Test
  @WithMockUser(roles = "ADMIN")
  public void messageWhenWithMockAdminThenOk() throws Exception {
    this.rest
      .get()
      .uri("/message")
      .exchange()
      .expectStatus().isOk()
      .expectBody(String.class).isEqualTo("Hello World!");
  }

  // --- Use mutateWith ---

  @Test
  public void messageWhenMockUserThenForbidden() throws Exception {
    this.rest
      .mutateWith(mockUser())
      .get()
      .uri("/message")
      .exchange()
      .expectStatus().isEqualTo(HttpStatus.FORBIDDEN)
      .expectBody().isEmpty();
  }

  @Test
  public void messageWhenMockAdminThenOk() throws Exception {
    this.rest
      .mutateWith(mockUser().roles("ADMIN"))
      .get()
      .uri("/message")
      .exchange()
      .expectStatus().isOk()
      .expectBody(String.class).isEqualTo("Hello World!");
  }

  // ...


}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="webflux-form-log-in"><a class="anchor" href="#webflux-form-log-in"></a>WebFlux Form Log In</h2>
<div class="sectionbody">
<div class="paragraph">
<p>WebFlux security now supports form based log in and provides a default log in page to ease getting started. For example, the <a href="https://github.com/spring-projects/spring-security/tree/5.0.0.M4/samples/javaconfig/hellowebflux-method">samples/javaconfig/hellowebflux[samples/javaconfig/hellowebflux</a> allows users to authenticate using form based log in with a default log in page.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@EnableWebFluxSecurity
public class HelloWebfluxSecurityConfig {

  @Bean
  public MapUserDetailsRepository userDetailsRepository() {
    UserDetails user = User.withUsername("user")
      .password("user")
      .roles("USER")
      .build();
    return new MapUserDetailsRepository(user);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We decided to make the default log in page link to an external CSS file to make it look nicer without needing to bundle CSS. What do you think?</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://user-images.githubusercontent.com/362503/30441057-e755170a-993d-11e7-9709-b100dd1432ce.png" alt="Default Log In Page">
</div>
</div>
<div class="paragraph">
<p>If you are not connected to the internet, the log in page falls back to an unstyled page. Of course, you can provide your own custom log in page as well.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="webflux-content-negotiation"><a class="anchor" href="#webflux-content-negotiation"></a>WebFlux Content Negotiation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Similar to the servlet world, we have also added content negotiation support for WebFlux security. For example, when requesting a protected resource without being authenticated our minimal example from <a href="#webflux-form-log-in">WebFlux Form Log In</a> will produce a log in page in a web browser and a <code>WWW-Authenticate</code> response from a command line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-http" data-lang="http">---
HTTP/1.1 401 Unauthorized
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Expires: 0
Pragma: no-cache
WWW-Authenticate: Basic realm="Realm"
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
X-XSS-Protection: 1 ; mode=block
content-length: 0</code></pre>
</div>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="webflux-session-optimizations"><a class="anchor" href="#webflux-session-optimizations"></a>WebFlux Session Optimizations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We have refined the way WebFlux authentication and session management works to give greater flexability than the servlet counterpart. For example, our minimal example from <a href="#webflux-form-log-in">WebFlux Form Log In</a> will produce the following result when authenticating using form based log in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-http" data-lang="http">POST /login HTTP/1.1
Accept: */*
Accept-Encoding: gzip, deflate
Connection: keep-alive
Content-Length: 27
Content-Type: application/x-www-form-urlencoded; charset=utf-8
Host: localhost:8080

username=user&amp;password=user

HTTP/1.1 302 Found
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Expires: 0
Location: /
Pragma: no-cache
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
X-XSS-Protection: 1 ; mode=block
content-length: 0
set-cookie: SESSION=1e04aa3c-5a15-42ed-9e25-933fd0e44b2a; HTTPOnly</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, the very same code will produce the following response for HTTP Basic authentication</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-http" data-lang="http">GET / HTTP/1.1
Accept: */*
Accept-Encoding: gzip, deflate
Authorization: Basic dXNlcjp1c2Vy
Connection: keep-alive
Host: localhost:8080



HTTP/1.1 200 OK
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Content-Type: application/json;charset=UTF-8
Expires: 0
Pragma: no-cache
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
X-XSS-Protection: 1 ; mode=block
transfer-encoding: chunked

{
    "message": "Hello user!"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the form based login has a SESSION cookie in the response, but HTTP Basic does not. This is done with a single <code>HttpSecurity</code> configuration (we are splitting the application into slices).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="feedback-please"><a class="anchor" href="#feedback-please"></a>Feedback Please</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you have feedback on this release, I encourage you to reach out via <a href="https://stackoverflow.com/questions/tagged/spring-security">StackOverflow</a>, <a href="https://github.com/spring-projects/spring-security/issues">GitHub Issues</a>, or via the comments section. You can also ping me <a href="https://twitter.com/rob_winch">@rob_winch</a> or Joe <a href="https://twitter.com/joe_grandja">@joe_grandja</a> on Twitter.</p>
</div>
<div class="paragraph">
<p>Of course the best feedback comes in the form of <a href="https://github.com/spring-projects/spring-security/blob/5.0.0.M4/CONTRIBUTING.md">contributions</a>.</p>
</div>
<div class="paragraph">
<p><a href="https://projects.spring.io/spring-security/">Project Site</a> | <a href="https://docs.spring.io/spring-security/site/docs/5.0.0.M4/reference/htmlsingle/">Reference</a> | <a href="https://docs.spring.io/spring-security/site/docs/current/guides/html5/">Guides</a> | <a href="https://stackoverflow.com/questions/tagged/spring-security">Help</a></p>
</div>
</div>
</div></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 3024;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
© <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> •
<a href="https://pivotal.io/privacy-policy">Privacy</a> •
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
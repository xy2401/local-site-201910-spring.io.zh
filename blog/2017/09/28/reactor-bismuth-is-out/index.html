<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>Reactor Bismuth is out</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="Reactor Bismuth is out" />
<meta name="twitter:description" content="&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;It is my great pleasure to announce the GA release of &lt;strong&gt;Reactor Bismuth&lt;/strong&gt;, which notably encompasses &lt;code&gt;reactor-core&lt;/code&gt; &lt;strong&gt;3.1.0.RELEASE&lt;/strong&gt; and &lt;code&gt;reactor-netty&lt;/code&gt; &lt;strong&gt;0.7.0.RELEASE&lt;/strong&gt; ðŸŽ‰&lt;/p&gt; 
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;With the release of &lt;a href=&quot;https://spring.io/blog/2017/09/28/spring-framework-5-0-goes-ga&quot;&gt;Spring Framework 5.0&lt;/a&gt; now just happening, you can imagine this is a giant step for Project Reactor :)&lt;/p&gt; 
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt; 
 &lt;div class=&quot;content&quot;&gt; 
  &lt;img src=&quot;https://farm2.staticflickr.com/1434/5109110719_6f10365d85_m_d.jpg&quot; alt=&quot;bismuth crystal&quot; width=&quot;300&quot; height=&quot;200&quot;&gt; 
 &lt;/div&gt; 
 &lt;div class=&quot;title&quot;&gt;
  &lt;em&gt;Like the bismuth crystal this release is intricate&lt;/em&gt;
 &lt;/div&gt; 
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;&amp;nbsp;&lt;br&gt; The release contains a lot of changes and API polishing. For reactor-core you can find the exhaustive list in the &lt;a href=&quot;https://github.com/reactor/reactor-core/releases/tag/v3.1.0.RELEASE&quot;&gt;release notes&lt;/a&gt;.&lt;/p&gt; 
&lt;/div&gt;
&lt;div class=&quot;admonitionblock important&quot;&gt; 
 &lt;table&gt; 
  &lt;tbody&gt;
   &lt;tr&gt; 
    &lt;td class=&quot;icon&quot;&gt; 
     &lt;div class=&quot;title&quot;&gt;
      Important
     &lt;/div&gt; &lt;/td&gt; 
    &lt;td class=&quot;content&quot;&gt; There is a &lt;strong&gt;known (minor) issue&lt;/strong&gt; with the &lt;code&gt;reactor-core&lt;/code&gt; and &lt;code&gt;reactor-test&lt;/code&gt; &lt;strong&gt;sources&lt;/strong&gt; jars: They contain duplicate java source entries. See issue &lt;a href=&quot;https://github.com/reactor/reactor-core/issues/887&quot;&gt;#887&lt;/a&gt; for more details. &lt;/td&gt; 
   &lt;/tr&gt; 
  &lt;/tbody&gt;
 &lt;/table&gt; 
&lt;/div&gt;
" />
<meta name="twitter:creator" content="@simonbasle" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/056097e00486bcdf172708607f194b1e?s=200" />

<meta property="og:title" content="Reactor Bismuth is out" />
<meta property="og:image" content="https://gravatar.com/avatar/056097e00486bcdf172708607f194b1e?s=200" />
<meta property="og:description" content="&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;It is my great pleasure to announce the GA release of &lt;strong&gt;Reactor Bismuth&lt;/strong&gt;, which notably encompasses &lt;code&gt;reactor-core&lt;/code&gt; &lt;strong&gt;3.1.0.RELEASE&lt;/strong&gt; and &lt;code&gt;reactor-netty&lt;/code&gt; &lt;strong&gt;0.7.0.RELEASE&lt;/strong&gt; ðŸŽ‰&lt;/p&gt; 
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;With the release of &lt;a href=&quot;https://spring.io/blog/2017/09/28/spring-framework-5-0-goes-ga&quot;&gt;Spring Framework 5.0&lt;/a&gt; now just happening, you can imagine this is a giant step for Project Reactor :)&lt;/p&gt; 
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt; 
 &lt;div class=&quot;content&quot;&gt; 
  &lt;img src=&quot;https://farm2.staticflickr.com/1434/5109110719_6f10365d85_m_d.jpg&quot; alt=&quot;bismuth crystal&quot; width=&quot;300&quot; height=&quot;200&quot;&gt; 
 &lt;/div&gt; 
 &lt;div class=&quot;title&quot;&gt;
  &lt;em&gt;Like the bismuth crystal this release is intricate&lt;/em&gt;
 &lt;/div&gt; 
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;&amp;nbsp;&lt;br&gt; The release contains a lot of changes and API polishing. For reactor-core you can find the exhaustive list in the &lt;a href=&quot;https://github.com/reactor/reactor-core/releases/tag/v3.1.0.RELEASE&quot;&gt;release notes&lt;/a&gt;.&lt;/p&gt; 
&lt;/div&gt;
&lt;div class=&quot;admonitionblock important&quot;&gt; 
 &lt;table&gt; 
  &lt;tbody&gt;
   &lt;tr&gt; 
    &lt;td class=&quot;icon&quot;&gt; 
     &lt;div class=&quot;title&quot;&gt;
      Important
     &lt;/div&gt; &lt;/td&gt; 
    &lt;td class=&quot;content&quot;&gt; There is a &lt;strong&gt;known (minor) issue&lt;/strong&gt; with the &lt;code&gt;reactor-core&lt;/code&gt; and &lt;code&gt;reactor-test&lt;/code&gt; &lt;strong&gt;sources&lt;/strong&gt; jars: They contain duplicate java source entries. See issue &lt;a href=&quot;https://github.com/reactor/reactor-core/issues/887&quot;&gt;#887&lt;/a&gt; for more details. &lt;/td&gt; 
   &lt;/tr&gt; 
  &lt;/tbody&gt;
 &lt;/table&gt; 
&lt;/div&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2017-09-28 15:08:20.37" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category content--title">
<div>Engineering</div>
</div>
<div class="blog-category active content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Reactor Bismuth is out</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon releases"></div>
<a class="category">Releases</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/056097e00486bcdf172708607f194b1e?s=20&amp;d=mm" />
<a class="author" rel="author" href="/team/simonbasle">Simon BaslÃ©</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2017-09-28 15:08:20.37">September 28, 2017</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="3046" href="/blog/2017/09/28/reactor-bismuth-is-out#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><div class="paragraph">
<p>It is my great pleasure to announce the GA release of <strong>Reactor Bismuth</strong>, which
notably encompasses <code>reactor-core</code> <strong>3.1.0.RELEASE</strong> and <code>reactor-netty</code>
<strong>0.7.0.RELEASE</strong> ðŸŽ‰</p>
</div>
<div class="paragraph">
<p>With the release of
<a href="https://spring.io/blog/2017/09/28/spring-framework-5-0-goes-ga">Spring Framework 5.0</a>
now just happening, you can imagine this is a giant step for Project Reactor :)</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://farm2.staticflickr.com/1434/5109110719_6f10365d85_m_d.jpg" alt="bismuth crystal" width="300" height="200">
</div>
<div class="title"><em>Like the bismuth crystal this release is intricate</em></div>
</div>
<div class="paragraph">
<p>&nbsp;<br>
The release contains a lot of changes and API polishing. For reactor-core you
can find the exhaustive list in the
<a href="https://github.com/reactor/reactor-core/releases/tag/v3.1.0.RELEASE">release notes</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
There is a <strong>known (minor) issue</strong> with the <code>reactor-core</code> and
<code>reactor-test</code> <strong>sources</strong> jars: They contain duplicate java source entries.
See issue <a href="https://github.com/reactor/reactor-core/issues/887">#887</a> for more details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s have an overview of what is new and noteworthy in this release:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api">API Final Polishing</a></p>
</li>
<li>
<p><a href="#moved">Reactor-Test And Kotlin Extensions Moved</a></p>
</li>
<li>
<p><a href="#kotlin-null-safety">Kotlin And Null-Safety Support</a></p>
</li>
<li>
<p><a href="#docs">Documentation Polishing</a></p>
</li>
<li>
<p>The major new feature in this release: <a href="#context">The <code>Context</code></a></p>
</li>
<li>
<p><a href="#other-new">Other Interesting New Features</a></p>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="api"><a class="anchor" href="#api"></a>API Final Polishing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A number of API changes have been made between the last release in the 3.0.x
cycle and 3.1.0. We wanted to get the best API out for the long run with Spring
Framework 5, so these breaking changes were necessary. The release notes contain
a more exhaustive list of such changes, but let&#8217;s have a look at a few of them.</p>
</div>
<div class="sect2">
<h3 id="error-handling-operators"><a class="anchor" href="#error-handling-operators"></a>Error Handling Operators</h3>
<div class="paragraph">
<p>The error handling operators have been made more consistent in both <code>Flux</code> and
<code>Mono</code>. All use the <code>onError</code> prefix and the APIs are aligned in both classes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>onErrorReturn</strong> to switch to a fall-back value (formerly <code>otherwiseReturn</code> in
Mono)</p>
</li>
<li>
<p><strong>onErrorResume</strong> to switch to a fall-back <code>Publisher</code> (formerly <code>onErrorResumeWith</code>
in Flux and <code>otherwise</code> in Mono)</p>
</li>
<li>
<p><strong>onErrorMap</strong> to translate an <code>Exception</code> into another one (formerly <code>mapError</code>
in both Flux and Mono)</p>
</li>
<li>
<p><strong>switchIfEmpty</strong> to switch to a fall-back sequence if the source is empty
(formerly <code>otherwiseIfEmpty</code> in <code>Mono</code>)</p>
</li>
<li>
<p><code>Flux#switchOnError</code> has been removed, the same can be achieved with
<code>onErrorResume</code> using a lambda that ignores its parameter.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="alignment-between-code-flux-code-and-code-mono-code-concepts-and-operators"><a class="anchor" href="#alignment-between-code-flux-code-and-code-mono-code-concepts-and-operators"></a>Alignment Between <code>Flux</code> And <code>Mono</code> Concepts And Operators</h3>
<div class="paragraph">
<p><code>Mono</code> API had a tendency to sometimes divert from the <code>Flux</code> API despite similar
concepts. Where it makes sense, these separations have been fixed.</p>
</div>
<div class="sect3">
<h4 id="alignment-of-code-when-code-code-and-code-code-zip-code-and-code-zipwith-code"><a class="anchor" href="#alignment-of-code-when-code-code-and-code-code-zip-code-and-code-zipwith-code"></a>Alignment of <code>when</code>, <code>and</code>, <code>zip</code>, and <code>zipWith</code></h4>
<div class="paragraph">
<p>For instance, <code>Mono</code> had a <code>and</code> operator and <code>when</code> static methods <strong>which used
to combine elements and to produce <code>Mono&lt;Tuple2&gt;</code></strong>. In essence, they were
essentially a specialization of <code>zipWith</code> and <code>zip</code> in <code>Flux</code>, but having
different names made it difficult to attach the concepts. That is why these
methods have been renamed in <code>Mono</code>.</p>
</div>
<div class="paragraph">
<p>On the other hand, you&#8217;ll notice that a different flavor of <code>when</code> and <code>and</code> is
still present in the <code>Mono</code> API. Contrary to the ones we saw previously, these
return a <code>Mono&lt;Void&gt;</code>. Dealing with completion of tasks is an essential use case
of <code>Mono</code>, and these methods are now specifically tailored for that sort of
application: they will combine and execute several tasks (represented as source
Monos), ignore their potential <code>onNext</code> signal and only propagate the combination
of <code>onComplete</code> signals, resulting in a <code>Mono&lt;Void&gt;</code> that completes whenever the
N tasks complete.</p>
</div>
</div>
<div class="sect3">
<h4 id="consistent-semantic-of-the-code-then-code-prefix"><a class="anchor" href="#consistent-semantic-of-the-code-then-code-prefix"></a>Consistent Semantic Of The <code>then</code> Prefix</h4>
<div class="paragraph">
<p>Similarly, the <code>then</code> prefix now consistently indicates that the <code>onNext</code> of the
source are to be discarded, instead building up on the terminal signals. This
has been made consistent in both <code>Flux</code> and <code>Mono</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>then()</code> returns a <code>Mono&lt;Void&gt;</code> that only propagates the <code>onComplete</code> or <code>onError</code>
signal from the source.</p>
</li>
<li>
<p><code>then(Mono&lt;V&gt;)</code> returns a <code>Mono&lt;V&gt;</code>: it waits for the original <code>onComplete</code>
signal before switching to another provided <code>Mono</code>, emitting only the elements
from that other <code>Mono</code>.</p>
</li>
<li>
<p><code>thenMany(Publisher&lt;V&gt;)</code> is similar, except it continues into a <code>Flux&lt;V&gt;</code>.</p>
</li>
<li>
<p><code>thenEmpty(Publisher&lt;Void&gt;)</code> returns a <code>Mono&lt;Void&gt;</code> that completes once the
original <code>Mono</code> <em>then</em> the <code>Publisher</code> have completed. That is, it represents
sequential completion, unlike <code>and</code> which subscribes to both sequences
immediately.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that variants that were taking a <code>Supplier</code> parameter have been removed
altogether (their lazy semantics can be replaced by a <code>Mono.defer</code>). Also, the
<code>Mono#thenEmpty</code> described above was renamed from <code>then(Publisher&lt;Void&gt;)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="how-one-code-then-code-was-really-a-code-flatmap-code"><a class="anchor" href="#how-one-code-then-code-was-really-a-code-flatmap-code"></a>How One <code>then</code> Was Really A <code>flatMap</code></h4>
<div class="paragraph">
<p><code>Mono</code> used to have another interesting <code>then</code> variant:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Mono&lt;V&gt; then(Function&lt;T, Mono&lt;V&gt;&gt; thenFunction);</code></pre>
</div>
</div>
<div class="paragraph">
<p>When looking closely, this didn&#8217;t fit with the new semantic of <code>then*</code> focusing
on the terminal signals. Rather, it would transform the source into another
<code>Mono</code> <em>depending on the source&#8217;s</em> <code>onNext</code>. Sounds familiar? This is indeed
consistent with what <code>Flux#flatMap</code> does!</p>
</div>
<div class="paragraph">
<p>There was one problem, though: <code>Mono</code> already had a <code>flatMap</code> operator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Flux&lt;V&gt; flatMap(Function&lt;T, Publisher&lt;V&gt;&gt; mapper);</code></pre>
</div>
</div>
<div class="paragraph">
<p>After thinking a bit more about it, we recognized that the classic semantic of
<code>flatMap</code> is to return a value of the same type as the one <code>flatMap</code> is applied
to. So it was more correct to have <code>Mono#flatMap</code> return a <code>Mono</code>&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>As a result, we renamed this then variant to <code>flatMap</code> and we used
the <code>Many</code> suffix on the variant that would return a <code>Flux</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Mono&lt;V&gt; flatMap(Function&lt;T, Mono&lt;V&gt;&gt; mapper);
Flux&lt;V&gt; flatMapMany(Function&lt;T, Publisher&lt;V&gt;&gt; mapper);</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
In order to ease the migration, we advise you to search for all usage of
the old <code>Mono.flatMap</code> and replace these with <code>flatMapMany</code> first. Then search
for <code>then(Function)</code> uses and replace those with <code>flatMap</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="various-api-simplifications"><a class="anchor" href="#various-api-simplifications"></a>Various API Simplifications</h3>
<div class="paragraph">
<p><strong>Time</strong>:
In this release, all the operators dealing with time do so exclusively via the
<code>Duration</code> type. Most used to have a variant with the <code>*Millis</code> suffix that was
using a <code>long</code> and a <code>TimeUnit</code> to represent a duration. These variants have
been removed in 3.1.0.</p>
</div>
<div class="paragraph">
<p><strong>Delaying Errors</strong>:
Another cross-cutting change dealing with suffixes: some operators have an
optional configuration where they can combine multiple errors and emit the
<code>onError</code> signal at the very end, allowing for some values to still make it in
the resulting sequence. For example, <code>flatMap</code> can either stop immediately if an
inner sequence emits <code>onError</code> or continue merging the elements from other inner
sequences before propagating that error.</p>
</div>
<div class="paragraph">
<p>In some instances, that optional behavior was represented in the API as a
<code>boolean</code> flag parameter. In other instances, it was a separate variant suffixed
with <code>DelayError</code>. In 3.1.0, all these variants have been aligned to consistently
use the <code>*DelayError</code> suffix rather than the boolean flag.</p>
</div>
<div class="paragraph">
<p><strong>Simplified Interfaces</strong>:
Some specialized interfaces have also been removed in favor of simpler or more
generic alternatives:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>Cancellation</code> interface has been removed in favor of the more generic
<code>Disposable</code> one.</p>
</li>
<li>
<p>The <code>TimedScheduler</code> interface has been removed. The few <code>Scheduler</code> that are
not time-capable will throw a <code>RejectedExecutionException</code> indicating so whenever
one attempts to use <code>schedulePeriodically</code> on them. Also, <code>Scheduler#shutdown</code>
has been removed in favor of <code>dispose()</code> from Disposable.</p>
</li>
<li>
<p>Several interfaces used for introspection have been simplified into a single
<code>Scannable</code> interface, which exposes information about the current state of an
operator (in a best effort fashion) through its <code>scan(Scannable.Attr)</code> method.</p>
</li>
<li>
<p><code>QueueSupplier</code> has been renamed to <code>Queues</code> and is purely a utility class now
(and not a <code>Supplier</code> anymore).</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="moved"><a class="anchor" href="#moved"></a>Reactor-Test And Kotlin Extensions Moved</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Both Kotlin Extensions and Reactor Test artifacts have been directly integrated
into the main repository of <code>reactor-core</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Kotlin extensions are part of the <code>reactor-core</code> artifact.
No need for a dependency to <code>io.projectreactor:reactor-kotlin-extensions</code> anymore.</p>
</li>
<li>
<p><code>reactor-test</code> is now under the same groupId as <code>reactor-core</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Replace <code>io.projectreactor.addons:reactor-test</code> with <code>io.projectreactor:reactor-test</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="kotlin-null-safety"><a class="anchor" href="#kotlin-null-safety"></a>Kotlin And Null-Safety Support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>During this release cycle, an ongoing effort to better integrate with languages
like Kotlin has been made.</p>
</div>
<div class="paragraph">
<p>This notably translates to some API rework in order to avoid ambiguous
signatures with lambdas. Whenever a method had two overrides that where just
differing by the type of functional interface they took, we extracted one of the
variants as a new suffix for the operator.</p>
</div>
<div class="paragraph">
<p>For example, consider <code>buffer(Publisher, Supplier)</code> and <code>buffer(Publisher,
Function)</code>. The second variant has been renamed to <code>bufferWhen</code>, as it creates a
buffer <em>when</em> the companion <code>Publisher</code> from that <code>Function</code> emits.</p>
</div>
<div class="paragraph">
<p>As we saw above, the <strong>Kotlin extensions</strong> have also been integrated directly
into the reactor-core repository.</p>
</div>
<div class="paragraph">
<p>Additionally, support for null-safety analysis has been improved through the
introduction of three annotations. These annotations build upon JSR 305 which,
despite being dormant, is drawn on by multiple static analysis tools including
the IntelliJ IDE. The following annotations are provided in the
<code>reactor.util.annotation</code> package:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@NonNull</code> indicates that a specific parameter, return value, or field cannot
be null. (It is not needed on parameters and return value where <code>@NonNullApi</code>
applies) .</p>
</li>
<li>
<p><code>@Nullable</code> indicates that a parameter, return value, or field can be null.</p>
</li>
<li>
<p><code>@NonNullApi</code> is a package level annotation that indicates non-null is the
default behavior for parameters and return values.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We leverage these annotations to express an explicit and actionable null-safety
contract on all public Reactor Core APIs.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="docs"><a class="anchor" href="#docs"></a>Documentation Polishing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The documentation has also received some love: the
<a href="http://projectreactor.io/docs/core/release/reference">reference guide</a> is finally
complete and the javadoc have been reviewed and reworded in order to describe
some methods more clearly.</p>
</div>
<div class="paragraph">
<p>With the support for Kotlin being integrated directly into reactor-core, a
<a href="http://projectreactor.io/docs/core/release/reference/docs/index.html#kotlin">new section</a>
has been added to the reference guide and the KotlinDocs are
<a href="http://projectreactor.io/docs/core/release/kdoc-api/">published</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="context"><a class="anchor" href="#context"></a>The <code>Context</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Contextual data can now be attached to a <code>Flux</code> or <code>Mono</code>, per subscription, as
a Map-like <code>Context</code> object!</p>
</div>
<div class="paragraph">
<p>This is an advanced feature that will mostly interest library developers, but we
know it will prove invaluable in migrating features that formerly relied on
<code>ThreadLocal</code> in imperative code for example.</p>
</div>
<div class="paragraph">
<p>In the Spring portfolio, we expect both <code>spring-security</code> and <code>spring-cloud-sleuth</code>
to benefit greatly.</p>
</div>
<div class="paragraph">
<p>In order to add information to the <code>Context</code>, use the <code>subscriberContext(Context)</code>
operator, like in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Mono&lt;String&gt; put = doPut("www.example.com", Mono.just("Walter"))
    .subscriberContext(Context.of(HTTP_CORRELATION_ID, "2-j3r9afaf92j-afkaf"))
    .filter(t -&gt; t.getT1() &lt; 300)
    .map(Tuple2::getT2);</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
The <code>Context</code> is immutable and is propagated during the <em>subscription</em>
phase, which runs from the end of the chain (<code>subscribe()</code> call) toward the
beginning of the chain.<br>
As a result, what you put into the <code>Context</code> via <code>subscriberContext</code> results in
an enriched copy of the <code>Context</code> <strong>visible only by the operators above it</strong>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to retrieve and use the information put inside the <code>Context</code>, the
upstream chain of operators can make use of <code>Mono.subscriberContext()</code>, which
materializes the visible <code>Context</code> (e.g. inside a <code>flatMap</code>).</p>
</div>
<div class="paragraph">
<p>It could look like the following snippet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Mono&lt;Tuple2&lt;String, Optional&lt;Object&gt;&gt;&gt; dataAndContext =
  data.zipWith(Mono.subscriberContext()
                   .map(c -&gt; c.getOrEmpty(HTTP_CORRELATION_ID))
  );</code></pre>
</div>
</div>
<div class="paragraph">
<p>Head to the
<a href="http://projectreactor.io/docs/core/release/reference/docs/index.html#context">reference guide</a>
to learn more about <code>Context</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="other-new"><a class="anchor" href="#other-new"></a>Other Interesting New Features</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="added-the-code-expand-code-operator"><a class="anchor" href="#added-the-code-expand-code-operator"></a>Added The <code>expand</code> Operator</h3>
<div class="paragraph">
<p>This operator can be used to recursively <em>expand</em> source elements into nested
<code>Publishers</code>, producing a graph of <code>Publisher</code> either depth-first or breadth-first.</p>
</div>
</div>
<div class="sect2">
<h3 id="mapping-code-null-code-provider-to-the-empty-code-mono-code"><a class="anchor" href="#mapping-code-null-code-provider-to-the-empty-code-mono-code"></a>Mapping <code>null</code> Provider To The Empty <code>Mono</code></h3>
<div class="paragraph">
<p>When transforming a source <code>Callable</code> or <code>Supplier</code> that returns <code>null</code> into a
<code>Mono</code>, <code>fromCallable</code> and <code>fromSupplier</code> used to emit an error. They now
accommodate the <code>null</code> result and produce an empty <code>Mono</code> instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="added-ability-to-code-name-code-and-code-tag-code-a-reactive-sequence"><a class="anchor" href="#added-ability-to-code-name-code-and-code-tag-code-a-reactive-sequence"></a>Added Ability To <code>name</code> And <code>tag</code> A Reactive Sequence</h3>
<div class="paragraph">
<p>A single <code>name(String)</code> can be given to a <code>Flux</code>. It can be retrieved using
<code>Scannable.name()</code>, which walks the chain of operators upstream until it finds
a first declared name.</p>
</div>
<div class="paragraph">
<p>Similarly, several <code>tag(String, String)</code> key-pairs can be associated with a
<code>Flux</code> or <code>Mono</code>. These can be retrieved as a <code>Stream&lt;Tuple2&lt;String, String&gt;&gt;</code>
by the <code>Scannable#tags()</code> method, which walks the whole chain of operators
upstream.</p>
</div>
</div>
<div class="sect2">
<h3 id="added-a-code-distinctuntilchanged-code-variant-with-a-code-bipredicate-code"><a class="anchor" href="#added-a-code-distinctuntilchanged-code-variant-with-a-code-bipredicate-code"></a>Added A <code>distinctUntilChanged</code> Variant With A <code>BiPredicate</code></h3>
<div class="paragraph">
<p>Rather than using <code>Set</code> semantics to evaluate if there is a change, the
<code>BiPredicate</code> is applied on the current source element and last emitted element.
This makes it possible to skip elements if they are <em>too close to</em> the last
emitted element (e.g. <code>Doubles</code> with a difference &lt; 1).</p>
</div>
</div>
<div class="sect2">
<h3 id="added-code-mono-cache-duration-code"><a class="anchor" href="#added-code-mono-cache-duration-code"></a>Added <code>Mono.cache(Duration)</code></h3>
<div class="paragraph">
<p>This allows to easily cache a hard-to-compute single value (or error) for a
limited amount of time. First subscriber to come in after the TTL period will
re-trigger a subscription to the source.</p>
</div>
</div>
<div class="sect2">
<h3 id="cost-improvement-for-code-checkpoint-string-code"><a class="anchor" href="#cost-improvement-for-code-checkpoint-string-code"></a>Cost Improvement For <code>checkpoint(String)</code></h3>
<div class="paragraph">
<p>The <code>checkpoint(String)</code> variant is now light by default, which means there is
no stack trace filled on instantiation (making the operator less costly to use).
We now assume the <code>String</code> identifier is unique enough that it would be sufficient
to find the instantiation point of a sequence that terminates in error.</p>
</div>
</div>
<div class="sect2">
<h3 id="adding-a-grace-period-to-code-refcount-code"><a class="anchor" href="#adding-a-grace-period-to-code-refcount-code"></a>Adding A Grace Period to <code>refCount</code></h3>
<div class="paragraph">
<p>When using <code>refCount</code>, one can now provide a <code>Duration</code>. When the number of
subscribers to the reference counted sequence falls below the threshold, the
operator waits for that duration instead of immediately unsubscribing from the
source. No cancellation happen in case enough subscribers come back within this
grace period.</p>
</div>
</div>
<div class="sect2">
<h3 id="mono-code-delayuntil-code-replaces-code-untilother-code"><a class="anchor" href="#mono-code-delayuntil-code-replaces-code-untilother-code"></a>Mono <code>delayUntil</code> Replaces <code>untilOther</code></h3>
<div class="paragraph">
<p>The <code>delayUntil</code> operator delays the emission of a <code>Mono</code> until after a
companion <code>Publisher</code>, generated from the source value, completes.</p>
</div>
<div class="paragraph">
<p>Note that there was an <code>untilOther</code> operator that has been removed. It used to
also delay, but trigger on the first <code>onNext</code> of the companion. <code>delayUntil</code> is
more flexible, as the same behavior can be achieved by appending a <code>take(1)</code> to
the companion.</p>
</div>
</div>
<div class="sect2">
<h3 id="test-features"><a class="anchor" href="#test-features"></a>Test Features</h3>
<div class="paragraph">
<p>The <code>reactor-test</code> artifact also has a few new features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>New expectations around verification of errors compatible with using
assertions: <code>expectErrorSatisfies</code> and <code>verifyErrorSatisfies</code>.</p>
</li>
<li>
<p>Added an optional configurable default timeout for <code>StepVerifier#verify()</code>.
Set it up by using the static <code>StepVerifier#setDefaultTimeout</code> method.</p>
</li>
<li>
<p>Added a <code>PublisherProbe</code> to easily check that a complex chain of operators
with conditional switches (e.g. <code>switchIfEmpty</code>) does go through a logical
branch, while still emitting meaningful data for the test by wrapping any
<code>Flux</code> or <code>Mono</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<h1 id="conclusion" class="sect0"><a class="anchor" href="#conclusion"></a>Conclusion</h1>
<div class="paragraph">
<p>If you&#8217;re new to Reactor, now is an exciting time to start your reactive journey
with Spring Framework 5.0. If you&#8217;re not, we hope that&#8217;ll you enjoy working with
Reactor even more now that all these changes have been put in place.</p>
</div>
<div class="paragraph">
<p>If you encounter any migration difficulty, have a look at the
<a href="https://github.com/reactor/reactor-core/releases/tag/v3.1.0.RELEASE">release notes</a>
or ask for help on our <a href="https://gitter.im/reactor/reactor">Gitter</a>.</p>
</div>
<div class="paragraph">
<p>Happy Reactive Coding!</p>
</div>
<div class="paragraph">
<p><em>bismuth crystal photo CC-By-SA David Abercrombie via <a href="https://www.flickr.com/photos/albategnius/">Flickr</a></em></p>
</div></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 3046;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
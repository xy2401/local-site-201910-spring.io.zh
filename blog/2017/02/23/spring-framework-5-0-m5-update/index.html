<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>Spring Framework 5.0 M5 Update</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="Spring Framework 5.0 M5 Update" />
<meta name="twitter:description" content="&lt;p&gt;An update on the 5th and last milestone of Spring Framework 5.0…&lt;/p&gt;
&lt;h1&gt;&lt;a href=&quot;#spring-mvc-and-spring-webflux&quot; class=&quot;anchor&quot; name=&quot;spring-mvc-and-spring-webflux&quot;&gt;&lt;/a&gt;Spring MVC and Spring WebFlux&lt;/h1&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;The name &lt;em&gt;Spring MVC&lt;/em&gt; is both well known and widely used but it may surprise a few there is no actual project or independent distribution with that name. Rather it is a module within the Spring Framework distribution called &lt;code&gt;spring-webmvc&lt;/code&gt;. Here is another trivia question. Did you know that the top-level package in the module does not feature “mvc”? Rather it is called &lt;code&gt;org.springframework.web.servlet&lt;/code&gt;. Practically speaking those are details that we don’t have to remember. What matters is that we have a short and memorable name to refer to &lt;em&gt;Spring’s Servlet stack based&lt;/em&gt; web framework.&lt;/p&gt;
" />
<meta name="twitter:creator" content="@rstoya05" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/4b12b9c0c665bc0345467c1a218ed0f7?s=200" />

<meta property="og:title" content="Spring Framework 5.0 M5 Update" />
<meta property="og:image" content="https://gravatar.com/avatar/4b12b9c0c665bc0345467c1a218ed0f7?s=200" />
<meta property="og:description" content="&lt;p&gt;An update on the 5th and last milestone of Spring Framework 5.0…&lt;/p&gt;
&lt;h1&gt;&lt;a href=&quot;#spring-mvc-and-spring-webflux&quot; class=&quot;anchor&quot; name=&quot;spring-mvc-and-spring-webflux&quot;&gt;&lt;/a&gt;Spring MVC and Spring WebFlux&lt;/h1&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;The name &lt;em&gt;Spring MVC&lt;/em&gt; is both well known and widely used but it may surprise a few there is no actual project or independent distribution with that name. Rather it is a module within the Spring Framework distribution called &lt;code&gt;spring-webmvc&lt;/code&gt;. Here is another trivia question. Did you know that the top-level package in the module does not feature “mvc”? Rather it is called &lt;code&gt;org.springframework.web.servlet&lt;/code&gt;. Practically speaking those are details that we don’t have to remember. What matters is that we have a short and memorable name to refer to &lt;em&gt;Spring’s Servlet stack based&lt;/em&gt; web framework.&lt;/p&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2017-02-23 12:46:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Spring Framework 5.0 M5 Update</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/4b12b9c0c665bc0345467c1a218ed0f7?s=20&amp;d=mm" />
<a class="author" rel="author" href="/team/rstoyanchev">Rossen Stoyanchev</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2017-02-23 12:46:00.0">February 23, 2017</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="2850" href="/blog/2017/02/23/spring-framework-5-0-m5-update#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><p>An update on the 5th and last milestone of Spring Framework 5.0&hellip;</p><h1><a href="#spring-mvc-and-spring-webflux" class="anchor" name="spring-mvc-and-spring-webflux"></a>Spring MVC and Spring WebFlux</h1>
<p><p>The name <em>Spring MVC</em> is both well known and widely used but it may surprise a few there is no actual project or independent distribution with that name. Rather it is a module within the Spring Framework distribution called <code>spring-webmvc</code>. Here is another trivia question. Did you know that the top-level package in the module does not feature &ldquo;mvc&rdquo;? Rather it is called <code>org.springframework.web.servlet</code>. Practically speaking those are details that we don&rsquo;t have to remember. What matters is that we have a short and memorable name to refer to <em>Spring&rsquo;s Servlet stack based</em> web framework.</p>
<p><em>Spring&rsquo;s reactive stack</em> web framework, new in 5.0, is fully reactive and non-blocking. It is suitable for event-loop style processing with a small number of threads. It is supported on Servlet containers (Tomcat, Jetty, Servlet 3.1+) but also non-Servlet runtimes (Netty, Undertow) since the common foundation for this stack is not the Servlet API but a non-blocking alternative built on Reactive Streams and the <a href="http://projectreactor.io/">Reactor</a> project. In case you&rsquo;re wondering, isn&rsquo;t Servlet 3.1 capable of non-blocking I/O? Yes it is and we support running on Servlet 3.1 containers but the rest of the Servlet API is imperative style and can not be used in a reactive, non-blocking stack.</p>
<p>So far we&rsquo;ve lacked a dedicated name for the reactive web stack which supports both the Spring MVC annotations (i.e. <code>@Controller</code>, <code>@RequestMapping</code>) and a new functional programming model, making it a challenge to discuss and clearly contrast programming models and stacks. In our milestone 5, the <code>spring-web-reactive</code> module was renamed to <code>spring-webflux</code> - drawing inspiration, and brevity, from the <a href="https://spring.io/blog/2016/04/19/understanding-reactive-types">Flux reactive type</a> at the core of the Spring Web Reactive APIs, with our lower-level reactive HTTP abstractions living in the common <code>spring-web</code> module. So we now have the <code>spring-webmvc</code> and the <code>spring-webflux</code> modules side by side that we&rsquo;ll refer to as <em>Spring (Web)MVC</em> and <em>Spring WebFlux</em>. In case you&rsquo;re wondering: the top-level package in the new module is <code>org.springframework.web.reactive</code>.</p>
<p>Now for some other key updates in this space&hellip;</p><h1><a href="#webclient" class="anchor" name="webclient"></a>WebClient</h1>
<p><p>The <code>WebClient</code> is a reactive, non-blocking alternative to the <code>RestTemplate</code> adding value for both <em>reactive</em> and to <em>Servlet-stack</em> applications. It makes it effortless to deal with asynchronous and streaming scenarios. </p>
<p>In M5 we&rsquo;ve made substantial improvements eliminating the need for static imports to specify request details and perform an exchange:</p>
<pre><code class="prettyprint java">WebClient webClient = WebClient.create();

Mono&lt;Person&gt; person = webClient.get()
        .uri(&quot;http://localhost:8080/persons/42&quot;)
        .accept(MediaType.APPLICATION_JSON)
        .exchange()
        .then(response -&gt; response.bodyToMono(Person.class));
</code></pre>
<p>If all requests have a comon base URL it can be pre-configured once:</p>
<pre><code class="prettyprint java">WebClient webClient = WebClient.create(&quot;http://localhost:8080&quot;);

Mono&lt;Person&gt; person = webClient.get()
        .uri(&quot;/persons/{id}&quot;, 42)
        .accept(MediaType.APPLICATION_JSON)
        .exchange()
        .then(response -&gt; response.bodyToMono(Person.class));
</code></pre>
<p>It is also possible to gain programmatic control with a <code>UriBuilder</code>:</p>
<pre><code class="prettyprint java">Mono&lt;Person&gt; person = webClient.get()
        .uri(builder -&gt; builder.path(&quot;/persons/{id}&quot;).build(&quot;42&quot;))
        .accept(MediaType.APPLICATION_JSON)
        .exchange()
        .then(response -&gt; response.bodyToMono(Person.class));
</code></pre><h1><a href="#webtestclient" class="anchor" name="webtestclient"></a>WebTestClient</h1>
<p><p>The new <code>WebTestClient</code> in the <code>spring-test</code> module forms the basis of the Spring WebFlux integration testing support. It wraps a <code>WebClient</code> and exposes an API for integration testing. Similar to <code>MockMvc</code> from Spring MVC Test, the new test client does not need an actual, running server and can bind directly to WebFlux server infrastructure using a mock request and response:</p>
<pre><code class="prettyprint java">WebTestClient client = WebTestClient
        .bindToController(new PersonController())
        .build();

client.get().uri(&quot;/persons/42&quot;)
        .exchange()
        .expectStatus().isOk()
        .expectHeader().contentType(MediaType.APPLICATION_JSON_UTF8)
        .expectBody(Person.class).value().isEqualTo(new Person(&quot;John&quot;));
</code></pre>
<p>The new test client however can also run against a live server:</p>
<pre><code class="prettyprint java">WebTestClient client = WebTestClient
        .bindToServer().baseUrl(&quot;http://localhost:8080&quot;)
        .build();

// Same test case...
</code></pre>
<p>Streaming is also easy to test possibly using a Reactor <code>StepVerifier</code>:</p>
<pre><code class="prettyprint java">FluxExchangeResult&lt;Person&gt; result = client.get().uri(&quot;/persons&quot;)
        .accept(TEXT_EVENT_STREAM)
        .exchange()
        .expectStatus().isOk()
        .expectHeader().contentType(TEXT_EVENT_STREAM)
        .expectBody(Person.class)
        .returnResult();

StepVerifier.create(result.getResponseBody())
        .expectNext(new Person(&quot;Jane&quot;), new Person(&quot;Jason&quot;))
        .expectNextCount(3)
        .consumeNextWith(p -&gt; assertEquals(&quot;John&quot;, p.getName()))
        .thenCancel()
        .verify();
</code></pre><h1><a href="#path-pattern-parser" class="anchor" name="path-pattern-parser"></a>Path Pattern Parser</h1>
<p><p>The M5 release adds a new <code>PathPatternParser</code> alternative to the <code>AntPathMatcher</code> that enables use of a more efficient parsed pattern representation of request mappings and supports a very handy <code>&quot;{*foo}&quot;</code> URI variable syntax to capture any number of segments at the end of a pattern.</p>
<p>As a first step, a new <code>ParsingPathMatcher</code> implementation already allows the new <code>PathPatternParser</code> to be easily plugged into Spring MVC and Spring WebFlux mappings. As a next step towards RC1 the goal is to have a registry of patterns to match against a parsed representation of the request path.</p><h1><a href="#server-sent-events-and-json-streaming" class="anchor" name="server-sent-events-and-json-streaming"></a>Server-Sent Events and JSON Streaming</h1>
<p><p>Support for streaming is easy with Spring WebFlux:</p>
<pre><code class="prettyprint java">@GetMapping(path = &quot;/persons&quot;, produces = &quot;text/event-stream&quot;)
Flux&lt;Person&gt; getPersons() {
    return this.repository.getPersons();
}
</code></pre>
<p>The above will stream data to a browser formatted as Server-Sent Events (SSE):</p>
<pre><code class="prettyprint">data: {&quot;name&quot;:&quot;Jane&quot;}
data: {&quot;name&quot;:&quot;John&quot;}
...
</code></pre>
<p>However what should be done for:</p>
<pre><code class="prettyprint java">@GetMapping(&quot;/persons&quot;)
Flux&lt;Person&gt; getPersons() {
    return this.repository.getPersons();
}
</code></pre>
<p>We could stream individual JSON objects but that would not be a valid JSON document as a whole and a browser client has no way to consume a stream other than using Server-Sent Events or WebSocket. </p>
<p>By default <code>Flux&lt;Person&gt;</code> will produce a JSON array:</p>
<pre><code class="prettyprint">[{&quot;name&quot;:&quot;Jane&quot;},{&quot;name&quot;:&quot;John&quot;},...]
</code></pre>
<p>Non-browser clients such as the <code>WebClient</code> can request request content type <code>application/stream+json</code> and the response will be a stream of JSON objects similar to Server-Sent Events but without the extra formatting:</p>
<pre><code class="prettyprint">{&quot;name&quot;:&quot;Jane&quot;}
{&quot;name&quot;:&quot;John&quot;}
...
</code></pre><h1><a href="#in-conclusion" class="anchor" name="in-conclusion"></a>In Conclusion</h1>
<p><p>I&rsquo;d like to thank everyone who has given Spring Framework 5.0 a try and provided feedback, especially around the new reactive features. Please continue to do that. As always even small comments can prove incredibly valuable as they make us revisit design choices from a different perspective.</p>
<p>If you&rsquo;re reading this from <a href="https://devnexus.com/s/index">DevNexus</a> this week don&rsquo;t miss the opportunity to <a href="https://devnexus.com/s/devnexus2017/presentations/17213">see the amazing Josh Long</a> live code a reactive, web application and also the <a href="https://devnexus.com/s/devnexus2017/presentations/17153">Reactor 3 talk</a> by Simon Baslé, a core member of the Reactor team.</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 2850;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
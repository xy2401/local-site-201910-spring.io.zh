<html  data-code-prettify="" data-mobile-support="" data-search=""><head></head><body >﻿
<title>React.js和Spring Data REST：第1部分-基本功能</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="React.js and Spring Data REST: Part 1 - Basic Features">
<meta name="twitter:description" content="<div id=" preambl="="> 
 <div class="sectionbody"> 
  <div class="admonitionblock note"> 
   <table> 
    <tbody> 
     <tr> 
      <td class="icon"> <i class="fa icon-note" title="注意"></i> </td> 
      <td class="content">To see updates to this code, visit our <a href="https://spring.io/guides/tutorials/react-and-spring-data-rest/">React.js and Spring Data REST tutorial</a>.</td> 
     </tr> 
    </tbody> 
   </table> 
  </div> 
  <div class="paragraph"> 
   <p>Welcome Spring community,</p> 
  </div> 
  <div class="paragraph"> 
   <p>This is the first of several blog entries. In this session, you will see how to get a bare-bones Spring Data REST application up and running quickly. Then you will build a simple UI on top of it using Facebook’s React.js toolset.</p> 
  </div> 
 </div> 

<div class="sect1"> 
 <h2 id="_step_0_setting_up_your_environment">Step 0 - Setting up your environment</h2> 
 <div class="sectionbody"> 
  <div class="paragraph"> 
   <p>Feel free to <a href="https://github.com/gregturn/react-and-spring-data-rest/tree/master/basic">grab the code</a> from this repository and follow along.</p> 
  </div> 
  <div class="paragraph"> 
   <p>If you want to do it yourself, visit <a href="http://start.spring.io" class="bare">http://start.spring.io</a> and pick these items:</p> 
  </div> 
  <div class="ulist"> 
   <ul> 
    <li>Rest Repositories </li> 
    <li>Thymeleaf </li> 
    <li> JPA </li> 
    <li> H2 </li> 
   </ul> 
  </div> 
  <div class="paragraph"> 
   <p>This demo uses Java 8, Maven Project, and the latest stable release of Spring Boot. This will give you a clean, empty project. From there, you can add the various files shown explicitly in this session, and/or borrow from the repository listed above.</p> 
  </div> 
 </div> 
</div>
">
<meta name="twitter:creator" content="@gregturn">
<meta name="twitter:image:src" content="https://gravatar.com/avatar/43e9a9d63f7f4f9891c9fcd592b89cfa?s=200">

<meta property="og:title" content="React.js and Spring Data REST: Part 1 - Basic Features">
<meta property="og:image" content="https://gravatar.com/avatar/43e9a9d63f7f4f9891c9fcd592b89cfa?s=200">
<meta property="og:description" content="<div id=" preambl="="> 
 <div class="sectionbody"> 
  <div class="admonitionblock note"> 
   <table> 
    <tbody> 
     <tr> 
      <td class="icon"> <i class="fa icon-note" title="注意"></i> </td> 
      <td class="content">To see updates to this code, visit our <a href="https://spring.io/guides/tutorials/react-and-spring-data-rest/">React.js and Spring Data REST tutorial</a>.</td> 
     </tr> 
    </tbody> 
   </table> 
  </div> 
  <div class="paragraph"> 
   <p>Welcome Spring community,</p> 
  </div> 
  <div class="paragraph"> 
   <p>This is the first of several blog entries. In this session, you will see how to get a bare-bones Spring Data REST application up and running quickly. Then you will build a simple UI on top of it using Facebook’s React.js toolset.</p> 
  </div> 
 </div> 

<div class="sect1"> 
 <h2 id="_step_0_setting_up_your_environment">Step 0 - Setting up your environment</h2> 
 <div class="sectionbody"> 
  <div class="paragraph"> 
   <p>Feel free to <a href="https://github.com/gregturn/react-and-spring-data-rest/tree/master/basic">grab the code</a> from this repository and follow along.</p> 
  </div> 
  <div class="paragraph"> 
   <p>If you want to do it yourself, visit <a href="http://start.spring.io" class="bare">http://start.spring.io</a> and pick these items:</p> 
  </div> 
  <div class="ulist"> 
   <ul> 
    <li>Rest Repositories </li> 
    <li>Thymeleaf </li> 
    <li> JPA </li> 
    <li> H2 </li> 
   </ul> 
  </div> 
  <div class="paragraph"> 
   <p>This demo uses Java 8, Maven Project, and the latest stable release of Spring Boot. This will give you a clean, empty project. From there, you can add the various files shown explicitly in this session, and/or borrow from the repository listed above.</p> 
  </div> 
 </div> 
</div>
">
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2015-09-01 11:33:00.0">



<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">专案</a>
</li>
<li class="navbar-link">
<a href="/guides">导游</a>
</li>
<li class="navbar-link active">
<a href="/blog">博客</a>
</li>
<li class="navbar-link">
<a href="/services">培训与认证</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索文档，指南和帖子..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">家<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">专案<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">导游<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">博客<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">培训与认证<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>工程</div>
</div>
<div class="blog-category content--title">
<div>发布</div>
</div>
<div class="blog-category content--title">
<div>新闻与活动</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">React.js和Spring Data REST：第1部分-基本功能</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">工程</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/43e9a9d63f7f4f9891c9fcd592b89cfa?s=20&d=mm"> <a class="author" rel="author" href="/team/gturnquist">格雷格·特恩奎斯特</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2015-09-01 11:33:00.0">2015年9月1日</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2015/09/01/react-js-and-spring-data-rest-part-1-basic-features#disqus_thread" data-disqus-identifier="2220">
</a></div>
</div>
</header>
<div class="blog--post"><div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tbody>
<tr>
<td class="icon"> <i class="fa icon-note" title="注意"></i> </td>
<td class="content">要查看此代码的更新，请访问我们的<a href="https://spring.io/guides/tutorials/react-and-spring-data-rest/">React.js和Spring Data REST教程</a> 。</td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph">
<p>欢迎春季社区，</p>
</div>
<div class="paragraph">
<p>这是几个博客条目中的第一个。在本课程中，您将了解如何快速启动并运行Spring Data REST应用程序。然后，您将使用Facebook的React.js工具集在其之上构建一个简单的UI。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_step_0_setting_up_your_environment">步骤0-设定您的环境</h2>
<div class="sectionbody">
<div class="paragraph">
<p>随时从该存储库中<a href="https://github.com/gregturn/react-and-spring-data-rest/tree/master/basic">获取代码</a>并继续。</p>
</div>
<div class="paragraph">
<p>如果您想自己做，请访问<a href="https://start.spring.io" class="bare">http://start.spring.io</a>并选择以下项目：</p>
</div>
<div class="ulist">
<ul>
<li>其余资料库</li>
<li>胸腺</li>
<li>JPA</li>
<li>H2</li>
</ul>
</div>
<div class="paragraph">
<p>该演示使用Java 8，Maven项目和Spring Boot的最新稳定版本。这将为您提供一个干净，空的项目。从那里，您可以添加此会话中显式显示的各种文件，和/或从上面列出的存储库中借用。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_in_the_beginning">一开始...</h2>
<div class="sectionbody">
<div class="paragraph">
<p>最初有数据。很好。但是后来人们想要通过各种方式访问数据。多年来，人们将许多MVC控制器拼凑在一起，其中许多都使用了Spring强大的REST支持。但是一遍又一遍地花费很多时间。</p>
</div>
<div class="paragraph">
<p>如果做一些假设，Spring Data REST解决了这个问题有多简单：</p>
</div>
<div class="ulist">
<ul>
<li>开发人员使用支持存储库模型的Spring Data项目。
</li>
<li>该系统使用公认的行业标准协议，例如HTTP动词，标准化媒体类型和IANA批准的链接名称。
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_declaring_your_domain">声明您的域名</h3>
<div class="paragraph">
<p>任何基于Spring Data REST的应用程序的基石都是领域对象。对于此会话，您将构建一个应用程序来跟踪公司的员工。通过创建如下数据类型来开始：</p>
</div>
<div class="listingblock">
<div class="title">src / main / java / com / greglturnquist / payroll / Employee.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Data
@Entity
public class Employee {

	private @Id @GeneratedValue Long id;
	private String firstName;
	private String lastName;
	private String description;

	private Employee() {}

	public Employee(String firstName, String lastName, String description) {
		this.firstName = firstName;
		this.lastName = lastName;
		this.description = description;
	}
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<code>@Entity</code>是一个JPA批注，它表示要存储在关系表中的整个类。
</li>
<li>
<code>@Id</code>和<code>@GeneratedValue</code>是JPA注释，用于记录主键，并在需要时自动生成。
</li>
<li>
<code>@Data</code>和<code>@RequiredArgsConstructor</code>是Project Lombok批注，用于自动生成getter，setter，构造函数，toString，hash，equals等。它减少了样板。
</li>
</ul>
</div>
<div class="paragraph">
<p>该实体用于跟踪员工信息。在这种情况下，其名称和职位描述。</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">注意</div>
</td>
<td class="content">Spring Data REST不仅限于JPA。它支持许多NoSQL数据存储，但是您将不在这里介绍。
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_defining_the_repository">定义存储库</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Data REST应用程序的另一个关键部分是创建相应的存储库定义。</p>
</div>
<div class="listingblock">
<div class="title">src / main / java / com / greglturnquist / payroll / EmployeeRepository.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface EmployeeRepository extends CrudRepository&lt;Employee, Long&gt; {

}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>该存储库扩展了Spring Data Commons的<code>CrudRepository</code>并插入域对象的类型及其主键</li>
</ul>
</div>
<div class="paragraph">
<p>这就是所需要的！实际上，如果它是顶级可见的，则您甚至不必注释此不可见。如果您使用IDE并打开<code>CrudRepository</code> ，您将找到一个已经定义好的预先构建方法的拳头。</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">注意</div>
</td>
<td class="content">您可以根据需要定义<a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.definition">自己的存储库</a> 。Spring Data REST也支持这一点。
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pre_loading_the_demo">预加载演示</h2>
<div class="sectionbody">
<div class="paragraph">
<p>要使用此应用程序，您需要预加载一些数据，如下所示：</p>
</div>
<div class="listingblock">
<div class="title">src / main / java / com / greglturnquist / payroll / DatabaseLoader.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Component
public class DatabaseLoader implements CommandLineRunner {

	private final EmployeeRepository repository;

	@Autowired
	public DatabaseLoader(EmployeeRepository repository) {
		this.repository = repository;
	}

	@Override
	public void run(String... strings) throws Exception {
		this.repository.save(new Employee("Frodo", "Baggins", "ring bearer"));
	}
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>该课程标记为Spring的<code>@Component</code>批注，以便由<code>@SpringBootApplication</code> 。
</li>
<li>它实现了Spring Boot的<code>CommandLineRunner</code>以便在创建并注册所有bean之后运行它。
</li>
<li>它使用构造函数注入和自动装配来自动创建Spring Data <code>EmployeeRepository</code> 。
</li>
<li>的<code>run()</code>用命令行参数调用方法，加载数据。
</li>
</ul>
</div>
<div class="paragraph">
<p>Spring Data最大，最强大的功能之一就是它能够为您编写JPA查询。这不仅减少了您的开发时间，而且降低了错误和错误的风险。Spring Data在存储库类中<a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.query-methods.details">查看方法的名称，</a>并指出所需的操作，包括保存，删除和查找。</p>
</div>
<div class="paragraph">
<p>这就是我们可以编写一个空接口并继承已经建立的保存，查找和删除操作的方式。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adjusting_the_root_uri">调整根URI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>默认情况下，Spring Data REST在以下位置托管链接的根集合： <code>/</code> 。因为您将在同一路径上托管Web UI，所以需要更改根URI。</p>
</div>
<div class="listingblock">
<div class="title">src / main / resources / application.properties</div>
<div class="content">
<pre>spring.data.rest.base-path=/api</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_launching_the_backend">启动后端</h2>
<div class="sectionbody">
<div class="paragraph">
<p>全面运行REST API的最后一步是编写一个<code>public static void main</code>使用Spring Boot：</p>
</div>
<div class="listingblock">
<div class="title">src / main / java / com / greglturnquist / payroll / ReactAndSpringDataRestApplication.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@SpringBootApplication
public class ReactAndSpringDataRestApplication {

	public static void main(String[] args) {
		SpringApplication.run(ReactAndSpringDataRestApplication.class, args);
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>假设以前的类以及您的Maven构建文件都是从<a href="https://start.spring.io" class="bare">http://start.spring.io</a>生成的，则现在可以通过运行<code>main()</code> IDE中的方法，或键入<code>./mvnw spring-boot:run</code>在命令行上。 （对于Windows用户，为mvnw.bat）。</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">注意</div>
</td>
<td class="content">如果您不了解最新的Spring Boot及其工作原理，则应考虑观看<a href="https://www.youtube.com/watch?v=sbPSjI4tt10">Josh Long的介绍性演示之一</a> 。做到了？按下！
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_touring_your_rest_service">游览您的REST服务</h2>
<div class="sectionbody">
<div class="paragraph">
<p>随着应用程序的运行，您可以使用<a href="https://curl.haxx.se/">cURL</a> （或您喜欢的任何其他工具）在命令行中检出内容。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl localhost:8080/api
{
  "_links" : {
    "employees" : {
      "href" : "http://localhost:8080/api/employees"
    },
    "profile" : {
      "href" : "http://localhost:8080/api/profile"
    }
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>当您对根节点执行ping操作时，您会得到一系列链接，这些链接包装在<a href="http://stateless.co/hal_specification.html">HAL格式的JSON文档中</a> 。</p>
</div>
<div class="ulist">
<ul>
<li>
<strong>_links</strong>是可用链接的集合。
</li>
<li>
<strong>员工</strong>指向由定义的员工对象的汇总根<code>EmployeeRepository</code>接口。
</li>
<li>
<strong>配置文件</strong>是IANA标准的关系，指向有关整个服务的可发现元数据。我们将在以后的会议中进行探讨。
</li>
</ul>
</div>
<div class="paragraph">
<p>您可以通过导航<strong>员工</strong>链接来进一步研究该服务。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl localhost:8080/api/employees
{
  "_embedded" : {
    "employees" : [ {
      "firstName" : "Frodo",
      "lastName" : "Baggins",
      "description" : "ring bearer",
      "_links" : {
        "self" : {
          "href" : "http://localhost:8080/api/employees/1"
        }
      }
    } ]
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>在此阶段，您正在查看整个员工集合。</p>
</div>
<div class="paragraph">
<p>随您先前预加载的数据一起提供的是带有<strong>自我</strong>链接的<strong>_links</strong>属性。这是该特定员工的规范链接。什么是规范的？这意味着没有上下文。例如，可以通过/ api / orders / 1 / processor之类的链接来提取同一用户，在该链接中，员工被分配处理特定的订单。在这里，与其他实体没有关系。</p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<div class="title">重要</div>
</td>
<td class="content">链接是REST的重要方面。它们提供了导航到相关项目的功能。这样，其他各方就可以浏览您的API，而不必每次更改时都进行重写。当客户端硬代码访问资源时，客户端中的更新是一个常见问题。重组资源可能会导致代码发生重大变化。如果使用链接，而是维护导航路线，则进行此类调整变得容易且灵活。
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>如果愿意，您可以决定查看一位员工。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl localhost:8080/api/employees/1
{
  "firstName" : "Frodo",
  "lastName" : "Baggins",
  "description" : "ring bearer",
  "_links" : {
    "self" : {
      "href" : "http://localhost:8080/api/employees/1"
    }
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>这里没有什么变化，只是因为只有域对象，所以不需要<strong>_embedded</strong>包装器。</p>
</div>
<div class="paragraph">
<p>很好，但是您可能会想创建一些新条目。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -X POST localhost:8080/api/employees -d '{"firstName": "Bilbo", "lastName": "Baggins", "description": "burglar"}' -H 'Content-Type:application/json'
{
  "firstName" : "Bilbo",
  "lastName" : "Baggins",
  "description" : "burglar",
  "_links" : {
    "self" : {
      "href" : "http://localhost:8080/api/employees/2"
    }
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>您还可以如<a href="https://spring.io/guides/gs/accessing-data-rest/">本相关指南中</a>所示进行PUT，PATCH和DELETE。但是，我们不要深入探讨这一点。您已经花费了太多时间手动与该REST服务进行交互。您是否不想构建一个光滑的UI？</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_up_a_custom_ui_controller">设置自定义UI控制器</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot使站立自定义网页变得非常简单。首先，您需要一个Spring MVC控制器。</p>
</div>
<div class="listingblock">
<div class="title">src / main / java / com / greglturnquist / payroll / HomeController.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Controller
public class HomeController {

	@RequestMapping(value = "/")
	public String index() {
		return "index";
	}

}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<code>@Controller</code>将此类标记为Spring MVC控制器。
</li>
<li>
<code>@RequestMapping</code>标记<code>index()</code>支持的方法<code>/</code>路线。
</li>
<li>它返回<code>index</code>作为模板的名称，Spring Boot的自动配置的视图解析器将映射到该模板<code>src/main/resources/templates/index.html</code> 。
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_defining_an_html_template">定义HTML模板</h2>
<div class="sectionbody">
<div class="paragraph">
<p>您正在使用Thymeleaf，尽管您不会真正使用它的许多功能。</p>
</div>
<div class="listingblock">
<div class="title">src / main / resources / templates / index.html</div>
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head lang="en"&gt;
    &lt;meta charset="UTF-8"/&gt;
    &lt;title&gt;ReactJS + Spring Data REST&lt;/title&gt;
    &lt;script async="" data-main="/run.js" src="/bower_components/requirejs/require.js"&gt;&lt;/script&gt;
    &lt;link rel="stylesheet" href="/main.css" /&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;div id="react"&gt;&lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>此模板中的关键部分是<code><div id="react"></div></code>组件在中间。在这里，您将指示React插入渲染的输出。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_loading_javascript_modules">加载JavaScript模块</h2>
<div class="sectionbody">
<div class="paragraph">
<p>本教程不会详细介绍如何使用require.js加载JavaScript模块。但由于<strong>前端- Maven的插件</strong> ，你<em>没有</em>任何的Node.js的工具安装到构建和运行代码。</p>
</div>
<div class="paragraph">
<p>将使用以下JavaScript模块：</p>
</div>
<div class="ulist">
<ul>
<li>require.js</li>
<li>react.js</li>
<li>rest.js</li>
<li>requirejs-react-js</li>
</ul>
</div>
<div class="paragraph">
<p>如果你有兴趣，对JavaScript的moodules的路径定义在<a href="https://github.com/gregturn/react-and-spring-data-rest/blob/master/basic/src/main/resources/static/run.js">run.js</a> 。网页上的<a href="https://github.com/gregturn/react-and-spring-data-rest/blob/master/basic/src/main/resources/static/main.js">main.js</a>是通过<a href="https://github.com/gregturn/react-and-spring-data-rest/blob/master/basic/src/main/resources/static/main.js">main.js</a>加载的。</p>
</div>
<div class="paragraph">
<p>完成所有操作后，您可以集中精力在加载DOM之后获取的React位。它分为以下几部分：</p>
</div>
<div class="paragraph">
<p>由于您正在使用require.js加载内容，因此继续获取所需的模块：</p>
</div>
<div class="listingblock">
<div class="title">src / main / resources / static / app.jsx</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">var React = require('react');
var client = require('./client');</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<code>React</code>是Facebook构建该应用程序的主要库。
</li>
<li>
<code>client</code>是自定义代码，用于配置rest.js以包括对HAL，URI模板等的支持。还将默认的<strong>接受</strong>请求标头设置为<strong>application / hal + json</strong> 。您可以<a href="https://github.com/gregturn/react-and-spring-data-rest/blob/master/basic/src/main/resources/static/client.js">在此处阅读代码</a> 。
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_diving_into_react">潜入React</h2>
<div class="sectionbody">
<div class="paragraph">
<p>React是基于定义组件的。通常，一个组件可以以父子关系保存另一个组件的多个实例。这个概念很容易扩展几层。</p>
</div>
<div class="paragraph">
<p>首先，为所有组件配备一个顶层容器非常方便。（随着您扩展本系列中的代码，这一点将变得更加明显。）现在，您只有雇员列表。但是稍后您可能需要其他一些相关组件，因此让我们从此开始：</p>
</div>
<div class="listingblock">
<div class="title">src / main / resources / static / app.jsx-应用程序组件</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">var App = React.createClass({
    getInitialState: function () {
        return ({employees: []});
    },
    componentDidMount: function () {
        client({method: 'GET', path: '/api/employees'}).done(response =&gt; {
            this.setState({employees: response.entity._embedded.employees});
        });
    },
    render: function () {
        return (
            &lt;EmployeeList employees={this.state.employees}/&gt;
        )
    }
})</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<code>React.createClass({…​})</code>是创建React组件的方法。
</li>
<li>
<code>getInitialState</code>是用于初始化状态数据（预期会变化的数据）的API。
</li>
<li>
<code>componentDidMount</code>是React在DOM中渲染组件后调用的API。</li>
<li>
<code>render</code>是用于在屏幕上“绘制”组件的API。
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">注意</div>
</td>
<td class="content">在React中，大写是组件命名的约定。
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>在<strong>App</strong>组件中，从Spring Data REST后端获取一组雇员，并将其存储在该组件的<strong>状态</strong>数据中。</p>
</div>
<div id="NOTE" class="exampleblock">
<div class="content">
<div class="paragraph">
<p>React组件具有两种类型的数据： <strong>state</strong>和<strong>properties</strong> 。</p>
</div>
<div class="paragraph">
<p><strong>状态</strong>是组件期望自己处理的数据。也是可能波动和变化的数据。要读取状态，请使用<code>this.state</code> 。要更新它，您可以使用<code>this.setState()</code> 。每次<code>this.setState()</code>调用后，React更新状态，计算先前状态和新状态之间的差异，并向页面上的DOM注入一组更改。这样可以快速有效地更新您的UI。</p>
</div>
<div class="paragraph">
<p>通用约定是初始化状态，其中所有属性都为空<code>getInitialState</code> 。然后您使用以下命令从服务器中查找数据<code>componentDidMount</code>并填充您的属性。从那里开始，更新可以由用户操作或其他事件来驱动。</p>
</div>
<div class="paragraph">
<p><strong>属性</strong>包含传递到组件中的数据。属性不会改变，而是固定值。要进行设置，请在创建新组件时将它们分配给属性，您将很快看到。</p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<div class="title">警告</div>
</td>
<td class="content">JavaScript不会像其他语言一样锁定数据结构。您可以尝试通过分配值来颠覆属性，但这不适用于React的差分引擎，应避免使用。
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="paragraph">
<p>在此代码中，该函数通过<code>client</code> ，一个与<a href="https://promisesaplus.com/">Promise兼容</a>的rest.js实例。完成后从中检索<code>/api/employees</code> ，然后调用内部的函数<code>done()</code>并根据其HAL文档设置状态（ <code>response.entity._embedded.employees</code> ）。您可能还记得<code>curl /api/employees</code> <a href="#_touring_your_rest_service">前面的内容</a> ，看看它如何映射到此结构上。</p>
</div>
<div class="paragraph">
<p>状态更新后， <code>render()</code>函数由框架调用。员工状态数据包含在创建<code><EmployeeList /></code>反应组件作为输入参数。</p>
</div>
<div class="paragraph">
<p>以下是<code>EmployeeList</code> 。</p>
</div>
<div class="listingblock">
<div class="title">src / main / resources / static / app.jsx-EmployeeList组件</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">var EmployeeList = React.createClass({
    render: function () {
        var employees = this.props.employees.map(employee =&gt;
            &lt;Employee key={employee._links.self.href} employee={employee}/&gt;
        );
        return (
            &lt;table&gt;
                &lt;tr&gt;
                    &lt;th&gt;First Name&lt;/th&gt;
                    &lt;th&gt;Last Name&lt;/th&gt;
                    &lt;th&gt;Description&lt;/th&gt;
                &lt;/tr&gt;
                {employees}
            &lt;/table&gt;
        )
    }
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>使用JavaScript的地图功能， <code>this.props.employees</code>从一组员工记录转换为一组<code><Element /></code> React组件（您会在后面看到一些内容）。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">&lt;Employee key={employee._links.self.href} data={employee} /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>这显示了正在创建的新React组件（请注意大写格式）以及两个属性： <strong>key</strong>和<strong>data</strong> 。这些是从提供的值<code>employee._links.self.href</code>和<code>employee</code> 。</p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<div class="title">重要</div>
</td>
<td class="content">每当您使用Spring Data REST时， <strong>自</strong>链接都是给定资源的关键。React需要一个用于子节点的唯一标识符，并且<code>_links.self.href</code>是完美的。
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>最后，返回包装在<code>employees</code>使用映射构建。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;table&gt;
    &lt;tr&gt;
        &lt;th&gt;First Name&lt;/th&gt;
        &lt;th&gt;Last Name&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
    {employees}
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>状态，属性和HTML的这种简单布局显示了React如何使您以声明方式创建一个简单易懂的组件。</p>
</div>
<div id="NOTE" class="exampleblock">
<div class="content">
<div class="paragraph">
<p>此代码是否同时包含HTML <em>和</em> JavaScript？是。如果您注意到文件扩展名，则为<a href="https://facebook.github.io/jsx/">JSX</a> 。不需要使用它。React可以使用纯JavaScript编写，但是JSX语法非常简洁。</p>
</div>
<div class="paragraph">
<p>JSX还包含一些<a href="http://es6-features.org/#Constants">ES6</a> 。该代码中使用的一个是<a href="http://es6-features.org/#ExpressionBodies">箭头功能</a> 。它避免了创建一个嵌套函数（）有自己的作用域<strong>这一点</strong> ，避免了需要一个<a href="https://stackoverflow.com/a/962040/28214"><strong>自</strong>变量</a> 。</p>
</div>
<div class="paragraph">
<p>担心将逻辑与您的结构混合？React的API鼓励结合状态和属性的漂亮的声明式结构。React鼓励混合一些不相关的JavaScript和HTML，而不是混合使用一些无关的状态和属性，从而构建简单的组件。它使您可以查看单个组件并了解设计。然后它们很容易组合在一起形成更大的结构。</p>
</div>
</div>
</div>
<div class="paragraph">
<p>接下来，您需要实际定义<code><Employee /></code>是。</p>
</div>
<div class="listingblock">
<div class="title">src / main / resources / static / app.jsx-员工组件</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">var Employee = React.createClass({
    render: function () {
        return (
            &lt;tr&gt;
                &lt;td&gt;{this.props.employee.firstName}&lt;/td&gt;
                &lt;td&gt;{this.props.employee.lastName}&lt;/td&gt;
                &lt;td&gt;{this.props.employee.description}&lt;/td&gt;
            &lt;/tr&gt;
        )
    }
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>这个组件非常简单。它有一个围绕员工的三个属性的HTML表行。财产本身是<code>this.props.employee</code> 。请注意，传递JavaScript对象如何使传递从服务器获取的数据变得容易？</p>
</div>
<div class="paragraph">
<p>因为此组件不管理任何状态，也不处理用户输入，所以没有其他事情要做。这可能会诱使您将其塞入<code><EmployeeList /></code>之上。别做！取而代之的是，将您的应用程序分解为各个小组件，每个组件都完成一项工作，这将使将来构建功能变得更加容易。</p>
</div>
<div class="paragraph">
<p>最后一步是渲染整个内容。</p>
</div>
<div class="listingblock">
<div class="title">src / main / resources / static / app.jsx-渲染代码</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">React.render(
    &lt;App /&gt;,
    document.getElementById('react')
)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>React.render()</code>接受两个参数：您定义的React组件以及将其注入的DOM节点。记住你如何看待<code><div id="react"></div></code> HTML页面中较早的项目？这是它被拾起并插入的地方。</p>
</div>
<div class="paragraph">
<p>一切就绪后，重新运行应用程序（ <code>./mvnw spring-boot:run</code> ）并访问<a href="http://localhost:8080" class="bare">http：// localhost：8080</a> 。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://github.com/gregturn/react-and-spring-data-rest/raw/master/basic/images/basic-1.png" alt="基本1">
</div>
</div>
<div class="paragraph">
<p>您可以看到系统加载了初始员工。</p>
</div>
<div class="paragraph">
<p>还记得使用cURL创建新条目吗？再做一次。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -X POST localhost:8080/api/employees -d '{"firstName": "Bilbo", "lastName": "Baggins", "description": "burglar"}' -H 'Content-Type:application/json'</pre>
</div>
</div>
<div class="paragraph">
<p>刷新浏览器，您应该看到新条目：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://github.com/gregturn/react-and-spring-data-rest/raw/master/basic/images/basic-2.png" alt="基本2">
</div>
</div>
<div class="paragraph">
<p>现在，您可以在网站上看到这两个列表。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_review">评论</h2>
<div class="sectionbody">
<div class="paragraph">
<p>在此会话中：</p>
</div>
<div class="ulist">
<ul>
<li>您定义了一个域对象和一个相应的存储库。
</li>
<li>您让Spring Data REST通过功能强大的超媒体控件将其导出。
</li>
<li>您在父子关系中创建了两个简单的React组件。
</li>
<li>您获取了服务器数据并将其呈现为简单的静态HTML结构。
</li>
</ul>
</div>
<div class="paragraph">
<p>有问题吗？</p>
</div>
<div class="ulist">
<ul>
<li>该网页不是动态的。您必须刷新浏览器才能获取新记录。
</li>
<li>该网页未使用任何超媒体控件或元数据。相反，它被硬编码为从<code>/api/employees</code> 。
</li>
<li>它是只读的。尽管您可以使用cURL更改记录，但网页没有提供任何内容。
</li>
</ul>
</div>
<div class="paragraph">
<p>这些是我们在下届会议上可以解决的问题。在此之前，祝您编程愉快！</p>
</div>
</div>
</div></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 2220;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>请启用JavaScript以查看<a href="http://disqus.com/?ref_noscript">由Disqus提供</a>的<a href="http://disqus.com/?ref_noscript">评论。</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">由<span class="logo-disqus">Disqus</span>提供动力的评论</a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>背部</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">所有帖子</a> <a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">工程</a> <a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">发布</a> <a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">新闻与活动</a> <a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>将The Spring Team的更新发送到您的收件箱</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">球队</a></li>
<li><a href="/tools">工具类</a></li>
<li><a href="https://store.pivotal.io/">商店</a></li>
<li><a href="/blog">通讯</a></li>
</ul>
</div>
</div>© <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a> ，Inc.保留所有权利。
<a href="https://pivotal.io/terms-of-use">使用条款</a> • <a href="https://pivotal.io/privacy-policy">隐私</a> • <a href="/trademarks">商标准则</a>
<div id="teconsent" style="display:inline-block"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
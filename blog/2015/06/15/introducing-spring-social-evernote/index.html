<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>Introducing Spring Social Evernote</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="Introducing Spring Social Evernote" />
<meta name="twitter:description" content="&lt;blockquote&gt;
 &lt;p&gt;This post is a guest post by community &lt;a href=&quot;http://twitter.com/ttddyy&quot;&gt;member Tadaya Tsuyukubo (@ttddyy)&lt;/a&gt;, creator of the Spring Social Slideshare project. Thanks Tadaya! I’d like to see more of these guest posts, so - as usual - &lt;a href=&quot;http://spring.io/team/jlong&quot;&gt;don’t hesitate to ping me&lt;/a&gt;! -Josh&lt;/p&gt; 
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/ttddyy/spring-social-evernote&quot;&gt;Spring Social Evernote&lt;/a&gt; is one of the community modules in the &lt;a href=&quot;http://projects.spring.io/spring-social/&quot;&gt;Spring Social&lt;/a&gt; ecosystem. It is a service provider implementation for &lt;a href=&quot;http://evernote.com&quot;&gt;Evernote&lt;/a&gt;. It allows developers to work with the &lt;a href=&quot;https://github.com/evernote/evernote-sdk-java&quot;&gt;Evernote SDK for Java&lt;/a&gt; with idiomatic Spring idioms.&lt;/p&gt;
&lt;p&gt;Evernote takes a unique approach for providing their APIs to developers. They have created &lt;a href=&quot;https://dev.evernote.com/doc/&quot;&gt;language specific SDKs&lt;/a&gt; based on &lt;a href=&quot;https://Thrift.apache.org/&quot;&gt;Thrift serialization format&lt;/a&gt;. Dave Engberg, CTO of Evernote, &lt;a href=&quot;https://blog.evernote.com/tech/2011/05/26/evernote-and-Thrift/&quot;&gt;explained the motivations for choosing Thrift in this blog&lt;/a&gt;.&lt;/p&gt;
" />
<meta name="twitter:creator" content="@starbuxman" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/fb22593caf24e4bb4c98d467cdd247e6?s=200" />

<meta property="og:title" content="Introducing Spring Social Evernote" />
<meta property="og:image" content="https://gravatar.com/avatar/fb22593caf24e4bb4c98d467cdd247e6?s=200" />
<meta property="og:description" content="&lt;blockquote&gt;
 &lt;p&gt;This post is a guest post by community &lt;a href=&quot;http://twitter.com/ttddyy&quot;&gt;member Tadaya Tsuyukubo (@ttddyy)&lt;/a&gt;, creator of the Spring Social Slideshare project. Thanks Tadaya! I’d like to see more of these guest posts, so - as usual - &lt;a href=&quot;http://spring.io/team/jlong&quot;&gt;don’t hesitate to ping me&lt;/a&gt;! -Josh&lt;/p&gt; 
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/ttddyy/spring-social-evernote&quot;&gt;Spring Social Evernote&lt;/a&gt; is one of the community modules in the &lt;a href=&quot;http://projects.spring.io/spring-social/&quot;&gt;Spring Social&lt;/a&gt; ecosystem. It is a service provider implementation for &lt;a href=&quot;http://evernote.com&quot;&gt;Evernote&lt;/a&gt;. It allows developers to work with the &lt;a href=&quot;https://github.com/evernote/evernote-sdk-java&quot;&gt;Evernote SDK for Java&lt;/a&gt; with idiomatic Spring idioms.&lt;/p&gt;
&lt;p&gt;Evernote takes a unique approach for providing their APIs to developers. They have created &lt;a href=&quot;https://dev.evernote.com/doc/&quot;&gt;language specific SDKs&lt;/a&gt; based on &lt;a href=&quot;https://Thrift.apache.org/&quot;&gt;Thrift serialization format&lt;/a&gt;. Dave Engberg, CTO of Evernote, &lt;a href=&quot;https://blog.evernote.com/tech/2011/05/26/evernote-and-Thrift/&quot;&gt;explained the motivations for choosing Thrift in this blog&lt;/a&gt;.&lt;/p&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2015-06-15 12:19:31.347" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Introducing Spring Social Evernote</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/fb22593caf24e4bb4c98d467cdd247e6?s=20&amp;d=mm" />
<a class="author" rel="author" href="/team/jlong">Josh Long</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2015-06-15 12:19:31.347">June 15, 2015</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="2163" href="/blog/2015/06/15/introducing-spring-social-evernote#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><blockquote><p>This post is a guest post by community <a href="https://twitter.com/ttddyy">member Tadaya Tsuyukubo (@ttddyy)</a>, creator of the Spring Social Slideshare project. Thanks Tadaya! I’d like to see more of these guest posts, so - as usual - <a href="https://spring.io/team/jlong">don’t hesitate to ping me</a>! -Josh</p>
</blockquote><p><a href="https://github.com/ttddyy/spring-social-evernote">Spring Social Evernote</a> is one of the community modules in the <a href="https://projects.spring.io/spring-social/">Spring Social</a> ecosystem. It is a service provider implementation for <a href="https://evernote.com">Evernote</a>. It allows developers to work with the <a href="https://github.com/evernote/evernote-sdk-java">Evernote SDK for Java</a> with idiomatic Spring idioms.</p><p>Evernote takes a unique approach for providing their APIs to developers. They have created <a href="https://dev.evernote.com/doc/">language specific SDKs</a> based on <a href="https://Thrift.apache.org/">Thrift serialization format</a>. Dave Engberg, CTO of Evernote, <a href="https://blog.evernote.com/tech/2011/05/26/evernote-and-Thrift/">explained the motivations for choosing Thrift in this blog</a>.</p><p>The Java SDK includes Thrift-generated domain classes (e.g. <code>Notebook</code>, <code>Note</code>, <code>User</code>, etc.) and endpoint access clients (e.g. <code>UserStoreClient</code>, <code>NoteStoreClient</code>, etc). Even though <code>~StoreClient</code> classes nicely encapsulate authentication and Thrift protocol for endpoint communication, they still have a few limitations. </p><p>For example, all Thrift methods that do communication in the various <code>~StoreClient</code> types throw <strong>checked</strong> exceptions. Also, <code>~StoreClient</code> classes don’t have interfaces corresponding to their operations, which frustrates (somewhat) unit testing.<br /><a href="https://github.com/ttddyy/spring-social-evernote">Spring Social Evernote</a> fills these gaps while delivering a familiar Spring Social programming model.</p><h2><a href="#features" class="anchor" name="features"></a>Features</h2><p>Spring Social Evernote delivers a familiar Spring and Java-based programmingmodel that uses interfaces, unchecked exceptions, and <code>null</code>-safe <code>Collection</code>s for Thrift-based domain objects. It also provides a service provider implementation for the Evernote OAuth API.</p><p>The <code>Evernote</code> interface and it’s implementation, <code>EvernoteTemplate</code>, are the central types for the API. The <code>Evernote</code> interface returns <code>~StoreOperations</code> (e.g. <code>NoteStoreOperations</code>, or <code>UserStoreOperations</code>) interfaces that correspond to the SDK&rsquo;s <code>~StoreClient</code> classes. Methods on these interfaces throw <strong>unchecked</strong> <code>EvernoteException</code> instead of checked <code>EDAM*Exception</code>. These implementations also have smarter <code>null</code>-value handling for collections in Thrift-generated domain types.</p>
<pre><code class="prettyprint java">Evernote evernote = new EvernoteTemplate(
    EvernoteService.SANDBOX, &quot;your-custom-access-token&quot;);

// interface based programming
NoteStoreOperations noteStore = evernote.noteStoreOperations();

// no checked exception is thrown
Notebook notebook = noteStore.getDefaultNotebook();

// no NPE when there are no shared notebooks
for (SharedNotebook sharedNotebook : notebook.getSharedNotebooks()) {  
    ...
}
</code></pre><h3><a href="#interface-based-programming-for-store-clients" class="anchor" name="interface-based-programming-for-store-clients"></a>Interface based programming for store clients</h3><p><code>~StoreClientOperations</code> interface classes correspond to <code>~StoreClient</code> implementation classes (e.g. <code>NoteStoreClientOperations</code> corresponds to <code>com.evernote.clients.NoteStoreClient</code>).</p>
<pre><code class="prettyprint java">// NoteStoreOperations is interface encapsulating NoteStoreClient
NoteStoreOperations noteStore = evernote.noteStoreClientOperations();
Notebook notebook = noteStore.getNotebook(&quot;...&quot;);
</code></pre><h3><a href="#unchecked-exceptions-for-endpoint-operations" class="anchor" name="unchecked-exceptions-for-endpoint-operations"></a>Unchecked exceptions for endpoint operations</h3><p>EDAM exceptions (e.g. <code>com.evernote.edam.error.EDAMUserException</code>) and Thrift exceptions (e.g. <code>com.evernote.Thrift.TException</code>) are trapped and rethrown as <em>runtime</em> exceptions of type <code>EvernoteException</code>. </p>
<pre><code class="prettyprint java">// with UserStoreOperations, no explicit exception handling is required
User user = evernote.userStoreOperations().getUser();

// or explicitly you can get exception info
try {
  User user = userStoreClient.getUser();
} catch(EvernoteException e) {
  if (e.isEDAMUserException()) {
     EDAMErrorCode errorCode = e.getEDAMErrorCode();
     EDAMUserException originalException = e.getCause();
     ....
  }
}
</code></pre><h3><a href="#null-safe-collection-handling-for-thrift-based-domain-objects" class="anchor" name="null-safe-collection-handling-for-thrift-based-domain-objects"></a>Null-safe collection handling for Thrift-based domain objects</h3><p>In Thrift, a <code>null</code> collection isn&rsquo;t serialized, but the convention can cause some unexpected <code>NullPointerException</code>s when using the API. The Spring Social Evernote implementation sanitizes these values with empty collections.</p>
<pre><code class="prettyprint java">Note note = evernote.noteStoreOperations().getNote(...)
// it is safe to loop without null check
for(Resource resource: note.getResources()) {
  ...
}
</code></pre><p>or (in Java 8):</p>
<pre><code class="prettyprint java"> evernote.noteStoreOperations()
    .getNote()
    .getResources()
        .forEach ( r -&gt; System.out.println( r.toString() ));
</code></pre><p>Spring Social Evernote dirty checks the types and restores their <code>null</code> values just before serialization if the collection is otherwise empty.</p><p>For more on this particular support, check out <a href="https://github.com/ttddyy/nullsafe-Thrift">nullsafe-Thrift</a> - a proof-of-concept project.</p><h2><a href="#service-provider-implementation-for-evernote-oauth" class="anchor" name="service-provider-implementation-for-evernote-oauth"></a>Service provider implementation for Evernote OAuth</h2><p><em>Registering <code>ConnectionFactory</code></em></p><p>To register Evernote environment (<code>sandbox</code>, <code>prod</code>, <code>yinxiang</code>) into Spring Social Service Provider Connect Framework, you can use environment-specific <code>ConnectionFactory</code> classes like <code>EvernoteSandboxConnectionFactory</code>, <code>EvernoteProductionConnectionFactory</code>, or <code>EvernoteYinXiangConnectionFactory</code>. Alternatively, you can pass <code>EvernoteService</code> enum to <code>EvernoteConnectionFactory</code> in constructor.</p>
<pre><code class="prettyprint java">ConnectionFactoryRegistry registry = new ConnectionFactoryRegistry();

// sandbox connection
registry.addConnectionFactory(new EvernoteSandboxConnectionFactory(&quot;consumerKey&quot;, &quot;consumerSecret&quot;));

// production connection
registry.addConnectionFactory(new EvernoteProductionConnectionFactory(&quot;consumerKey&quot;, &quot;consumerSecret&quot;));

// or by EvernoteService enum
registry.addConnectionFactory(new EvernoteConnectionFactory(&quot;consumerKey&quot;, &quot;consumerSecret&quot;, EvernoteService.SANDBOX));
</code></pre><h2><a href="#using-evernote-rsquo-s-oauth-api" class="anchor" name="using-evernote-rsquo-s-oauth-api"></a>Using Evernote&rsquo;s OAuth API</h2><p>Performing <a href="https://dev.evernote.com/doc/articles/authentication.php">Evernote-based OAuth authentication</a> works as follows:</p>
<pre><code class="prettyprint java">// obtain request token (temporal credential)
OAuth1Operations oauthOperations = evernoteConnectionFactory.getOAuthOperations();
OAuthToken requestToken = oauthOperations.fetchRequestToken(
    callbackUrl, null);

// construct authorization url with callback url for client to redirect
OAuth1Parameters parameters = new OAuth1Parameters();
parameters.set(&quot;preferRegistration&quot;, &quot;true&quot;); // create account
parameters.set(&quot;supportLinkedSandbox&quot;, &quot;true&quot;);

String authorizeUrl = oauthOperations.buildAuthorizeUrl(
        requestToken.getValue(), parameters);

// obtain access token
OAuthToken requestToken = new OAuthToken(oauthToken, requestTokenSecret);
AuthorizedRequestToken authorizedRequestToken = new AuthorizedRequestToken(requestToken, oauthVerifier);

OAuth1Operations oAuth1Operations = evernoteConnectionFactory.getOAuthOperations(); // EvernoteOAuth1Operations
EvernoteOAuthToken accessToken = (EvernoteOAuthToken)oAuth1Operations.exchangeForAccessToken(authorizedRequestToken, null);

</code></pre><h1><a href="#next-steps" class="anchor" name="next-steps"></a>Next Steps</h1><p>For more project documentation, check out the <a href="https://github.com/ttddyy/spring-social-evernote/wiki/About">project wiki page</a>. Also, nullsafe collection in Thrift can be demonstrated in this <a href="https://github.com/ttddyy/nullsafe-Thrift/blob/master/src/test/java/net/ttddyy/nullsafeThrift/ThriftWrapperTest.java">test class</a> as well.</p><p>Since Evernote doesn’t have RESTful API, I have created a web application, <a href="https://github.com/ttddyy/evernote-rest-webapp">Evernote Rest Webapp</a>, which provides RESTful endpoints for Evernote services. It is built on top of <a href="https://projects.spring.io/spring-boot/">Spring Boot</a> and <a href="https://github.com/ttddyy/spring-social-evernote">Spring Social Evernote</a>. This implementation serves as a sort of bridge-API if you&rsquo;re interested.</p><h2><a href="#summary" class="anchor" name="summary"></a>Summary</h2><p><a href="https://github.com/ttddyy/spring-social-evernote">Spring Social Evernote</a> provides modern programming model and easy integration with Evernote authentication to your application.</p><p>If you have any suggestion, question, or anything, please ping me <a href="https://twitter.com/ttddyy">@ttddyy</a>.</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 2163;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
<html dir="ltr" data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>扩展Spring Cloud</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>System.config({baseURL: "/b92013b"});</script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>System.import('app/main.js')</script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="Extending Spring Cloud">
<meta name="twitter:description" content="<p>One of the most interesting capabilities of Spring Cloud is its extensibility. You can extend it to support additional clouds, enhance already supported clouds, support new services, new service connectors–all without modifying the Spring Cloud code itself. In this blog, we explore this capability. If you haven’t done so already, please read the <a href=" https:="" ="" spring.io="" blog="" 2014="" 06="" 03="" introducing-spring-clou="="></head><body dir="ltr">first and <a href="https://spring.io/blog/2014/07/29/using-spring-cloud-programmatically">second</a> blog in this series to acquire sufficient background.
<h1><a href="#the-three-axes-of-extensibility" class="anchor" name="the-three-axes-of-extensibility"></a>The three axes of extensibility</h1>
<p>Spring Cloud provides extensibility along three orthogonal directions. You may extend it in one of these directions and orthogonality ensures that you continue to benefit from the others.</p>
">
<meta name="twitter:image:src" content="https://gravatar.com/avatar/8fa7e069d3807412499606915fddc108?s=200">

<meta property="og:title" content="Extending Spring Cloud">
<meta property="og:image" content="https://gravatar.com/avatar/8fa7e069d3807412499606915fddc108?s=200">
<meta property="og:description" content="<p>One of the most interesting capabilities of Spring Cloud is its extensibility. You can extend it to support additional clouds, enhance already supported clouds, support new services, new service connectors–all without modifying the Spring Cloud code itself. In this blog, we explore this capability. If you haven’t done so already, please read the <a href=" https:="" ="" spring.io="" blog="" 2014="" 06="" 03="" introducing-spring-clou="=">first and <a href="https://spring.io/blog/2014/07/29/using-spring-cloud-programmatically">second</a> blog in this series to acquire sufficient background.
<h1><a href="#the-three-axes-of-extensibility" class="anchor" name="the-three-axes-of-extensibility"></a>The three axes of extensibility</h1>
<p>Spring Cloud provides extensibility along three orthogonal directions. You may extend it in one of these directions and orthogonality ensures that you continue to benefit from the others.</p>
">
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2014-08-05 16:33:30.926">



<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">// Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }</script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">专案</a>
</li>
<li class="navbar-link">
<a href="/guides">导游</a>
</li>
<li class="navbar-link active">
<a href="/blog">博客</a>
</li>
<li class="navbar-link">
<a href="/services">培训与认证</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索文档，指南和帖子..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">家<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">专案<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">导游<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">博客<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">培训与认证<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>工程</div>
</div>
<div class="blog-category content--title">
<div>发布</div>
</div>
<div class="blog-category content--title">
<div>新闻与活动</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">扩展Spring Cloud</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">工程</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/8fa7e069d3807412499606915fddc108?s=20&d=mm"> <span class="author">拉姆尼瓦斯·拉达德（Ramnivas Laddad）</span>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2014-08-05 16:33:30.926">2014年8月5日</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2014/08/05/extending-spring-cloud#disqus_thread" data-disqus-identifier="1697">
</a></div>
</div>
</header>
<div class="blog--post"><p>Spring Cloud最有趣的功能之一就是其可扩展性。您可以扩展它以支持其他云，增强已经支持的云，支持新服务，新服务连接器-所有这些都无需修改Spring Cloud代码本身。在此博客中，我们探索了这种功能。如果您还没有这样做，请阅读本系列的<a href="https://spring.io/blog/2014/06/03/introducing-spring-cloud">第一个</a>和<a href="https://spring.io/blog/2014/07/29/using-spring-cloud-programmatically">第二个</a>博客以获取足够的背景知识。</p><h1><a href="#the-three-axes-of-extensibility" class="anchor" name="the-three-axes-of-extensibility"></a>可扩展性的三个轴</h1><p>Spring Cloud提供了沿三个正交方向的可扩展性。您可以在这些方向之一中进行扩展，并且正交性可确保您继续从其他方向中受益。</p>
<ol>
<li><p><strong>云平台</strong> ：虽然Spring Cloud支持Cloud Foundry，Heroku和Local Config云（以在类似云的环境中进行本地测试），但是您不受这些选择的限制。您可以添加自己的云平台并利用Spring Cloud的其余功能，例如Spring Java Config。</p></li>
<li><p><strong>云服务</strong> ：云平台提供了从关系数据库到消息传递的各种服务。每个云平台提供的服务差异很大，即使对于同一平台的多个安装也是如此。对于诸如Cloud Foundry之类的PaaS产品而言尤其如此，其中Cloud Foundry的私有实例往往具有特定于每个安装的服务。Spring Cloud提供了一种扩展其核心产品之外的服务的简便方法。就像云平台的可扩展性一样，您无需更改Spring Cloud代码即可将其扩展到新服务，而您将继续利用其他部分的优势。</p></li>
<li><p><strong>框架</strong> ：Spring Cloud当前通过<a href="https://github.com/spring-projects/spring-cloud/tree/master/spring-cloud-spring-service-connector">spring-service-connector</a>模块支持Spring框架。但是，除了该模块之外，Spring Cloud中的任何内容都不依赖于Spring。这样，您应该能够使用任何基于JVM的框架中的其他部分，或者通过添加新模块将其扩展为框架。</p></li>
</ol><p>在<a href="https://spring.io/blog/2014/07/29/using-spring-cloud-programmatically">上一篇博客中</a> ，我们介绍了如何使用<code>CloudFactory</code>和<code>Cloud</code>以编程方式使用Spring Cloud。当涉及到可扩展性时，您将不会使用其中任何一个。相反，您将在核心模块中实现其他类型。让我们看看它们。</p><h1><a href="#cloud-platform-extensibility" class="anchor" name="cloud-platform-extensibility"></a>云平台可扩展性</h1><p>将Spring Cloud扩展到新的云平台时，您需要熟悉的主要类型是<code>CloudConnector</code> ，它是一个简单的三方法界面：</p>
<pre><code class="prettyprint java">public interface CloudConnector {
	boolean isInMatchingCloud();
	ApplicationInstanceInfo getApplicationInstanceInfo();
	List<ServiceInfo> getServiceInfos();
}
</code></pre><p><code>isInMatchingCloud()</code>方法应检查其环境，以确定它是否在正确的环境中运行。例如，Cloud Foundry连接器检查<code>VCAP_APPLICATION</code>环境变量的存在，而Heroku连接器寻找<code>DYNO</code>环境变量的存在。<code>getApplicationInstanceInfo()</code>方法返回有关当前应用程序实例的信息（应用程序名称，主机，端口和应用程序属性）。最有趣的方法<code>getServiceInfos()</code>返回一个列表，其中每个元素包含足够的信息，以便应用程序知道如何连接到每个服务。每个<code>ServiceInfo</code>对象中包含的确切信息将留给每个实现（因此<code>ServiceInfo</code>仅定义一个方法： <code>getId()</code> ）。</p><p>创建<code>CloudConnector</code>的实现后，您需要使Spring Cloud意识到这一点。对于所有扩展点，Spring Cloud使用基于<a href="https://docs.oracle.com/javase/7/docs/api/java/util/ServiceLoader.html">ServiceLoader</a>的统一机制。应用于Spring Cloud进行平台扩展时，它归结为包含一个名为<code>/META-INF/services/org.springframework.cloud.CloudConnector</code></p><h1><code>/META-INF/services/org.springframework.cloud.CloudConnector</code></h1><p><code>/META-INF/services/org.springframework.cloud.CloudConnector</code></p><code>/META-INF/services/org.springframework.cloud.CloudConnector</code></div><code>/META-INF/services/org.springframework.cloud.CloudConnector</code></div><code>/META-INF/services/org.springframework.cloud.CloudConnector</code></article><code>/META-INF/services/org.springframework.cloud.CloudConnector</code></div><code>/META-INF/services/org.springframework.cloud.CloudConnector</code></div><code>/META-INF/services/org.springframework.cloud.CloudConnector</code></div><code>/META-INF/services/org.springframework.cloud.CloudConnector</code></div><code>/META-INF/services/org.springframework.cloud.CloudConnector</code></body></html>
<html dir="ltr" data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>反应器1.1.0。现在发布</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>System.config({baseURL: "/b92013b"});</script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>System.import('app/main.js')</script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="Reactor 1.1.0.RELEASE now available">
<meta name="twitter:description" content="<p>The Reactor team is pleased to announce that some significant updates to the Reactor framework are now available in the 1.1.0.RELEASE version of Reactor’s flexible, asynchronous, fast data framework. This version includes numerous bug fixes and rewrites of key components to make them faster and, maybe more importantly, more efficient in terms of memory usage. Reactor 1.1 now includes the fantastic <code>gs-collections</code> library from Goldman Sachs [1] which provides a very fluent API for dealing with maps and collections of all kinds.</p>
">
<meta name="twitter:creator" content="@j_brisbin">
<meta name="twitter:image:src" content="http://gravatar.com/avatar/5500b5cf634f9a3921e4619778a1425f?s=200">

<meta property="og:title" content="Reactor 1.1.0.RELEASE now available">
<meta property="og:image" content="http://gravatar.com/avatar/5500b5cf634f9a3921e4619778a1425f?s=200">
<meta property="og:description" content="<p>The Reactor team is pleased to announce that some significant updates to the Reactor framework are now available in the 1.1.0.RELEASE version of Reactor’s flexible, asynchronous, fast data framework. This version includes numerous bug fixes and rewrites of key components to make them faster and, maybe more importantly, more efficient in terms of memory usage. Reactor 1.1 now includes the fantastic <code>gs-collections</code> library from Goldman Sachs [1] which provides a very fluent API for dealing with maps and collections of all kinds.</p>
">
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2014-05-06 15:02:13.145">
</head>
<body dir="ltr">

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">// Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }</script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">专案</a>
</li>
<li class="navbar-link">
<a href="/guides">导游</a>
</li>
<li class="navbar-link active">
<a href="/blog">博客</a>
</li>
<li class="navbar-link">
<a href="/services">培训与认证</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索文档，指南和帖子..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">家<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">专案<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">导游<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">博客<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">培训与认证<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category content--title">
<div>工程</div>
</div>
<div class="blog-category active content--title">
<div>发布</div>
</div>
<div class="blog-category content--title">
<div>新闻与活动</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">反应器1.1.0。现在发布</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon releases"></div>
<a class="category">发布</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/5500b5cf634f9a3921e4619778a1425f?s=20&d=mm"> <span class="author">乔恩·布里斯宾</span>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2014-05-06 15:02:13.145">2014年5月6日</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2014/05/06/reactor-1-1-0-release-now-available#disqus_thread" data-disqus-identifier="1555">
</a></div>
</div>
</header>
<div class="blog--post"><p>Reactor团队高兴地宣布1.1.0中现已提供对Reactor框架的一些重要更新。Reactor的灵活，异步，快速数据框架的RELEASE版本。此版本包含许多错误修复程序以及对关键组件的重写，以使它们更快，并且更重要的是，在内存使用方面更为有效。现在，Reactor 1.1包含了高盛[1]出色的<code>gs-collections</code>库，该库提供了非常流畅的API，用于处理各种地图和集合。</p><p>这是Reactor 1.0和1.1之间的非详尽列表：</p><h4><a href="#stream-promise" class="anchor" name="stream-promise"></a>流/承诺</h4>
<ul>
<li>改进的流和承诺值处理</li>
<li>其他组合方法，例如connect（），merge（），timeout（），window（）等</li>
<li>许多方法移入Composable，因此在Stream和Promise之间共享</li>
</ul><p>在版本1.0上对Stream API的一些更有用的添加包括<code>Stream.window</code>和<code>Stream.timeout</code>方法。这使您可以收集给定时间段内的值，并将其传递到处理链中。例如，要处理每500ms收集的任何值，请使用一个<code>window</code> ：</p>
<pre><code class="prettyprint java">Deferred<Pojo, Stream<Pojo>> in = Streams.defer(env);

// add all collected values every half-second
in.compose()
  .window(500)
  .consume(values -> service.addAll(values));

// another service emits data into the `Deferred`
Pojo p;
while(null != (p = input.next())) {
  in.accept(p);
}
</code></pre><h4><a href="#utilities" class="anchor" name="utilities"></a>实用工具</h4>
<ul>
<li>基于稳健HashWheelTimer实行<code>RingBuffer</code></li>
<li>用于有效对象池的分配器API</li>
<li>基于<code>gs-collections</code> 5.0 [1]的新的Consumer Registry实现</li>
</ul><p>如果您需要以更可预测的方式控制内存使用，Reactor包括一个分配API，该API可以由您所需的池的任何特定实现来支持。Reactor 1.1带有两种实现：基于RingBuffer的<code>Allocator</code>和引用计数的<code>Allocator</code> 。</p><p>可以将基于<code>Allocator</code>配置为非常类似于具有事件处理程序的标准Disruptor <code>RingBuffer</code> 。但是，如果您需要阻止生产者并使用基于插槽的分配策略，那么使用RingBuffer进行分配非常简单：</p>
<pre><code class="prettyprint java">Allocator<Event<Buffer>> pool = new RingBufferAllocatorSpec<Event<Buffer>>()
    .ringSize(16 * 1024)
    .allocator(() -> new Event<Buffer>(null))
    .waitStrategy(new BusySpinWaitStrategy())
    .get();

// in your code, maintain a `Reference` you can release
Reference<Event<Buffer>> ref = pool.allocate();

// pass your data POJO to other services
Event<Buffer> ev = ref.get().setData(buffer);
service.invoke(ev);

// when you're done, release the reference
ref.release();
</code></pre><h4><a href="#logging" class="anchor" name="logging"></a>记录中</h4>
<ul>
<li>使用Java Chronicle的极高效的高速日志记录</li>
<li>重写了基于Reactor的异步追加器实现</li>
</ul><p>日志记录可能对异步应用程序的性能非常不利-尤其是使用像RingBuffer这样的技术的日志记录，该技术使用单个线程来支持许多任务。如果该线程被执行IO的一项任务写日志条目阻塞，则可能潜在地级联返回整个应用程序，并导致该应用程序停止运行。</p><p>Reactor包括针对Logback [2]的高效异步<code>Appender</code>实现，该实现将实际追加操作移至专用的日志线程。这应该有助于减轻大多数应用程序中登录引起的线程压力。但是有时甚至还不够，需要更高吞吐量的解决方案。那就是Reactor基于Java Chronicle的<code>Appender</code>派上用场的地方。</p><p>Java Chronicle [3]是一个高速消息传递库，它使用内存映射文件来实现快速有效的数据持久性。Reactor通过提供一个<code>Appender</code>将它与Logback集成在一起，该<code>Appender</code>可以记录来自应用程序的原始事件数据，而不必调用下游的附加程序。这意味着您的日志记录事件存储在<code>Chronicle</code>但处于原始状态。需要一个附加实用程序来对“持久”日志文件进行后处理，然后将这些事件发送到“真实”附加程序（例如发送到文件或数据库），或者窥探《 <code>Chronicle</code>并查找与给定模式匹配的条目。这在生产环境中非常有用，在这种情况下，您不必担心日志是否会正常运行，但如果出现问题，则可以轻松地将<code>Chronicle</code>记录中的数据提取到标准日志文件中以进行法医分析。</p><p>要将Reactor <code>DurableAsyncAppender</code>配置为进行高速日志记录，只需在Logback配置中声明它即可。下面是一个使用它的一个例子<code>logback.xml</code>配置：</p>
<pre><code class="prettyprint xml">  <appender name="chronicle" class="reactor.logback.DurableAsyncAppender">
    <!-- Uncomment to have log events also sent to a "normal" file appender -->
    <!--appender-ref ref="logfile"/-->
    <basePath>log/</basePath>
    <backlog>2097152</backlog>
  </appender>
</code></pre><p>如果出现问题，您可以使用包含的实用程序，通过将从编年史中提取的事件定向到给定的“真实” <code>Appender</code>来分析编年史。此示例调用日志实用程序（ <code>reactor-logback.jar</code>工件必须在类路径上），并从<code>log/</code>目录中读取持久日志文件，从<code>logback.xml</code>读取Logback配置，然后将所有错误消息输出到<code>logfile</code>附加程序，在<code>logback.xml</code>配置文件中定义。</p>
<pre><code class="prettyprint">java reactor.logback.DurableLogUtility --path log/ --config logback.xml --output logfile --level ERROR
</code></pre><h4><a href="#groovy" class="anchor" name="groovy"></a> Groovy</h4>
<ul>
<li>更好地组织Groovy支持</li>
<li>基于AST的扩展已移至其自己的子项目，以实现更好的Gradle兼容性</li>
<li>为Groovy 2.3和Java 1.8准备</li>
</ul><p>Groovy 2.3.0 <a href="https://glaforge.appspot.com/article/groovy-2-3-0-is-out">刚刚发布</a> ，其中包括<a href="http://groovy.codehaus.org/Groovy+2.3+release+notes?nc">大量新功能和性能改进</a> ，以及lambda闭包支持和其他出色的JDK 8功能。Reactor的Groovy支持已准备好在Groovy 2.3中使用，同时仍与JDK 7上的Groovy 2.2兼容。</p><h4><a href="#network-tcp" class="anchor" name="network-tcp"></a>网络/ TCP</h4>
<ul>
<li>将Reactor <code>reactor-tcp</code>重命名<code>reactor-tcp</code> <code>reactor-net</code></li>
<li>重构基本抽象以处理TCP和UDP</li>
<li>使用Netty添加了UDP支持</li>
<li>使用<code>jeromq</code>添加了ZeroMQ支持</li>
<li>重写<code>reconnect</code>支持</li>
<li>改进和扩展了测试</li>
</ul><p>TCP模块已进行了改进，其中包括对UDP的支持以及基于ZeroMQ的新实现。 [4]</p><p>Reactor中对ZeroMQ的支持具有<code>tcp</code>和<code>inproc</code>支持，并提供简洁的API，可使用Reactor的高效编解码器工具快速创建客户端和服务器。</p>
<pre><code class="prettyprint java">ZeroMQ<JsonData> zmq = new ZeroMQ<>(reactorEnv)
    .codec(new JacksonJsonCodec());

zmq.router("inproc://queue")
   .consume(channel -> channel.consume(service::invoke));

zmq.dealer("inproc://queue")
   .consume(channel -> {
     JsonData data;
     while(null != (data = in.next())) {
       channel.sendAndForget(data);
     }
   });
</code></pre><h4><a href="#testing" class="anchor" name="testing"></a>测试中</h4>
<ul>
<li>基准测试方面的许多改进</li>
<li>添加了基于JMH的专用<code>reactor-benchmark</code>项目[5]</li>
<li>从核心项目中删除了大多数基准测试代码</li>
<li>扩大和改善测试范围</li>
</ul><h2><a href="#usage" class="anchor" name="usage"></a>用法</h2><p>神器可以在Maven Central和<code>repo.spring.io/libs-release</code> 。请注意，在版本1.1 [6]中，Spring支持的坐标已更改为<code>org.projectreactor.spring:reactor-spring-*</code> 。</p><p>参考文档可在<a href="https://github.com/reactor/reactor/wiki">GitHub Wiki</a>中<a href="https://github.com/reactor/reactor/wiki">找到</a> 。</p><p>更新的API文档位于<a href="https://reactor.github.io/docs/api/">GitHub页面站点上</a> 。</p><p>---<br>[1] <a href="https://github.com/goldmansachs/gs-collections">-https://github.com/goldmansachs/gs-collections</a></p><p>[2] <a href="http://logback.qos.ch/">-http://logback.qos.ch/</a></p><p>[3] <a href="https://github.com/OpenHFT/Java-Chronicle">-https://github.com/OpenHFT/Java-Chronicle</a></p><p>[4] <a href="http://zeromq.org/">-http://zeromq.org/</a></p><p>[5] <a href="https://openjdk.java.net/projects/code-tools/jmh/">-http://openjdk.java.net/projects/code-tools/jmh/</a></p><p>[6] <a href="https://repo.spring.io/libs-release/org/projectreactor/spring/">-http://repo.spring.io/libs-release/org/projectreactor/spring/</a></p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">var disqus_shortname = 'spring-io';
      var disqus_identifier = 1555;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));</script>
<noscript>请启用JavaScript以查看<a href="http://disqus.com/?ref_noscript">由Disqus提供</a>的<a href="http://disqus.com/?ref_noscript">评论。</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">由<span class="logo-disqus">Disqus</span>提供动力的评论</a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>背部</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">所有帖子</a> <a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">工程</a> <a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">发布</a> <a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">新闻与活动</a> <a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>将The Spring Team的更新发送到您的收件箱</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });</script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">球队</a></li>
<li><a href="/tools">工具类</a></li>
<li><a href="https://store.pivotal.io/">商店</a></li>
<li><a href="/blog">通讯</a></li>
</ul>
</div>
</div>© <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a> ，Inc.保留所有权利。
<a href="https://pivotal.io/terms-of-use">使用条款</a> • <a href="https://pivotal.io/privacy-policy">隐私</a> • <a href="/trademarks">商标准则</a>
<div id="teconsent" style="display:inline-block"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
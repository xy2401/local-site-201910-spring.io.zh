<html  data-code-prettify="" data-mobile-support="" data-search=""><head>
<title>Spring Integration Java DSL 1.0 RC1发布</title>
<meta id="Viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png">
<link href="asset?aid=0" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css">
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta name="google-site-verification" content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@springcentral">
<meta name="twitter:title" content="Spring Integration Java DSL 1.0 RC1 Released">
<meta name="twitter:description" >
<meta name="twitter:creator" content="@artem_bilan">
<meta name="twitter:image:src" content="https://gravatar.com/avatar/2158ce6e7c048277890eb64458864c1c?s=200">

<meta property="og:title" content="Spring Integration Java DSL 1.0 RC1 Released">
<meta property="og:image" content="https://gravatar.com/avatar/2158ce6e7c048277890eb64458864c1c?s=200">
<meta property="og:description" >
<meta content="article" property="og:type">
<meta property="og:article:published_time" content="2014-10-31 19:33:14.444">



<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" width="0" style="display:none"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">专案</a>
</li>
<li class="navbar-link">
<a href="/guides">导游</a>
</li>
<li class="navbar-link active">
<a href="/blog">博客</a>
</li>
<li class="navbar-link">
<a href="/services">培训与认证</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form class="form-inline form-search" action="/search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索文档，指南和帖子..." type="text" value="">
<button class="search-form--submit" type="submit"></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form class="form-inline form-search" action="/search" method="get">
<button class="search-form--submit" type="submit"></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="搜索..." type="text" value="">
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">家<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">专案<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">导游<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">博客<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">培训与认证<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category content--title">
<div>工程</div>
</div>
<div class="blog-category active content--title">
<div>发布</div>
</div>
<div class="blog-category content--title">
<div>新闻与活动</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Spring Integration Java DSL 1.0 RC1发布</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon releases"></div>
<a class="category">发布</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/2158ce6e7c048277890eb64458864c1c?s=20&d=mm"> <a class="author" rel="author" href="/team/artembilan">阿尔特姆·比兰（Artem Bilan）</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2014-10-31 19:33:14.444">2014年10月31日</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" href="/blog/2014/10/31/spring-integration-java-dsl-1-0-rc1-released#disqus_thread" data-disqus-identifier="1805">
</a></div>
</div>
</header>
<div class="blog--post"><p>尊敬的Spring社区，</p><p>我们很高兴地宣布，<br><a href="https://spring.io/blog/2014/10/27/spring-integration-4-1-rc1-released">Spring Integration 4.1版本候选</a><br>Spring Integration Java DSL 1.0 Release Candidate现在可用。<br>请结合使用<a href="http://repo.springsource.org/milestone">Milestone仓库</a>和Maven或Gradle，<br>或下载一个<br><a href="https://repo.spring.io/milestone/org/springframework/integration/spring-integration-java-dsl/1.0.0.RC1">发行档案</a> ，<br>旋转一下。</p><p>见项目<a href="https://github.com/spring-projects/spring-integration-extensions/wiki/Spring-Integration-Java-DSL-Reference">首页</a><br>想要查询更多的信息。</p><p>该版本包括许多新功能和改进，以及许多错误修复。GA版本<br>计划于11月中旬进行。</p><p>这是自<br><a href="https://spring.io/blog/2014/09/07/spring-integration-java-dsl-1-0-milestone-3-available">最后一个里程碑</a> ：</p><p><strong>重构和重大变更</strong></p><p>尽管仍然支持早期的Java版本，但Spring Integration Java DSL主要定位于Java 8及其Lambda支持。<br>我们删除了几个<br><code>functional interfaces</code>支持Java 8中的类似接口： <code>Consumer<T></code> ， <code>Function<T, R></code>等等当然要支持<br>与旧Java版本的向后兼容性我们已经在DSL源代码中实现了类似的接口。用户<br>如果将更改后的接口用于Java版本少于8，则需要进行更改以修复其编译错误。例如：</p><p>由此：</p>
<pre><code class="prettyprint java">.handle(Integer.class, (p, h) -&gt; p * 2,
		new EndpointConfigurer&lt;GenericEndpointSpec&lt;ServiceActivatingHandler&gt;&gt;() {
				@Override
				public void accept(GenericEndpointSpec&lt;ServiceActivatingHandler&gt; spec) {
					spec.poller(Pollers.cron(&quot;7 * * * * ?&quot;));
				}
		})
</code></pre><p>对此：<br><code>java .handle(Integer.class, (p, h) -> p * 2, new Consumer<GenericEndpointSpec<ServiceActivatingHandler>>() { @Override public void accept(GenericEndpointSpec<ServiceActivatingHandler> spec) { spec.poller(Pollers.cron("7 * * * * ?")); } })</code><br>当然，如果您在此处使用Java 8 Lambda，则无需更改代码：</p>
<pre><code class="prettyprint java">.handle(Integer.class, (p, h) -&gt; p * 2, e -&gt; e.poller(Pollers.cron(&quot;7 * * * * ?&quot;)))
</code></pre><p>的<code>IntegrationFlows</code>现在只包含<code>from(...)</code>方法。的<code>.fromFixedMessageChannel()</code>已被替换为<br><code>.from(String messageChannelName, boolean fixedSubscriber)</code> 。</p><p>此外，为了解决某些程序包纠缠问题，我们将一些类移到了不同的程序包中。</p><p><strong>方法范围函数</strong></p><p>为了简化来自IDE的代码完成并避免重复搜索所需的代码<code>Namespace Factory</code>我们<br>添加了重载方法<code>Function<T, R></code>论点。例如，这些代码段是相等的：<br><code>java ..... .channel(Amqp.pollableChannel(this.rabbitConnectionFactory) .queueName("amqpReplyChannel") .channelTransacted(true)) .... .channel(c -> c.amqpPollable(this.rabbitConnectionFactory) .queueName("amqpReplyChannel") .channelTransacted(true)) ....</code><br>哪里<code>c</code>变量是<code>Channel</code>的“方法聚合器”对象，该对象委托给适当的<code>Namespace Factory</code> 。<br>其他类似的Lambda方法是：</p>
<ul>
<li><code>IntegrationFlows.from(MessageSourcesFunction sources)</code></li>
<li><code>IntegrationFlows.from(MessageProducersFunction producers)</code></li>
<li><code>IntegrationFlows.from(MessagingGatewaysFunction gateways)</code></li>
<li><code>IntegrationFlowDefinition.handleWithAdapter(Function<Adapters, MessageHandlerSpec<?, H>> adapters)</code></li>
<li><code>EndpointSpec.poller(Function<PollerFactory, PollerSpec> pollers)</code></li>
</ul><p><strong>功能表达</strong></p><p>Spring Integration具有惊人的Spring Expression Language（SpEL）支持。由于Java DSL是<br>纯净的（eh！）Java，在长字符串中为<code>expression</code>属性。<br>受到Java 8 Lambda支持的启发，并追求最小更改的目标<br>我们介绍了<code>FunctionExpression</code> -SpEL的实现<code>Expression</code>接口-接受一个<br><code>Function<T, R></code>并在每个<code>getValue()</code> 。现在，DSL中的许多组件可以提供<br><code>(Function<T, R> function)</code>方法替代类似的SpEL方法。这是一个例子<code>localFilename</code><br>的财产<code>FtpInboundFileSynchronizingMessageSource</code> ：</p><p>使用SpEL：<br><code>java @Bean public IntegrationFlow ftpInboundFlow() { return IntegrationFlows .from(s -> s.ftp(this.ftpSessionFactory) .remoteDirectory("ftpSource") .localFilenameExpression("payload.toUpperCase() + '.a'") .channel(c -> c.queue("ftpInboundResultChannel")) .get(); }</code></p><p>使用Lambda：<br><code>java @Bean public IntegrationFlow ftpInboundFlow() { return IntegrationFlows .from(s -> s.ftp(this.ftpSessionFactory) .remoteDirectory("ftpSource") .localFilename(f -> f.toUpperCase() + ".a"))) .channel(c -> c.queue("ftpInboundResultChannel")) .get(); }</code><br>的其他有趣用途<code>FunctionExpression</code>是<code>Enricher</code>和<code>HeaderEnricher</code> ：<br><code>java .enrich(e -> e.requestChannel("enrichChannel") .requestPayload(Message::getPayload) .propertyFunction("date", m -> new Date()))</code></p><p>的<code>FunctionExpression</code>还支持标准中的运行时类型转换<code>SpelExpression</code> 。</p><p><strong>子流</strong></p><p>我们介绍了<code>SubFlow</code>支持一些<code>if...else</code>和<code>publish-subscribe</code>组件。最简单的<br>例子是<code>.publishSubscribeChannel()</code> ：<br><code>java @Bean public IntegrationFlow subscribersFlow() { return flow -> flow .publishSubscribeChannel(Executors.newCachedThreadPool(), s -> s .subscribe(f -> f .<Integer>handle((p, h) -> p / 2) .channel(c -> c.queue("subscriber1Results"))) .subscribe(f -> f .<Integer>handle((p, h) -> p * 2) .channel(c -> c.queue("subscriber2Results")))) .<Integer>handle((p, h) -> p * 3) .channel(c -> c.queue("subscriber3Results")); }</code><br>当然，我们可以通过单独获得相同的结果<code>IntegrationFlow</code><code>@Bean</code>定义，但我们希望您能<br>发现逻辑组成的子流样式很有用。</p><p>类似<code>publish-subscribe</code>子流组成由<code>.routeToRecipients()</code> 。</p><p>另一个例子是<code>.discardFlow()</code>代替<code>.discardChannel()</code>上<code>.filter()</code> 。</p><p><code>.route()</code>值得特别注意：<br><code>java @Bean public IntegrationFlow routeFlow() { return f -> f .<Integer, Boolean>route(p -> p % 2 == 0, m -> m.channelMapping("true", "evenChannel") .subFlowMapping("false", sf -> sf.<Integer>handle((p, h) -> p * 3))) .transform(Object::toString) .channel(c -> c.queue("oddChannel")); }</code><br>的<code>.channelMapping()</code>继续像往常一样工作<code>Router</code>映射，但<code>.subFlowMapping()</code>绑那个<br>子流与主流。换句话说，任何路由器的子流在<code>.route()</code> 。</p><p>类似的“返回主流”子流由<code>.gateway()</code> ：<br><code>java @Bean public IntegrationFlow gatewayFlow() { return f -> f.gateway("gatewayRequest", g -> g.errorChannel("gatewayError").replyTimeout(10L)) .gateway(gf -> gf.transform("From Gateway SubFlow: "::concat)); }</code><br>但是，此网关子流只是通过显式与主流连接<code>DirectChannel</code>并包裹到<br>常规<code>GatewayMessageHandler</code>将该频道用作<code>requestChannel</code>选项。</p><p>当然，子流可以嵌套任何深度，但是我们不建议这样做，因为事实上，即使在<br>在路由器的情况下，在流中添加复杂的子流将很快开始<br>人类很难解析。</p><p><strong>结论</strong></p><p>我们还没有添加更多<code>protocol specific adapters</code>自上一个里程碑以来。并非DSL会直接支持所有适配器<br>尽管最常用的软件具有一流的支持。<br>但是，那些没有一流支持的人可以轻松地连接使用<code>.handle()</code> 。正如我们之前讨论的那样，<br>我们正在寻找输入信息以优先考虑其余适配器的实现<br>因此，不要害羞分享您的想法和想法！</p><p>您可以从这些类和现有类获取有关它们的更多信息。<br><a href="https://github.com/spring-projects/spring-integration-extensions/tree/master/spring-integration-java-dsl">源代码</a><br>和<a href="https://github.com/spring-projects/spring-integration-extensions/wiki/Spring-Integration-Java-DSL-Reference">参考手册</a> 。</p><p>我们期待您的评论和反馈（ <a href="https://stackoverflow.com">StackOverflow</a> （ <code>spring-integration</code>标签），<br><a href="https://jira.spring.io/browse/INTEXT">春季JIRA</a> ， <a href="https://github.com/spring-projects/spring-integration-extensions/issues">GitHub</a> ）<br>尽快报告您在GA之前发现的问题，持续几个星期。</p><p>一如既往，我们非常欢迎您的<a href="https://github.com/spring-projects/spring-integration/blob/master/CONTRIBUTING.md">贡献</a> 。</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 1805;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>请启用JavaScript以查看<a href="http://disqus.com/?ref_noscript">由Disqus提供</a>的<a href="http://disqus.com/?ref_noscript">评论。</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">由<span class="logo-disqus">Disqus</span>提供动力的评论</a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>背部</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">所有帖子</a> <a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">工程</a> <a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">发布</a> <a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">新闻与活动</a> <a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>将The Spring Team的更新发送到您的收件箱</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">工具类</a></li>
<li><a href="https://store.pivotal.io/">商店</a></li>
<li><a href="/blog">通讯</a></li>
</ul>
</div>
</div>© <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a> ，Inc.保留所有权利。
<a href="https://pivotal.io/terms-of-use">使用条款</a> • <a href="https://pivotal.io/privacy-policy">隐私</a> • <a href="/trademarks">商标准则</a>
<div id="teconsent" style="display:inline-block"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
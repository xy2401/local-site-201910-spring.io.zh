<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>Annotated Web MVC Controllers in Spring 2.5 </title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="Annotated Web MVC Controllers in Spring 2.5 " />
<meta name="twitter:description" content="&lt;p&gt;Spring 2.5 introduces an approach for writing annotated Web MVC controllers, which we haven’t been blogging about much yet… I’ll take the opportunity to give you an overview of what Spring MVC is really about these days.&lt;/p&gt;
&lt;p&gt;Spring MVC is essentially a request dispatcher framework, with a Servlet API variant and Portlet API variant. It operates very closely within its hosting environment - either Servlets or Portlets. Think about Spring MVC as providing foundational facilities and conveniences on top of the Servlet/Portlet container: e.g. flexible request mappings, separation between controller processing and view rendering phase, data binding, basic JSP tag libraries that complement the JSTL, etc. The building blocks of sophisticated HTTP request processing.&lt;/p&gt;
" />
<meta name="twitter:creator" content="@springjuergen" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/ba9686d8c567aabedc1b7f8b6a7fb3d6?s=200" />

<meta property="og:title" content="Annotated Web MVC Controllers in Spring 2.5 " />
<meta property="og:image" content="https://gravatar.com/avatar/ba9686d8c567aabedc1b7f8b6a7fb3d6?s=200" />
<meta property="og:description" content="&lt;p&gt;Spring 2.5 introduces an approach for writing annotated Web MVC controllers, which we haven’t been blogging about much yet… I’ll take the opportunity to give you an overview of what Spring MVC is really about these days.&lt;/p&gt;
&lt;p&gt;Spring MVC is essentially a request dispatcher framework, with a Servlet API variant and Portlet API variant. It operates very closely within its hosting environment - either Servlets or Portlets. Think about Spring MVC as providing foundational facilities and conveniences on top of the Servlet/Portlet container: e.g. flexible request mappings, separation between controller processing and view rendering phase, data binding, basic JSP tag libraries that complement the JSTL, etc. The building blocks of sophisticated HTTP request processing.&lt;/p&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2007-11-14 16:17:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">Annotated Web MVC Controllers in Spring 2.5 </h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/ba9686d8c567aabedc1b7f8b6a7fb3d6?s=20&amp;d=mm" />
<a class="author" rel="author" href="/team/jhoeller">Juergen Hoeller</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2007-11-14 16:17:00.0">November 14, 2007</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="115" href="/blog/2007/11/14/annotated-web-mvc-controllers-in-spring-2-5#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><p>Spring 2.5 introduces an approach for writing annotated Web MVC controllers, which we haven&rsquo;t been blogging about much yet&hellip; I&rsquo;ll take the opportunity to give you an overview of what Spring MVC is really about these days.</p><p>Spring MVC is essentially a request dispatcher framework, with a Servlet API variant and Portlet API variant. It operates very closely within its hosting environment - either Servlets or Portlets. Think about Spring MVC as providing foundational facilities and conveniences on top of the Servlet/Portlet container: e.g. flexible request mappings, separation between controller processing and view rendering phase, data binding, basic JSP tag libraries that complement the JSTL, etc. The building blocks of sophisticated HTTP request processing.</p><p>Spring MVC is a very flexible affair: Its core DispatcherServlet can not only host its native controllers but can adapt to any kind of action type. It can host plain HttpRequestHandlers that process HTTP-based remoting protocols: This is what Spring users leverage when they define HTTP invoker / Hessian / Burlap service exporters, or XFire exporters for Web Services. DispatcherServlet can even host arbitrary third-party Servlets, allowing those Servlets to be configured and managed by the Spring environment.<br /><h2>Spring 2.5&rsquo;s annotated controllers</h2><br />So how does Spring 2.5&rsquo;s annotation-based controller approach fit into this picture? Quite simple: It is essentially an alternative controller type supported by the DispatcherServlet / DispatcherPortlet, not implementing a specific interface but rather using annotations to express request mappings for specific handler methods. It is primarily a next-generation style for implementing multi-action controllers, superseding Spring&rsquo;s good old MultiActionController class.</p><p>Let&rsquo;s have a look at an example, taken from the &ldquo;imagedb&rdquo; sample application that comes with the Spring distribution. (Note: This is the Spring 2.5 final version of &ldquo;imagedb&rdquo;, slightly differing from the RC version.)<br /><pre class="code">@Controller<br />public class ImageController {</p><p>private ImageDatabase imageDatabase;</p><p>@Autowired<br />public ImageController(ImageDatabase imageDatabase) {<br />this.imageDatabase = imageDatabase;<br />}</p><p>@RequestMapping(&ldquo;/imageList&rdquo;)<br />public String showImageList(ModelMap model) {<br />model.addAttribute(&ldquo;images&rdquo;, this.imageDatabase.getImages());<br />return &ldquo;imageList&rdquo;;<br />}</p><p>@RequestMapping(&ldquo;/imageContent&rdquo;)<br />public void streamImageContent(@RequestParam(&ldquo;name&rdquo;) String name, OutputStream outputStream)<br />throws IOException {</p><p>this.imageDatabase.streamImage(name, outputStream);<br />}</p><p>@RequestMapping(&ldquo;/imageUpload&rdquo;)<br />public String processImageUpload(<br />@RequestParam(&ldquo;name&rdquo;) String name, @RequestParam(&ldquo;description&rdquo;) String description,<br />@RequestParam(&ldquo;image&rdquo;) MultipartFile image) throws IOException {</p><p>this.imageDatabase.storeImage(name, image.getInputStream(), (int) image.getSize(), description);<br />return &ldquo;redirect:imageList&rdquo;;<br />}</p><p>@RequestMapping(&ldquo;/clearDatabase&rdquo;)<br />public String clearDatabase() {<br />this.imageDatabase.clearDatabase();<br />return &ldquo;redirect:imageList&rdquo;;<br />}<br />}</pre><br />What does this controller class really do - what&rsquo;s the point of its design? Let&rsquo;s go through it step by step&hellip;<br /><h2>@Controller and @RequestMapping</h2><br />First of all, the class is annotated with the <strong>@Controller</strong> stereotype. This indicates that its methods should be scanned for request mappings. It also allows for autodetection through Spring 2.5&rsquo;s component scanning (&lt;context:component-scan&gt;) just like the other stereotypes @Component, @Repository and @Service. In the case of the &ldquo;imagedb&rdquo; sample, the ImageController is still defined explicitly through a &lt;bean&gt; tag - simply because autodetection only really pays off in case of a larger number of controllers.</p><p>The constructor is marked as <strong>@Autowired</strong> and accepts an argument of type ImageDatabase. This is core Spring 2.5 functionality, namely annotation-driven dependency injection: This constructor will be called passing in a Spring bean of type ImageDatabase, obtained by type from the Spring ApplicationContext. In our case, this is the central ImageDatabase service from the application&rsquo;s service layer.</p><p>The actual request mappings are expressed through <strong>@RequestMapping</strong> annotations at the method level. Each of those mappings binds to a specific HTTP path within the containing DispatcherServlet. The mapping path can also be inferred from the handler method name, with a common mapping pattern (e.g. &quot;*.image&quot;) expressed at the type level - reusing the InternalPathMethodNameResolver as known from the good old MultiActionController!</p><p>So when using @RequestMapping at the type level, method-level annotations will &lsquo;narrow&rsquo; the mapping for the specific handler methods. @RequestMapping allows for specifying HTTP request methods (e.g. <em>method = RequestMapping.GET</em>) or specific request parameters (e.g. <em>params = &ldquo;action=save&rdquo;</em>), all narrowing the type-level mapping for specific methods. Alternatively, @RequestMapping at the type level can also be combined with a good old Controller interface implementation - such as a SimpleFormController or MultiActionController.<br /><h2>Flexible handler method signatures</h2><br />The mapping is what I would call the &ldquo;obvious&rdquo; part, since it&rsquo;s pretty clear what&rsquo;s happening there. Now, the not-so-obvious part: the handler method signatures. This is a very flexible affair, not being tied to very specific signatures like in the good old Controller or MultiActionController case. You could be using a standard HttpServletRequest / HttpServletResponse / ModelAndView signature, of course, but the real power lies in using more specific arguments.</p><p>The &ldquo;imagedb&rdquo; sample shows a couple of fundamental variants:<br /><pre class="code">@RequestMapping(&ldquo;/imageList&rdquo;)<br />public String showImageList(ModelMap model) {<br />model.addAttribute(&ldquo;images&rdquo;, this.imageDatabase.getImages());<br />return &ldquo;imageList&rdquo;;<br />}</pre><br />For this handler method, the only argument to be resolved is a <strong>ModelMap</strong>. ModelMap is a part of Spring 2.0&rsquo;s redesigned ModelAndView object, encapsulating a collection of name-value attribute pairs that will be exposed to the view. The code above simply calls the ImageDatabase service to load a List of ImageDescriptor objects and exposes them under the attribute name &ldquo;images&rdquo;. Alternatively, you could call the addAttribute variant without an attribute name, in which case the name will be inferred from the given value type (in our case here: &ldquo;imageDescriptorList&rdquo;).</p><p>The <strong>return value is a String</strong>, simply indicating the name of the view to be rendered. Essentially, you could be writing the same method with no arguments and a ModelAndView return value - but the above is usually easier to read and avoids a dependency on the ModelAndView object. (Note that ModelMap is a generic class in the &ldquo;ui&rdquo; package, whereas ModelAndView is a rather specific class in the &ldquo;web.servlet&rdquo; package.)<br /><pre class="code">@RequestMapping(&ldquo;/imageContent&rdquo;)<br />public void streamImageContent(@RequestParam(&ldquo;name&rdquo;) String name, OutputStream outputStream)<br />throws IOException {</p><p>this.imageDatabase.streamImage(name, outputStream);<br />}</pre><br />This handler method shows a quite different use case. Its purpose is to stream image content from the database to the HTTP response. It writes the response directly, not forwarding to a view; hence its <strong>return type is void</strong>. It uses Spring 2.5&rsquo;s new <strong>@RequestParam</strong> annotation to receive an HTTP request parameter in the form of a method argument, as well as an argument of type <strong>OutputStream</strong> for a handle to the response stream. The actual loading of the image content is delegated to the ImageDatabase service again.</p><p>Alternatively, you could implement the same handler method with a more traditional HttpServletRequest / HttpServletResponse signature, gaining more control over the exact HTTP processing. However, this introduces stronger coupling to the Servlet API and takes a bit more effort to unit-test.<br /><pre class="code">@RequestMapping(&ldquo;/imageContent&rdquo;)<br />public void streamImageContent(HttpServletRequest request, HttpServletResponse response)<br />throws IOException {</p><p>this.imageDatabase.streamImage(request.getParameter(&ldquo;name&rdquo;), response.getOutputStream());<br />}</pre><br />The purpose of such handler methods should already become apparent: They are quite simple &lsquo;bridges&rsquo; between the HTTP request world and the service layer world, adapting request parameters and response contents. Let&rsquo;s have a look at the image upload handler for an advanced example.<br /><pre class="code">@RequestMapping(&ldquo;/imageUpload&rdquo;)<br />public String processImageUpload(<br />@RequestParam(&ldquo;name&rdquo;) String name, @RequestParam(&ldquo;description&rdquo;) String description,<br />@RequestParam(&ldquo;image&rdquo;) MultipartFile image) throws IOException {</p><p>this.imageDatabase.storeImage(name, image.getInputStream(), (int) image.getSize(), description);<br />return &ldquo;redirect:imageList&rdquo;;<br />}</pre><br />The basic purpose is again accepting a couple of specific HTTP request parameters, doing some processing, then returning the name of a view - in this case indicating a redirect to the &ldquo;imageList&rdquo; path. However, this particular method processes a multipart file upload, which is why the &ldquo;image&rdquo; argument is declared as type <strong>MultipartFile</strong>. Spring&rsquo;s @RequestParam processing will automatically resolve this as multipart element, so that the handler method is able to obtain the file size and to access the uploaded file contents as InputStream.</p><p>For a full list of argument types supported for annotated handler methods, see the <a href="http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/web/bind/annotation/RequestMapping.html">@RequestMapping javadoc</a>.<br /><h2>Beyond stateless multi-action controllers</h2><br />So much for using Spring 2.5&rsquo;s web annotations to implement multi-action controllers. The same controller style can also accommodate basic form handling, superseding the good old SimpleFormController. This can be seen in the Spring 2.5 version of PetClinic, which has all of its form controllers implemented in the annotation style now, showing the use of form objects and JavaBean-based data binding. A discussion of those form handling capabilities will be the subject of a follow-up post.</p><p>Let me conclude with pointing out where Spring MVC&rsquo;s purpose ends: exactly with stateless controllers, basic form handling and flexible view rendering. MVC is fundamentally a dispatching-centric module of Spring&rsquo;s core web support, serving as runtime for many different kinds of usages - and with higher-level functionality to be built on top. In that respect, it is similar to Java EE 5&rsquo;s JSF runtime, which also primarily serves as a basic web platform to build higher-level functionality on top of.</p><p>This is where <strong>Spring Web Flow</strong> enters the picture: SWF is our higher-level, conversation-oriented controller engine, with strong support for both <em>MVC views</em> and <em>JSF views</em>. I strongly recommend checking out SWF for building web user interfaces, in particular when facing non-trivial navigation and state management needs. There is exciting stuff happening in the Spring Web Flow 2.0 milestones, aligned with where the Spring 2.5 MVC foundation is going - but also with a particularly strong focus on JSF, through our new <strong>Spring Faces</strong> module. Watch this space!</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 115;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>
 
<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>
<!DOCTYPE html>
<html data-code-prettify="" data-mobile-support="" data-search="">
<head>
<title>The Most Amazing Java Type Declaration Ever</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="Viewport" name="viewport" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon-ca31b78daf0dd9a106bbf3c6d87d4ec7.png" />
<link href="https://fonts.googleapis.com/css?family=Varela+Round|Montserrat:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/css/main-bc256dba5f9d253d6425441ccfb82576.css" />
<script src="/jspm_packages/system-eccc019329febb5a1b06bde008ca5614.js"></script>
<script>
    System.config({baseURL: "/b92013b"});
  </script>
<script src="/config-5a675c9cddea3a5f55b71416e67d47d6.js"></script>
<script>
      System.import('app/main.js')
  </script>
<meta content="7qGntFPD9lWAVCtUu5U77v4l68PsTHf6xpzgjQv2j2M" name="google-site-verification" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZM7GF6');</script>

<link href="/css/blog-92993c3ec6808bded45b277c18d7d621.css" rel="stylesheet" type="text/css" />

<meta content="summary" name="twitter:card" />
<meta content="@springcentral" name="twitter:site" />
<meta name="twitter:title" content="The Most Amazing Java Type Declaration Ever" />
<meta name="twitter:description" content="&lt;p&gt;I’d like to think I’m pretty comfortable with Java and generics but I recently came across this bit of Java code and it stopped me in my tracks :&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;br&gt;
&lt;p style=&quot;text-align: left;&quot;&gt;&lt;code&gt;&lt;br&gt;public abstract class AnnotationBasedPersistentProperty&amp;lt;P extends PersistentProperty&amp;lt;P&amp;gt;&amp;gt; extends AbstractPersistentProperty&amp;lt;P&amp;gt; {..}&lt;br&gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;This class is internal to the &lt;a href=&quot;http://www.springsource.org/spring-data&quot;&gt;Spring Data&lt;/a&gt; framework’s &lt;a href=&quot;http://static.springsource.org/spring-data/data-commons/docs/current/reference/html/#repositories&quot;&gt;Repository&lt;/a&gt; Support which removes the need to write boilerplate code when implementing a data access layer and also provides a common programming model for mapping domain objects and managing data access to any type of persistent store. &amp;nbsp;Spring Data’s &amp;nbsp;current repository implementations include relational databases (&lt;a href=&quot;http://www.springsource.org/spring-data/jpa&quot;&gt;JPA&lt;/a&gt;), &lt;a href=&quot;http://www.springsource.org/spring-gemfire&quot;&gt;Gemfire&lt;/a&gt;,&lt;a href=&quot;http://www.springsource.org/spring-data/mongodb&quot;&gt;MongoDB&lt;/a&gt;,&amp;nbsp;&lt;a href=&quot;http://www.springsource.org/spring-data/neo4j&quot;&gt;Neo4&lt;/a&gt;.&lt;/p&gt;
" />
<meta name="twitter:creator" content="@dturanski" />
<meta name="twitter:image:src" content="https://gravatar.com/avatar/1298cda9d866a053f693e17eee10902b?s=200" />

<meta property="og:title" content="The Most Amazing Java Type Declaration Ever" />
<meta property="og:image" content="https://gravatar.com/avatar/1298cda9d866a053f693e17eee10902b?s=200" />
<meta property="og:description" content="&lt;p&gt;I’d like to think I’m pretty comfortable with Java and generics but I recently came across this bit of Java code and it stopped me in my tracks :&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;br&gt;
&lt;p style=&quot;text-align: left;&quot;&gt;&lt;code&gt;&lt;br&gt;public abstract class AnnotationBasedPersistentProperty&amp;lt;P extends PersistentProperty&amp;lt;P&amp;gt;&amp;gt; extends AbstractPersistentProperty&amp;lt;P&amp;gt; {..}&lt;br&gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;This class is internal to the &lt;a href=&quot;http://www.springsource.org/spring-data&quot;&gt;Spring Data&lt;/a&gt; framework’s &lt;a href=&quot;http://static.springsource.org/spring-data/data-commons/docs/current/reference/html/#repositories&quot;&gt;Repository&lt;/a&gt; Support which removes the need to write boilerplate code when implementing a data access layer and also provides a common programming model for mapping domain objects and managing data access to any type of persistent store. &amp;nbsp;Spring Data’s &amp;nbsp;current repository implementations include relational databases (&lt;a href=&quot;http://www.springsource.org/spring-data/jpa&quot;&gt;JPA&lt;/a&gt;), &lt;a href=&quot;http://www.springsource.org/spring-gemfire&quot;&gt;Gemfire&lt;/a&gt;,&lt;a href=&quot;http://www.springsource.org/spring-data/mongodb&quot;&gt;MongoDB&lt;/a&gt;,&amp;nbsp;&lt;a href=&quot;http://www.springsource.org/spring-data/neo4j&quot;&gt;Neo4&lt;/a&gt;.&lt;/p&gt;
" />
<meta content="article" property="og:type" />
<meta property="og:article:published_time" content="2012-08-03 16:40:00.0" />
</head>
<body>

<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KZM7GF6" style="display:none;visibility:hidden" width="0"></iframe></noscript>

<script type="text/javascript">
    // Work around Google font rendering issues in webkit browsers on Windows 7
    if (navigator.userAgent.indexOf("NT 6.1") != -1) {
      document.body.style.WebkitTextStroke = "0.5px";
    }
  </script>
<div class="viewport">
<header class="navbar header--navbar desktop-only">
<div class="navbar-inner">
<div class="container-fluid">
<div class="spring-logo--container">
<a class="spring-logo" href="/"><span></span></a>
</div>
<ul class="nav pull-right">
<li class="navbar-link">
<a href="/projects">Projects</a>
</li>
<li class="navbar-link">
<a href="/guides">Guides</a>
</li>
<li class="navbar-link active">
<a href="/blog">Blog</a>
</li>
<li class="navbar-link">
<a href="/services">Training & Certification</a>
</li>
<li class="navbar-link nav-search js-nav-search">
<a>
<i class="icon-search navbar-search--icon js-search-input-open"></i>
<span class="search-input-close js-search-input-close">
<i class="icon-remove"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div class="search-dropdown--container js-search-dropdown">
<div class="container-fluid">
<div class="search-form--container">
<form action="/search" class="form-inline form-search" method="get">
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search for documentation, guides, and posts..." type="text" value="" />
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
</form>
</div>
</div>
</div>
</header>
<div>
<div class="mobile-navigation--wrapper mobile-only">
<div class="navigation-drawer--container">
<div class="mobile-search--container">
<form action="/search" class="form-inline form-search" method="get">
<button class="search-form--submit" type="submit"><i class="icon-search"></i></button>
<input class="search-query search-form--form js-search-input" name="q" placeholder="Search..." type="text" value="" />
</form>
</div>
<div class="navigation-item-list">
<div class="navbar-link">
<a href="/">
Home
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/projects">
Projects
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/guides">
Guides
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link active">
<a href="/blog">
Blog
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
<div class="navbar-link">
<a href="/services">
Training & Certification
<i class="icon-chevron-right pull-right"></i>
</a>
</div>
</div>
</div>
<div class="mobile-nav">
<div class="nav-icon js-open-nav-drawer">
<i class="icon-reorder"></i>
</div>
<div class="header-center-icon">
<a href="/">
<div class="icon icon-spring-logo-mobile"></div>
</a>
</div>
</div>
</div>
</div>
<div class="header--container"></div>
<div class="container-fluid"></div>
<div></div>
<div class="container-fluid">
<div class="main-body--wrapper">
<div class="row-fluid blog--wrapper">
<article class="span8 mobile-left-pane" id="content">
<header class="desktop-only">
<div class="blog-category active content--title">
<div>Engineering</div>
</div>
<div class="blog-category content--title">
<div>Releases</div>
</div>
<div class="blog-category content--title">
<div>News and Events</div>
</div>
</header>
<div class="blog--container">
<header>
<h1 class="blog--title">The Most Amazing Java Type Declaration Ever</h1>
<div class="meta-data--container">
<div class="meta-data--item desktop-only">
<div class="meta-data--icon icon blog-icon engineering"></div>
<a class="category">Engineering</a>
</div>
<div class="meta-data--item">
<img class="meta-data--icon" src="https://gravatar.com/avatar/1298cda9d866a053f693e17eee10902b?s=20&amp;d=mm" />
<a class="author" rel="author" href="/team/dturanski">David Turanski</a>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon calendar"></div>
<time class="date" pubdate="" datetime="2012-08-03 16:40:00.0">August 03, 2012</time>
</div>
<div class="meta-data--item">
<div class="meta-data--icon icon blog-icon comments"></div>
<a class="comments" data-disqus-identifier="480" href="/blog/2012/08/03/the-most-amazing-java-type-declaration-ever#disqus_thread">
</a></div>
</div>
</header>
<div class="blog--post"><p>I&rsquo;d like to think I&rsquo;m pretty comfortable with Java and generics but I recently came across this bit of Java code and it stopped me in my tracks :<br /><p /><p /><p /><br /><p style="text-align: left;"><code><br />public abstract class AnnotationBasedPersistentProperty&lt;P extends PersistentProperty&lt;P&gt;&gt; extends AbstractPersistentProperty&lt;P&gt; {..}<br /></code></p></p><p>This class is internal to the <a href="http://www.springsource.org/spring-data">Spring Data</a> framework&rsquo;s <a href="http://static.springsource.org/spring-data/data-commons/docs/current/reference/html/#repositories">Repository</a> Support which removes the need to write boilerplate code when implementing a data access layer and also provides a common programming model for mapping domain objects and managing data access to any type of persistent store.  Spring Data&rsquo;s  current repository implementations include relational databases (<a href="http://www.springsource.org/spring-data/jpa">JPA</a>), <a href="http://www.springsource.org/spring-gemfire">Gemfire</a>,<a href="http://www.springsource.org/spring-data/mongodb">MongoDB</a>, <a href="http://www.springsource.org/spring-data/neo4j">Neo4</a>.</p><p>Fortunately, if you use Spring Data in your Java Application, you won&rsquo;t ever see this code. It&rsquo;s hidden behind Spring Data&rsquo;s simple yet powerful Repository abstraction providing queries, paging, sorting, and common CRUD operations. For example:<br /><p style="text-align: left;"><pre><code><br />public class SomeClient {<br /> @Autowired<br /> private PersonRepository repository;<br /> public void doSomething() {<br /> List&lt;Person&gt; persons = repository.findByLastname(&ldquo;Matthews&rdquo;);<br /> }<br />}<br /></code></pre></p><br />As stated in the Spring Data project mission statement:<br /><blockquote>Spring Data provides a familiar and consistent Spring-based programming model for NoSQL and relational stores while retaining store-specific features and capabilities.</blockquote></p><p>A key feature of this familiar and consistent programming model, when it comes to repositories, is the use of annotations to configure persistent object mapping. This idea was first proven with Hibernate and subsequently adapted to JPA. Retaining store-specific features requires that the core framework provide some generic annotations, such as <strong>@Id</strong> and <strong>@Transient</strong>, and also support for store-specific annotations.</p><p>To support mapping a domain object&rsquo;s properties, a Spring Data Repository implementation should subclass <strong>AnnotationBasedPersistentProperty</strong>. This class provides common annotation handling logic across persistent and provides hooks for custom annotation handling that is unique for a given store. This class happens to extend another abstract class called<br /><strong>AbstractPersistentProperty</strong> which is declared as follows:<br /><p style="text-align: left;"><code><br />public abstract class AbstractPersistentProperty&lt;P extends PersistentProperty&lt;P&gt;&gt; implements PersistentProperty&lt;P&gt;<br /></code></p><br /><strong>AbstractPersistentProperty</strong> naturally implements the <strong>PersistentProperty</strong> interface. So before we unravel this one, let&rsquo;s have a look at the interface declaration for PersistentProperty:<br /><p style="text-align: left;"><code><br />public interface PersistentProperty&lt;P extends PersistentProperty&lt;P&gt;&gt;<br /></code></p><br />Wow - my head is spinning with images of chickens and eggs, the tower of Hanoi, and <a href="https://en.wikipedia.org/wiki/G%C3%B6del,_Escher,_Bach">Godel,Escher and Bach</a>!  This recursive gem says that the core PersistentProperty interface requires a type that extends it. In other words, the formal parameter P represents an a sub type of PersistentProperty and which the store-specific implementation defines. The store-specific PersistentProperty type is at the heart of the object mapping strategy and is exposed by several of the Spring Data common interfaces, including PersistentProperty itself. For example, PersistentProperty declares the following method:<br /><code><br />PersistentEntity&lt;?, P&gt; getOwner();<br /></code><br /><strong>PersistentEntity</strong> is an abstract representation of the class of a persisted domain object. It is designed to address class level mapping concerns and contains references to - wait for it - Persistent properties. PersistentEntity is strongly typed to the extended PersistentProperty interface, and also exposes the domain class type which is represented here by the wildcard ? formal parameter.</p><p>So let&rsquo;s take another look at the initial type declaration:<br /><p style="text-align: left;"><code>public abstract class AnnotationBasedPersistentProperty&lt;P extends PersistentProperty&lt;P&gt;&gt; extends AbstractPersistentProperty&lt;P&gt; {..}</code></p><br />The meaning by now is hopefully clear: The Spring Data commons library provides <strong>AbstractPersistentProperty</strong> which implements <strong>PersistentProperty</strong> to manage all the low level field and type information. <strong>AnnotationBasedPersistentProperty</strong> extends this class to add annotation support. All of these types require a type parameter that extends <strong>PersistentProperty</strong>. Some examples of this:<br /><p style="text-align: left;"><code><br />public interface MongoPersistentProperty extends PersistentProperty&lt;MongoPersistentProperty&gt;{&hellip;}<br /></code><br /><p style="text-align: left;"><code><br />public interface GemfirePersistentProperty extends PersistentProperty&lt;GemfirePersistentProperty&gt;{&hellip;}<br /></code><br /></p><br />In the end all this parameterized typing is actually an elegant way to allow those implementing a Spring Data Repository to use the framework to expose store-specific features without having to resort to type casting, instanceof, and the like. The fact that there are already so many implementations in the works is a testament to the power of this framework. At the time of this writing, all of the Spring Data projects are available as milestone releases.</p></div>
</div>
<section id="disqus_thread"></section>
<script type="text/javascript">
      var disqus_shortname = 'spring-io';
      var disqus_identifier = 480;

      (function(disqus_shortname, document) {
        injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
        injectScript('//' + disqus_shortname + '.disqus.com/count.js');

        function injectScript(url) {
          var s = document.createElement('script');
          s.async = true;
          s.src = url;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
        }

      }(disqus_shortname, document));
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="mobile-only">
<p><a href="/blog">
<i class="icon-chevron-left"></i>
Back
</a></p>
</div>
</article>
<aside class="span4 mobile-right-pane" id="sidebar">
<div>
<ul class="right-pane-widget--container secondary-nav with-icon">
<li class="blog-category">
<div class="icon blog-icon all-posts"></div>
<a href="/blog">All Posts</a>
<a class="pull-right" href="/blog.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category active">
<div class="icon blog-icon engineering"></div>
<a href="/blog/category/engineering">Engineering</a>
<a class="pull-right" href="/blog/category/engineering.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon releases"></div>
<a href="/blog/category/releases">Releases</a>
<a class="pull-right" href="/blog/category/releases.atom"><i class="icon-rss"></i></a>
</li>
<li class="blog-category">
<div class="icon blog-icon news-and-events"></div>
<a href="/blog/category/news">News and Events</a>
<a class="pull-right" href="/blog/category/news.atom"><i class="icon-rss"></i></a>
</li>
</ul>
<ul class="social-btn--container">
<a class="social-btn twitter" href="https://twitter.com/springcentral"></a>

<a class="social-btn linkedin" href="https://www.linkedin.com/groups/46964"></a>
<a class="social-btn youtube" href="/videos"></a>
</ul>
<div id="blog-sidebar-newsletter">
<p>Get updates from The Spring Team delivered to your inbox</p>
<script src="https://app-sj05.marketo.com/js/forms2/js/forms2.min.js"></script>
<form id="mktoForm_4723"></form>
<script>
        MktoForms2.loadForm("https://app-sj05.marketo.com", "625-IUJ-009", 4723, function(form){
          form.onSuccess(function(values, followUpUrl) {
            form.getFormElem().html("<p>Thank you!</p>");
            return false;
          });
        });
      </script>
</div>
</div>
</aside>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="navbar">
<div class="container">
<ul class="nav">
<li><a href="/team">Team</a></li>
<li><a href="/tools">Tools</a></li>
<li><a href="https://store.pivotal.io/">Store</a></li>
<li><a href="/blog">Newsletter</a></li>
</ul>
</div>
</div>
&copy; <span>2019</span> <a href="https://www.pivotal.io/">Pivotal Software</a>, Inc. All Rights Reserved.
<a href="https://pivotal.io/terms-of-use">Terms of Use</a> &bullet;
<a href="https://pivotal.io/privacy-policy">Privacy</a> &bullet;
<a href="/trademarks">Trademark Guidelines</a>
<div id="teconsent" style="display:inline-block;"></div>
</div>
</div>
</div>
</footer>
<div id="scrim"></div>
</div>
</body></html>